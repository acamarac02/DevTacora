<!doctype html>
<html lang="es" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">K-Nearest Neighbors (KNN) | DevTacora</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://acamarac02.github.io/DevTacora/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://acamarac02.github.io/DevTacora/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn"><meta data-rh="true" property="og:locale" content="es"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="K-Nearest Neighbors (KNN) | DevTacora"><meta data-rh="true" name="description" content="Introducci√≥n al algoritmo K-Nearest Neighbors (KNN) aplicado a problemas de clasificaci√≥n. C√≥mo funciona, por qu√© depende del preprocesamiento, c√≥mo elegir el mejor valor de k y c√≥mo evaluarlo con m√©tricas de clasificaci√≥n."><meta data-rh="true" property="og:description" content="Introducci√≥n al algoritmo K-Nearest Neighbors (KNN) aplicado a problemas de clasificaci√≥n. C√≥mo funciona, por qu√© depende del preprocesamiento, c√≥mo elegir el mejor valor de k y c√≥mo evaluarlo con m√©tricas de clasificaci√≥n."><meta data-rh="true" name="keywords" content="KNN,Clasificaci√≥n,Machine Learning,vecinos m√°s cercanos,scikit-learn,m√©tricas,distancia,hiperpar√°metros"><link data-rh="true" rel="icon" href="/DevTacora/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn"><link data-rh="true" rel="alternate" href="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn" hreflang="es"><link data-rh="true" rel="alternate" href="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"UT3. Machine Learning","item":"https://acamarac02.github.io/DevTacora/docs/category/ut3-machine-learning"},{"@type":"ListItem","position":2,"name":"Aprendizaje supervisado","item":"https://acamarac02.github.io/DevTacora/docs/category/aprendizaje-supervisado"},{"@type":"ListItem","position":3,"name":"Clasificaci√≥n","item":"https://acamarac02.github.io/DevTacora/docs/category/clasificaci√≥n"},{"@type":"ListItem","position":4,"name":"K-Nearest Neighbors (KNN)","item":"https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn"}]}</script><link rel="alternate" type="application/rss+xml" href="/DevTacora/blog/rss.xml" title="DevTacora RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/DevTacora/blog/atom.xml" title="DevTacora Atom Feed">




<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7WCKN9ZY1F"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-7WCKN9ZY1F",{anonymize_ip:!0})</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/DevTacora/assets/css/styles.bf36a6bb.css">
<script src="/DevTacora/assets/js/runtime~main.1710a5b7.js" defer="defer"></script>
<script src="/DevTacora/assets/js/main.b2a28880.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav aria-label="Principal" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Alternar barra lateral" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/DevTacora/"><div class="navbar__logo"><img src="/DevTacora/img/devtacora_logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/DevTacora/img/devtacora_logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DevTacora</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/DevTacora/docs/pia_2526/">PIA</a><a class="navbar__item navbar__link" href="/DevTacora/docs/pmdm_2526/">PMDM</a><a class="navbar__item navbar__link" href="/DevTacora/docs/category/ut5-persistencia-de-datos">PMDM 24-25</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/DevTacora/docs/licencia">Licencia</a><a href="https://www.linkedin.com/in/aliciacamcas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Cambiar entre modo oscuro y claro (actualmente system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Barra lateral de Documentos" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/DevTacora/docs/pia_2526/">Presentaci√≥n</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/DevTacora/docs/category/ut1-introducci√≥n-a-la-ia">UT1. Introducci√≥n a la IA</a><button aria-label="Ampliar la categor√≠a &#x27;UT1. Introducci√≥n a la IA&#x27; de la barra lateral" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/DevTacora/docs/category/ut2-python-para-la-ia">UT2. Python para la IA</a><button aria-label="Ampliar la categor√≠a &#x27;UT2. Python para la IA&#x27; de la barra lateral" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/DevTacora/docs/category/ut3-machine-learning">UT3. Machine Learning</a><button aria-label="Colapsar categor√≠a &#x27;UT3. Machine Learning&#x27; de la barra lateral" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/introduccion">Introducci√≥n</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/primer-modelo">Primer modelo de ML: Titanic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/eda">Exploratory Data Analysis (EDA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento">Preprocesamiento de Datos</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/DevTacora/docs/category/aprendizaje-supervisado">Aprendizaje supervisado</a><button aria-label="Colapsar categor√≠a &#x27;Aprendizaje supervisado&#x27; de la barra lateral" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/tips-generales">Tips generales</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/DevTacora/docs/category/clasificaci√≥n">Clasificaci√≥n</a><button aria-label="Colapsar categor√≠a &#x27;Clasificaci√≥n&#x27; de la barra lateral" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn">K-Nearest Neighbors (KNN)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/arbol-decision">Decision Trees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/random-forest">Random Forest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/regresion-logistica">Logistic Regression</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Rastro de navegaci√≥n"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="P√°gina de Inicio" class="breadcrumbs__link" href="/DevTacora/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/DevTacora/docs/category/ut3-machine-learning"><span>UT3. Machine Learning</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/DevTacora/docs/category/aprendizaje-supervisado"><span>Aprendizaje supervisado</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/DevTacora/docs/category/clasificaci√≥n"><span>Clasificaci√≥n</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">K-Nearest Neighbors (KNN)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">En esta p√°gina</button></div><div class="theme-doc-markdown markdown"><header><h1>K-Nearest Neighbors (KNN)</h1></header><p>El algoritmo <strong>K-Nearest Neighbors (KNN)</strong> es uno de los modelos m√°s sencillos e intuitivos de todo el aprendizaje supervisado.
Su idea principal es muy f√°cil de entender:</p>
<blockquote>
<p><strong>Para predecir la clase de una nueva observaci√≥n, el modelo ‚Äúmira‚Äù a los k puntos m√°s cercanos y decide seg√∫n lo que digan sus vecinos.</strong></p>
</blockquote>
<p>No construye una f√≥rmula, ni ajusta par√°metros, ni aprende pesos.
Simplemente <strong>compara distancias</strong> entre observaciones. Por eso se le llama un modelo <strong>basado en instancias</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="c√≥mo-funciona-knn">C√≥mo funciona KNN<a href="#c√≥mo-funciona-knn" class="hash-link" aria-label="Enlace directo al C√≥mo funciona KNN" title="Enlace directo al C√≥mo funciona KNN">‚Äã</a></h2>
<p>El algoritmo <strong>K-Nearest Neighbors (KNN)</strong> toma sus decisiones bas√°ndose en una idea muy sencilla:
<strong>si un punto nuevo se parece a otros puntos que ya conocemos, deber√≠a pertenecer a la misma clase que ellos.</strong></p>
<p>Para aplicar esta idea, KNN utiliza tres elementos clave:</p>
<ol>
<li><strong>Una medida de distancia</strong> para saber qu√© observaciones est√°n cerca.</li>
<li><strong>Un par√°metro k</strong>, que indica cu√°ntos vecinos mirar.</li>
<li><strong>Un proceso de votaci√≥n</strong>, donde los vecinos ‚Äúdeciden‚Äù la clase final.</li>
</ol>
<p>A continuaci√≥n explicamos cada uno de estos elementos.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="distancias">Distancias<a href="#distancias" class="hash-link" aria-label="Enlace directo al Distancias" title="Enlace directo al Distancias">‚Äã</a></h3>
<p>Para que el modelo pueda saber cu√°les son los puntos ‚Äúm√°s cercanos‚Äù, es necesario medir la distancia entre observaciones.
La m√°s utilizada por defecto es la <strong>distancia eucl√≠dea</strong>, que se corresponde con la distancia recta entre dos puntos:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>‚àí</mo><msub><mi>q</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo>‚àí</mo><msub><mi>q</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo>‚Ä¶</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mi>n</mi></msub><mo>‚àí</mo><msub><mi>q</mi><mi>n</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">d(p, q) = \sqrt{(p_1 - q_1)^2 + (p_2 - q_2)^2 + \ldots + (p_n - q_n)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.2561em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9839em"><span class="svg-align" style="top:-3.2em"><span class="pstrut" style="height:3.2em"></span><span class="mord" style="padding-left:1em"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.9439em"><span class="pstrut" style="height:3.2em"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2561em"><span></span></span></span></span></span></span></span></span></span>
<p>Esto significa que dos observaciones ser√°n consideradas ‚Äúsimilares‚Äù si:</p>
<ul>
<li>sus valores num√©ricos est√°n cerca entre s√≠,</li>
<li>y sus variables categ√≥ricas han sido codificadas adecuadamente.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="el-par√°metro-k-y-su-efecto-en-el-modelo">El par√°metro k y su efecto en el modelo<a href="#el-par√°metro-k-y-su-efecto-en-el-modelo" class="hash-link" aria-label="Enlace directo al El par√°metro k y su efecto en el modelo" title="Enlace directo al El par√°metro k y su efecto en el modelo">‚Äã</a></h3>
<p>El valor de <strong>k</strong> determina cu√°ntos vecinos toma en cuenta KNN para votar la clase final. Elegir un buen valor es fundamental porque controla el equilibrio entre <strong>sobreajuste (overfitting)</strong> y <strong>subajuste (underfitting)</strong> en el modelo:</p>
<p><strong>k muy peque√±o ‚Üí Overfitting (sobreajuste)</strong>.<br>
<!-- -->El modelo se fija demasiado en los vecinos m√°s cercanos.</p>
<ul>
<li>Es muy sensible al ruido.</li>
<li>Cambiar un solo punto puede modificar la predicci√≥n.</li>
<li>Se adapta demasiado al conjunto de entrenamiento y generaliza peor.</li>
</ul>
<p>‚û° Resultado: <strong>accuracy muy alta en train, baja en test</strong>.</p>
<p><strong>k muy grande ‚Üí Underfitting (subajuste)</strong>.<br>
<!-- -->El modelo suaviza demasiado las decisiones.</p>
<ul>
<li>Considera tantos vecinos que pierde detalles importantes.</li>
<li>Mezcla puntos de clases diferentes.</li>
<li>La frontera de decisi√≥n es demasiado simple.</li>
</ul>
<p>‚û° Resultado: <strong>accuracy baja tanto en train como en test</strong>.</p>
<p>El <strong>objetivo</strong> es encontrar un k intermedio que permita:</p>
<ul>
<li>un modelo estable,</li>
<li>que generalice bien,</li>
<li>sin sensibilidad excesiva al ruido.</li>
</ul>
<p>Ese valor se suele encontrar probando varios valores de k y comparando el error en test. M√°s adelante haremos un gr√°fico ‚Äú<em>accuracy vs k</em>‚Äù que lo muestra visualmente.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="proceso-de-predicci√≥n-paso-a-paso">Proceso de predicci√≥n paso a paso<a href="#proceso-de-predicci√≥n-paso-a-paso" class="hash-link" aria-label="Enlace directo al Proceso de predicci√≥n paso a paso" title="Enlace directo al Proceso de predicci√≥n paso a paso">‚Äã</a></h3>
<p>Cuando KNN tiene que decidir la clase de una nueva observaci√≥n, sigue tres pasos muy claros:</p>
<p><strong>1. Calcular todas las distancias</strong></p>
<p>Compara la observaci√≥n nueva con <strong>todas</strong> las del conjunto de entrenamiento.
Para cada observaci√≥n calcula una distancia (eucl√≠dea, Manhattan, etc.).</p>
<p><img decoding="async" loading="lazy" alt="Ejemplo KNN" src="/DevTacora/assets/images/knn-ejemplo-7faf3854598bcd11d7c55889d949d6c3.png" width="800" height="400" class="img_ev3q"></p>
<p><strong>2. Seleccionar los k vecinos m√°s cercanos</strong></p>
<p>Ordena todas las distancias de menor a mayor y se queda con los <strong>k puntos m√°s cercanos</strong>.</p>
<p>Ejemplo:
Si k = 5 ‚Üí se toman los 5 puntos m√°s pr√≥ximos.</p>
<p><img decoding="async" loading="lazy" alt="Ejemplo KNN" src="/DevTacora/assets/images/knn-ejemplo-2-7faf3854598bcd11d7c55889d949d6c3.png" width="800" height="400" class="img_ev3q"></p>
<p><strong>3. Votar la clase mayoritaria</strong></p>
<p>Los vecinos ‚Äúvotan‚Äù su clase.
La clase que m√°s se repita entre esos k vecinos es la que el modelo asigna.</p>
<p>Ejemplos:</p>
<ul>
<li>Si los 5 vecinos son <code>[1, 0, 1, 1, 0]</code> ‚Üí la clase predicha es <strong>1</strong>.</li>
<li>Si est√°n empatados, KNN utiliza criterios internos para romper el empate (dependiendo de la implementaci√≥n).</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Ejemplo KNN" src="/DevTacora/assets/images/knn-ejemplo-3-dd5903f0c7b348d1cd888e7c5ce877d0.png" width="800" height="400" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PARTICULARIDAD DE KNN</div><div class="admonitionContent_BuS1"><p>üí° <strong>KNN no entrena un modelo</strong>
KNN <strong>no ajusta par√°metros</strong> como hacen la regresi√≥n log√≠stica o las redes neuronales.</p><blockquote>
<p>Solo guarda los datos de entrenamiento y los usa para comparar distancias durante la predicci√≥n.</p>
</blockquote><p>Esto hace que:</p><ul>
<li>El entrenamiento sea pr√°cticamente instant√°neo.</li>
<li>Pero la predicci√≥n sea m√°s costosa si hay muchos datos.</li>
</ul></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cu√°ndo-se-utiliza-y-principales-caracter√≠sticas">Cu√°ndo se utiliza y principales caracter√≠sticas<a href="#cu√°ndo-se-utiliza-y-principales-caracter√≠sticas" class="hash-link" aria-label="Enlace directo al Cu√°ndo se utiliza y principales caracter√≠sticas" title="Enlace directo al Cu√°ndo se utiliza y principales caracter√≠sticas">‚Äã</a></h2>
<p>KNN es un modelo √∫til cuando:</p>
<ul>
<li>Queremos un primer modelo sencillo, r√°pido de implementar.</li>
<li>El dataset no es muy grande (KNN calcula distancias para cada predicci√≥n).</li>
<li>Las variables son significativas en t√©rminos de <strong>similitud</strong> (lo similar debe estar cerca).</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>¬øQu√© significa la similitud?</div><div class="admonitionContent_BuS1"><p>KNN funciona bien cuando se cumple la siguiente idea:</p><blockquote>
<p><strong>Si dos observaciones son similares en sus features, deber√≠an pertenecer a la misma clase.</strong></p>
</blockquote><p>Ejemplos (Titanic):</p><ul>
<li>Pasajeros con <strong>Pclass = 1</strong>, <strong>Sex = female</strong>, <strong>Fare alto</strong> ‚Üí suelen estar en la clase ‚Äú<em>sobrevivi√≥</em>‚Äù.</li>
<li>Pasajeros <strong>varones</strong> en <strong>tercera clase</strong> ‚Üí suelen estar en ‚Äú<em>no sobrevivi√≥</em>‚Äù.</li>
</ul><p>Puedes comprobarlo visualmente utilizando un <strong>scatterplot coloreado por clase</strong>, representando dos variables num√©ricas relevantes:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scatterplot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hue</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Survived&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p><img decoding="async" loading="lazy" alt="Gr√°fico EDA" src="/DevTacora/assets/images/scatterplot-knn-103780d3f22eb0bc3bb4951b008e67c4.png" width="571" height="432" class="img_ev3q"></p><p><strong>Interpretaci√≥n:</strong></p><ul>
<li>Si los puntos de la misma clase forman <strong>grupos visibles</strong> ‚Üí la similitud es √∫til y KNN probablemente funcionar√° bien.</li>
<li>Si las clases est√°n totalmente <strong>mezcladas</strong> ‚Üí la distancia no ayuda y KNN no ser√° un buen modelo.</li>
</ul><p>Este gr√°fico es lo m√°s parecido a ‚Äúver‚Äù c√≥mo funcionar√° KNN antes de ejecutarlo.</p><p>Ten en cuenta que:
üëâ ‚ÄúCon estas dos features, la similitud NO es √∫til.‚Äù
üëâ ‚ÄúSi a√±ades variables categ√≥ricas transformadas, la cosa cambia.‚Äù</p></div></div>
<p>Caracter√≠sticas importantes de KNN:</p>
<ul>
<li><strong>No aprende una ecuaci√≥n</strong>, solo almacena los datos.</li>
<li>El entrenamiento es pr√°cticamente inmediato.</li>
<li>El coste computacional ocurre durante la <strong>predicci√≥n</strong>, no durante el entrenamiento.</li>
<li>Funciona especialmente bien cuando el dataset est√° <strong>limpio, bien escalado y sin ruido</strong>.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ventajas">Ventajas<a href="#ventajas" class="hash-link" aria-label="Enlace directo al Ventajas" title="Enlace directo al Ventajas">‚Äã</a></h2>
<ul>
<li><strong>Muy f√°cil de entender</strong>.</li>
<li>Sirve como modelo base para comparar con modelos m√°s complejos.</li>
<li>Capaz de capturar relaciones no lineales.</li>
<li>Suele ofrecer buenos resultados si el preprocesamiento es correcto.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="limitaciones">Limitaciones<a href="#limitaciones" class="hash-link" aria-label="Enlace directo al Limitaciones" title="Enlace directo al Limitaciones">‚Äã</a></h2>
<ul>
<li><strong>Depende completamente de las distancias</strong>, as√≠ que necesita:<!-- -->
<ul>
<li>escalado de variables,</li>
<li>ausencia de outliers muy fuertes,</li>
<li>buena codificaci√≥n categ√≥rica.</li>
</ul>
</li>
<li>Es lento cuando el dataset tiene miles o millones de registros (tiene que calcular muchas distancias).</li>
<li>Sensible al ruido: un solo vecino ‚Äúraro‚Äù puede afectar la predicci√≥n.</li>
<li>Elegir un buen valor de <strong>k</strong> es crucial (muy peque√±o ‚Üí sobreajuste, muy grande ‚Üí subajuste).</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="importancia-del-preprocesamiento">Importancia del preprocesamiento<a href="#importancia-del-preprocesamiento" class="hash-link" aria-label="Enlace directo al Importancia del preprocesamiento" title="Enlace directo al Importancia del preprocesamiento">‚Äã</a></h2>
<p>KNN es uno de los modelos m√°s sensibles al preprocesamiento de los datos.
Esto se debe a que <strong>todas sus decisiones se basan en distancias</strong>, y cualquier detalle en las features puede alterar completamente el resultado.</p>
<table><thead><tr><th>Aspecto</th><th>¬øEs necesario?</th><th>Explicaci√≥n</th></tr></thead><tbody><tr><td><strong>Escalado (StandardScaler / MinMax)</strong></td><td><strong>‚úî Obligatorio</strong></td><td>Como KNN mide distancias, si una feature tiene valores muy grandes dominar√° la distancia total. Escalado imprescindible.</td></tr><tr><td><strong>Codificaci√≥n de categ√≥ricas</strong></td><td><strong>‚úî S√≠</strong></td><td>KNN no trabaja con texto. Se requiere <strong>One-Hot Encoding</strong> cuando no hay orden. <strong>Label Encoding puede distorsionar</strong> porque introduce un orden artificial entre categor√≠as.</td></tr><tr><td><strong>Tratamiento de outliers</strong></td><td><strong>‚úî Muy recomendado</strong></td><td>KNN es extremadamente sensible a outliers. Un valor extremo puede alterar todas las distancias y cambiar las predicciones.</td></tr><tr><td><strong>Eliminar nulos o imputarlos</strong></td><td><strong>‚úî S√≠</strong></td><td>KNN no permite nulos. Imputar es preferible a eliminar datos, ya que suele ser sensible al tama√±o de dataset.</td></tr><tr><td><strong>Eliminar columnas irrelevantes</strong></td><td><strong>‚úî Muy recomendado</strong></td><td>Cada feature influye en la distancia. Variables in√∫tiles generan ruido y empeoran la precisi√≥n.</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementaci√≥n-en-python">Implementaci√≥n en Python<a href="#implementaci√≥n-en-python" class="hash-link" aria-label="Enlace directo al Implementaci√≥n en Python" title="Enlace directo al Implementaci√≥n en Python">‚Äã</a></h2>
<p>Partimos del punto en el que el <strong>preprocesamiento ya est√° completado</strong>.
Recuerda que en el <strong>Paso 2</strong> del preprocesamiento divid√≠amos el dataset en entrenamiento y prueba:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train_test_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stratify</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Y en el <strong>Paso 3</strong> aplic√°bamos todas las transformaciones necesarias √∫nicamente sobre el conjunto de <em>train</em> (imputaci√≥n de nulos, codificaci√≥n, escalado‚Ä¶) y luego las traslad√°bamos a <em>test</em> utilizando los par√°metros aprendidos.</p>
<p>En este apartado asumimos que <strong>todo ese proceso ya est√° hecho</strong>, por lo que comenzamos directamente a trabajar con los datos <strong>ya preprocesados</strong> para entrenar y evaluar el modelo KNN.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-1-b√∫squeda-de-la-mejor-k">Paso 1. B√∫squeda de la mejor <em>k</em><a href="#paso-1-b√∫squeda-de-la-mejor-k" class="hash-link" aria-label="Enlace directo al paso-1-b√∫squeda-de-la-mejor-k" title="Enlace directo al paso-1-b√∫squeda-de-la-mejor-k">‚Äã</a></h3>
<p>Antes de entrenar definitivamente el modelo KNN, necesitamos elegir el valor √≥ptimo de <strong>k</strong>, es decir, cu√°ntos vecinos tendr√° en cuenta el algoritmo para tomar decisiones. Recuerda que la elecci√≥n de <em>k</em> influye directamente en el rendimiento del modelo.</p>
<p>Para determinar qu√© valor funciona mejor, utilizaremos un proceso llamado <strong>validaci√≥n cruzada</strong> (<em>cross-validation</em>).
Aqu√≠ veremos dos m√©todos:</p>
<ul>
<li><strong>Opci√≥n 1: 5-Fold Cross-Validation</strong> (b√∫squeda manual de k)</li>
<li><strong>Opci√≥n 2: GridSearchCV</strong> (m√©todo m√°s avanzado)</li>
</ul>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="opci√≥n-1-5-fold-cross-validation">Opci√≥n 1. 5-Fold Cross-Validation<a href="#opci√≥n-1-5-fold-cross-validation" class="hash-link" aria-label="Enlace directo al Opci√≥n 1. 5-Fold Cross-Validation" title="Enlace directo al Opci√≥n 1. 5-Fold Cross-Validation">‚Äã</a></h4>
<p>La <strong>validaci√≥n cruzada</strong> es una t√©cnica para evaluar un modelo de manera m√°s fiable y evitar depender de una √∫nica divisi√≥n train/test.</p>
<p>En lugar de entrenar el modelo una sola vez, hacemos:</p>
<ol>
<li>Dividir el conjunto de entrenamiento (X_train) en <strong>5 subconjuntos</strong> (folds).</li>
<li>Entrenar el modelo con 4 de ellos.</li>
<li>Validar con el fold restante.</li>
<li>Repetir el proceso cambiando el fold de validaci√≥n hasta completar las 5 combinaciones.</li>
<li>Calcular la <strong>media de accuracy</strong> obtenida.</li>
</ol>
<p>Esto nos da una estimaci√≥n mucho m√°s robusta del rendimiento del modelo.</p>
<p><img decoding="async" loading="lazy" alt="5 Fold" src="/DevTacora/assets/images/knn-crossval-9033078481d8dfc3e46074254f96d3db.png" width="800" height="400" class="img_ev3q"></p>
<p>El objetivo es:</p>
<blockquote>
<p>Probar varios valores de <strong>k</strong>, medir su rendimiento medio con cross-validation y elegir el que obtenga el mejor resultado.</p>
</blockquote>
<hr>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="aplicaci√≥n-de-5-fold-cv-con-varias-k">Aplicaci√≥n de 5-FOLD CV con varias k<a href="#aplicaci√≥n-de-5-fold-cv-con-varias-k" class="hash-link" aria-label="Enlace directo al Aplicaci√≥n de 5-FOLD CV con varias k" title="Enlace directo al Aplicaci√≥n de 5-FOLD CV con varias k">‚Äã</a></h5>
<p>A continuaci√≥n se muestra un ejemplo desde k = 1 hasta k = 30:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cross_val_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">neighbors </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> KNeighborsClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Rango de valores de k que queremos probar (del 1 al 30)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k_values </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Aqu√≠ iremos guardando la accuracy media de cada k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accuracy_scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Recorremos todos los posibles valores de k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> k_values</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Creamos un modelo KNN con ese valor de k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    knn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> KNeighborsClassifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_neighbors</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Aplicamos validaci√≥n cruzada (5-fold) solo sobre el conjunto de entrenamiento</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#   - cross_val_score entrena y valida el modelo 5 veces (cv=5)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#   - devuelve un array con 5 valores de accuracy (uno por cada fold)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cross_val_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">knn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Calculamos la media de esos 5 valores y la guardamos</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy_scores</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scores</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Despu√©s de ejecutar este c√≥digo, habremos evaluado <strong>30 modelos diferentes</strong>, uno por cada valor de <em>k</em> (desde 1 hasta 30).
Para cada uno de esos modelos se realiza un proceso llamado <strong>5-Fold Cross-Validation</strong>, que funciona as√≠:</p>
<ol>
<li>El conjunto de entrenamiento (<em>X_train_scaled</em>, <em>y_train</em>) se divide en <strong>5 partes iguales</strong> llamadas <em>folds</em>.</li>
<li>Para un valor concreto de k:<!-- -->
<ul>
<li>Se entrena el modelo <strong>5 veces</strong>, cada vez utilizando 4 folds para entrenar y <strong>1 fold distinto</strong> para validar.</li>
<li>En cada una de esas 5 repeticiones se obtiene una accuracy diferente.</li>
</ul>
</li>
<li>Al final, calculamos la <strong>media</strong> de esas 5 accuracies.
Esa media representa lo bien que funciona ese valor de k.</li>
<li>Repetimos el proceso para <strong>cada k</strong> del rango 1‚Äì30.</li>
</ol>
<p>Este procedimiento nos da una estimaci√≥n mucho m√°s fiable que entrenar el modelo una sola vez, ya que utiliza diferentes particiones del conjunto de entrenamiento y reduce el riesgo de depender de un √∫nico train/validation.</p>
<hr>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="gr√°fico-accuracy-vs-k">Gr√°fico: Accuracy vs k<a href="#gr√°fico-accuracy-vs-k" class="hash-link" aria-label="Enlace directo al Gr√°fico: Accuracy vs k" title="Enlace directo al Gr√°fico: Accuracy vs k">‚Äã</a></h5>
<p>Una vez obtenida la accuracy media para cada valor de <strong>k</strong> mediante 5-Fold Cross-Validation, es muy √∫til visualizar c√≥mo cambia esa accuracy en funci√≥n de k.
Este gr√°fico nos permite ver:</p>
<ul>
<li>cu√°ndo el modelo mejora,</li>
<li>cu√°ndo deja de mejorar,</li>
<li>y cu√°ndo empieza a empeorar si usamos un k demasiado grande.</li>
</ul>
<p>En lugar de representar el error, esta vez representamos directamente la <strong>accuracy media</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">figure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">figsize</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">k_values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> accuracy_scores</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;o&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xlabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Valor de k&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Accuracy medio (5-Fold)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Accuracy vs k (5-Fold Cross-Validation)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Accuracy 5-Fold" src="/DevTacora/assets/images/accuracy-5fold-fba973743ae3a3213f296816e744090c.png" width="855" height="470" class="img_ev3q"></p>
<p>El comportamiento t√≠pico de la accuracy es:</p>
<ul>
<li>
<p><strong>k peque√±o ‚Üí accuracy baja</strong>
El modelo usa pocos vecinos y es demasiado sensible al ruido.</p>
</li>
<li>
<p><strong>Zona intermedia ‚Üí accuracy m√°xima</strong>
Aqu√≠ el modelo logra un equilibrio entre simplicidad y estabilidad.
Este suele ser el <strong>mejor valor de k</strong>.</p>
</li>
<li>
<p><strong>k grande ‚Üí la accuracy vuelve a bajar</strong>
El modelo empieza a mezclar demasiados vecinos y las clases se confunden.</p>
</li>
</ul>
<hr>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="selecci√≥n-de-la-mejor-k">Selecci√≥n de la mejor <em>k</em><a href="#selecci√≥n-de-la-mejor-k" class="hash-link" aria-label="Enlace directo al selecci√≥n-de-la-mejor-k" title="Enlace directo al selecci√≥n-de-la-mejor-k">‚Äã</a></h5>
<p>El valor √≥ptimo de k es aquel que:</p>
<blockquote>
<p><strong>consigue la mayor accuracy media en validaci√≥n cruzada</strong>,
sin que la curva empiece a caer despu√©s.</p>
</blockquote>
<p>En otras palabras:</p>
<ul>
<li>buscamos el <strong>pico m√°ximo</strong> del gr√°fico,</li>
<li>pero siempre comprobando que no sea un valor extremo (por ejemplo, k=1 suele dar accuracy artificialmente alta en train y mala en test).</li>
</ul>
<p>En c√≥digo, podemos recuperar el valor as√≠:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">best_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> k_values</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">accuracy_scores</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Mejor valor de k:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> best_k</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="opci√≥n-2-gridsearchcv">Opci√≥n 2. GridSearchCV<a href="#opci√≥n-2-gridsearchcv" class="hash-link" aria-label="Enlace directo al Opci√≥n 2. GridSearchCV" title="Enlace directo al Opci√≥n 2. GridSearchCV">‚Äã</a></h4>
<p><code>GridSearchCV</code> es una herramienta de scikit-learn que <strong>automatiza todo el proceso de b√∫squeda de hiperpar√°metros</strong>, incluido el valor √≥ptimo de <em>k</em> en KNN.<br>
<!-- -->Hace exactamente lo mismo que el m√©todo manual anterior, pero de manera m√°s c√≥moda y estructurada:</p>
<ul>
<li>Prueba autom√°ticamente una lista de valores de k.</li>
<li>Aplica validaci√≥n cruzada para cada uno (por ejemplo, 5-fold).</li>
<li>Calcula la m√©trica media (accuracy por defecto).</li>
<li>Devuelve el mejor modelo y el mejor valor de k.</li>
</ul>
<p>Es decir:</p>
<blockquote>
<p><strong>GridSearchCV = Validaci√≥n cruzada + B√∫squeda de hiperpar√°metros en un solo paso.</strong></p>
</blockquote>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GridSearchCV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">neighbors </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> KNeighborsClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Definimos los valores de k que queremos probar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">param_grid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;n_neighbors&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Creamos el modelo base</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> KNeighborsClassifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Configuramos GridSearchCV:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - knn: el modelo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - param_grid: valores de k a probar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - cv=5: validaci√≥n cruzada 5-fold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - scoring=&#x27;accuracy&#x27;: m√©trica que optimiza</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GridSearchCV</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    estimator</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">knn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    param_grid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">param_grid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scoring</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;accuracy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Entrenamos GridSearchCV con el conjunto de entrenamiento preprocesado</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extraemos el mejor valor de k</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Mejor k encontrado:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_params_</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;n_neighbors&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Extraemos el mejor modelo ya entrenado</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knn_best </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> grid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_estimator_</span><br></span></code></pre></div></div>
<p><strong>Ventajas de GridSearchCV</strong></p>
<ul>
<li>Automatiza la validaci√≥n cruzada.</li>
<li>Devuelve directamente el modelo √≥ptimo.</li>
<li>Facilita probar m√∫ltiples hiperpar√°metros (no solo k).</li>
<li>Muy √∫til cuando los modelos son m√°s complejos (SVM, Random Forest, etc.).</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Nota sobre GridSearchCV</div><div class="admonitionContent_BuS1"><p>Si utilizas <strong>GridSearchCV</strong>, no necesitas realizar el <strong>Paso 2 (Entrenamiento con la mejor k)</strong>.</p><p>¬øPor qu√©?<br>
<!-- -->Porque el m√©todo:</p><ol>
<li>Prueba todos los valores de k especificados.</li>
<li>Aplica validaci√≥n cruzada para cada uno.</li>
<li>Selecciona el mejor valor de k.</li>
<li><strong>Entrena autom√°ticamente el modelo final</strong> con ese mejor valor usando todo el conjunto de entrenamiento.</li>
</ol><p>El modelo final ya est√° disponible en:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">knn_best </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> grid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_estimator_</span><br></span></code></pre></div></div><p>Este modelo se encuentra <strong>totalmente entrenado y listo para predecir</strong>, por lo que no es necesario volver a llamarlo a <code>fit()</code>.</p></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-2-entrenamiento-con-la-mejor-k">Paso 2. Entrenamiento con la mejor <em>k</em><a href="#paso-2-entrenamiento-con-la-mejor-k" class="hash-link" aria-label="Enlace directo al paso-2-entrenamiento-con-la-mejor-k" title="Enlace directo al paso-2-entrenamiento-con-la-mejor-k">‚Äã</a></h3>
<p>Una vez identificado el valor √≥ptimo de <strong>k</strong> mediante validaci√≥n cruzada, el siguiente paso es entrenar el modelo KNN definitivo utilizando <strong>todo el conjunto de entrenamiento preprocesado</strong> (<code>X_train</code> y <code>y_train</code>).</p>
<p>La l√≥gica es simple:</p>
<ol>
<li>Elegimos <code>best_k</code> (el valor de k que obtuvo la mayor accuracy media en el paso anterior).</li>
<li>Creamos un modelo KNN con ese valor.</li>
<li>Lo entrenamos utilizando <strong>todos los datos de entrenamiento</strong>, no solo los folds.</li>
</ol>
<p>De esta forma aprovechamos al m√°ximo la informaci√≥n disponible antes de evaluar en test.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Entrenar el modelo definitivo con toda la parte de entrenamiento</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">neighbors </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> KNeighborsClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knn_final </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> KNeighborsClassifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_neighbors</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">best_k</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knn_final</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>¬øPor qu√© entrenamos de nuevo?</strong></p>
<p>Durante la validaci√≥n cruzada, el modelo se entren√≥ <strong>muchas veces</strong>, pero:</p>
<ul>
<li>cada entrenamiento us√≥ solo <strong>4/5</strong> del conjunto de entrenamiento,</li>
<li>y los folds iban cambiando.</li>
</ul>
<p>Ahora que ya sabemos cu√°l es el mejor <em>k</em>, debemos entrenar el modelo final usando <strong>el 100% del conjunto de entrenamiento</strong>, para que aprenda con la m√°xima cantidad de datos posible antes de evaluar en test.</p>
<p><strong>Resultado de este paso</strong></p>
<p>Ahora ya tenemos un modelo KNN completamente entrenado con el mejor valor de <em>k</em>, listo para:</p>
<ul>
<li>hacer predicciones sobre <code>X_test</code>,</li>
<li>y evaluar su rendimiento con las m√©tricas del siguiente apartado.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-3-evaluaci√≥n-mediante-m√©tricas">Paso 3. Evaluaci√≥n mediante m√©tricas<a href="#paso-3-evaluaci√≥n-mediante-m√©tricas" class="hash-link" aria-label="Enlace directo al Paso 3. Evaluaci√≥n mediante m√©tricas" title="Enlace directo al Paso 3. Evaluaci√≥n mediante m√©tricas">‚Äã</a></h3>
<p>Una vez entrenado el modelo con el mejor valor de <strong>k</strong>, el siguiente paso es evaluar su rendimiento en el conjunto de <strong>test</strong>.
Para ello utilizaremos las m√©tricas m√°s importantes en problemas de <strong>clasificaci√≥n</strong>:</p>
<ul>
<li><strong>Accuracy</strong></li>
<li><strong>Matriz de confusi√≥n</strong></li>
<li><strong>Precision</strong></li>
<li><strong>Recall</strong></li>
<li><strong>F1-score</strong></li>
<li><strong>Support</strong></li>
</ul>
<p>Estas m√©tricas nos permiten saber <strong>qu√© tan bien est√° funcionando el modelo</strong>, si se est√° equivocando m√°s en una clase que en otra, y si tiene problemas de equilibrio entre clases.</p>
<p>Antes de evaluar el modelo, necesitamos generar las predicciones sobre el conjunto de test:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">y_pred </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> knn_final</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="accuracy">Accuracy<a href="#accuracy" class="hash-link" aria-label="Enlace directo al Accuracy" title="Enlace directo al Accuracy">‚Äã</a></h4>
<p>La <strong>accuracy</strong> mide el porcentaje de predicciones correctas sobre el total:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>accuracy</mtext><mo>=</mo><mfrac><mtext>aciertos</mtext><mtext>total</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{accuracy} = \frac{\text{aciertos}}{\text{total}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">accuracy</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0309em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3449em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">total</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">aciertos</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metrics </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> accuracy_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_pred </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> knn_final</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accuracy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> accuracy_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_pred</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Accuracy:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> accuracy</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Salida conseguida:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Accuracy: 0.8549618320610687</span><br></span></code></pre></div></div>
<p><strong>Interpretaci√≥n</strong></p>
<ul>
<li><strong>Accuracy muy alta (‚âà 0.95 o superior)</strong> ‚Üí puede parecer excelente, pero hay que tener cuidado: podr√≠a indicar sobreajuste (el modelo memoriza el entrenamiento y no generaliza bien), o un fuerte desbalanceo de clases (el modelo acierta porque predice siempre la clase mayoritaria).</li>
<li><strong>Accuracy alta (‚âà 0.85 - 0.95)</strong> ‚Üí indica buen rendimiento global, pero no garantiza que el modelo funcione bien para <em>todas</em> las clases.</li>
<li><strong>Accuracy moderada (‚âà 0.70 ‚Äì 0.85)</strong> ‚Üí el modelo capta parte del patr√≥n, pero a√∫n puede estar fallando en clases minoritarias o con datos ruidosos.</li>
<li><strong>Accuracy baja (&lt; 0.70)</strong> ‚Üí el modelo no est√° identificando correctamente la estructura del problema o las clases est√°n muy mezcladas.</li>
</ul>
<p>üí° <strong>Pero cuidado:</strong>
La accuracy por s√≠ sola puede ser enga√±osa, especialmente si las clases est√°n desbalanceadas o si el modelo tiende a predecir siempre la clase mayoritaria.</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="matriz-de-confusi√≥n">Matriz de confusi√≥n<a href="#matriz-de-confusi√≥n" class="hash-link" aria-label="Enlace directo al Matriz de confusi√≥n" title="Enlace directo al Matriz de confusi√≥n">‚Äã</a></h4>
<p>La <strong>matriz de confusi√≥n</strong> es una herramienta fundamental en clasificaci√≥n, porque permite ver exactamente <strong>c√≥mo</strong> y <strong>d√≥nde</strong> se equivoca el modelo.
No solo indica cu√°ntos aciertos tiene, sino <em>qu√© tipo de errores</em> comete:</p>
<ul>
<li><strong>TP (True Positives)</strong> ‚Üí predijo positivo y era positivo</li>
<li><strong>TN (True Negatives)</strong> ‚Üí predijo negativo y era negativo</li>
<li><strong>FP (False Positives)</strong> ‚Üí predijo positivo pero era negativo</li>
<li><strong>FN (False Negatives)</strong> ‚Üí predijo negativo pero era positivo</li>
</ul>
<p>Representarla como un <strong>mapa de calor</strong> facilita enormemente la interpretaci√≥n.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">metrics </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> confusion_matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> seaborn </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Calcular la matriz de confusi√≥n</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> confusion_matrix</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_pred</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Representaci√≥n como mapa de calor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">figure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">figsize</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">heatmap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> annot</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fmt</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;d&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cmap</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Blues&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            xticklabels</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Predicci√≥n: 0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Predicci√≥n: 1&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            yticklabels</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Real: 0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Real: 1&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Matriz de Confusi√≥n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xlabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Predicciones&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Valores reales&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><strong>C√≥mo interpretar el mapa de calor</strong></p>
<p><img decoding="async" loading="lazy" alt="Gr√°fico EDA" src="/DevTacora/assets/images/matriz-confusion-00af5b243a4b83d1922934ff08218b00.png" width="510" height="393" class="img_ev3q"></p>
<p><strong>Interpretaci√≥n general:</strong></p>
<ul>
<li><strong>TN (arriba izquierda)</strong>: n√∫mero de negativos bien clasificados</li>
<li><strong>TP (abajo derecha)</strong>: n√∫mero de positivos bien clasificados</li>
<li><strong>FP (arriba derecha)</strong>: el modelo predijo positivo pero era negativo<!-- -->
<ul>
<li>error t√≠pico cuando el modelo es demasiado ‚Äúoptimista‚Äù</li>
</ul>
</li>
<li><strong>FN (abajo izquierda)</strong>: el modelo predijo negativo pero era positivo<!-- -->
<ul>
<li>error cr√≠tico en muchos problemas (fraude, enfermedad, fallos, etc.)</li>
</ul>
</li>
</ul>
<p><strong>¬øQu√© nos indica una buena matriz de confusi√≥n?</strong></p>
<ul>
<li>Los n√∫meros grandes deben estar en la <strong>diagonal principal</strong> (TN y TP).</li>
<li>Los valores <strong>fuera de la diagonal</strong> deben ser lo m√°s peque√±os posible.</li>
<li>Muchos <strong>FN</strong> ‚Üí el modelo est√° ‚Äúdejando pasar‚Äù positivos ‚Üí problema si queremos detectar casos sensibles (fraudes, enfermedades‚Ä¶).</li>
<li>Muchos <strong>FP</strong> ‚Üí el modelo dispara demasiadas alarmas falsas.</li>
</ul>
<p><strong>üí° Conclusi√≥n</strong></p>
<blockquote>
<p>La matriz de confusi√≥n no solo dice ‚Äúcu√°nto acierta el modelo‚Äù,
sino <strong>en qu√© acierta y en qu√© falla</strong>, lo cual es esencial para entender si el modelo es realmente √∫til para la tarea.</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flujo-recomendado-en-un-problema-de-knn">Flujo recomendado en un problema de KNN<a href="#flujo-recomendado-en-un-problema-de-knn" class="hash-link" aria-label="Enlace directo al Flujo recomendado en un problema de KNN" title="Enlace directo al Flujo recomendado en un problema de KNN">‚Äã</a></h2>
<p>El proceso para resolver un problema de clasificaci√≥n con <strong>K-Nearest Neighbors (KNN)</strong> sigue una serie de pasos muy claros. El rendimiento de KNN depende fuertemente del <strong>preprocesamiento</strong> y de la <strong>elecci√≥n de k</strong>, por lo que un flujo bien estructurado es fundamental.</p>
<table><thead><tr><th>Paso</th><th>¬øQu√© se hace?</th><th>¬øPor qu√© es importante?</th></tr></thead><tbody><tr><td><strong>Paso 1. EDA</strong></td><td>Analizar cada variable, ver distribuciones, relaci√≥n con la target, detectar outliers.</td><td>KNN depende totalmente de las distancias: valores extremos o mezclados afectan mucho al modelo.</td></tr><tr><td><strong>Paso 2. Preprocesamiento</strong></td><td>Imputaci√≥n de nulos, One-Hot Encoding, <strong>escalado</strong>, eliminaci√≥n de columnas irrelevantes, tratamiento de outliers.</td><td>KNN es extremadamente sensible a diferencias de escala y ruido. Buen prepro = buen modelo.</td></tr><tr><td><strong>Paso 3. B√∫squeda de la mejor k</strong></td><td>Probar varios valores de k usando validaci√≥n cruzada o GridSearchCV.</td><td>Elegir k correctamente evita overfitting (k peque√±o) y underfitting (k grande).</td></tr><tr><td><strong>Paso 4. Entrenamiento del modelo final</strong></td><td>Entrenar un KNN con el mejor valor de k usando todo el conjunto de entrenamiento.</td><td>Se obtiene la versi√≥n definitiva del modelo, lista para evaluar.</td></tr><tr><td><strong>Paso 5. An√°lisis overfitting / underfitting</strong></td><td>Comparar accuracy en <strong>train</strong> y <strong>test</strong>. Seg√∫n el resultado obtenido, deber√≠amos buscar una k mejor (no eber√≠amos tener este problema si usamos GridSearch)</td><td>k muy peque√±o ‚Üí overfitting. k muy grande ‚Üí underfitting.</td></tr><tr><td><strong>Paso 6. M√©tricas de evaluaci√≥n</strong></td><td>Accuracy y matriz de confusi√≥n.</td><td>Permiten medir c√≥mo rinde realmente KNN en datos nuevos y si confunde clases.</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="actividad-de-seguimiento-retenci√≥n-de-empleados">Actividad de Seguimiento: Retenci√≥n de empleados<a href="#actividad-de-seguimiento-retenci√≥n-de-empleados" class="hash-link" aria-label="Enlace directo al Actividad de Seguimiento: Retenci√≥n de empleados" title="Enlace directo al Actividad de Seguimiento: Retenci√≥n de empleados">‚Äã</a></h2>
<p>El objetivo de la actividad es realizar el <strong>Preprocesamiento</strong> sobre el dataset <strong>Employee Attrition</strong> y aplicar el modelo KNN sobre √©l, con el fin de <strong>predecir la rotaci√≥n laboral</strong> (abandono o permanencia en la empresa).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dataset">Dataset<a href="#dataset" class="hash-link" aria-label="Enlace directo al Dataset" title="Enlace directo al Dataset">‚Äã</a></h3>
<p><strong>Fichero:</strong> <a href="/DevTacora/assets/files/employee-611bdcd619dee88800db232fcaf1504b.csv" target="_blank"><code>employee.csv</code></a><br>
<strong>M√°s informaci√≥n:</strong> <a href="https://www.kaggle.com/datasets/pavansubhasht/ibm-hr-analytics-attrition-dataset" target="_blank" rel="noopener noreferrer">Kaggle</a><br>
<strong>Variable objetivo (target):</strong> <code>Attrition</code></p>
<ul>
<li><code>Yes</code> ‚Üí el empleado dej√≥ la empresa</li>
<li><code>No</code> ‚Üí el empleado sigue trabajando</li>
</ul>
<p><strong>Nota</strong>: recuerda que ya hiciste el EDA de este dataset, parte de ese an√°lisis para no repetir trabajo.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="entregable">Entregable<a href="#entregable" class="hash-link" aria-label="Enlace directo al Entregable" title="Enlace directo al Entregable">‚Äã</a></h3>
<p>Un <strong>cuaderno de Google Colab</strong> con:</p>
<ul>
<li><strong>Preprocesamiento completo</strong> del dataset</li>
<li><strong>Aplicaci√≥n del modelo KNN</strong>:<!-- -->
<ul>
<li>B√∫squeda de la mejor k</li>
<li>Entrenamiento con la mejor k</li>
<li>Evaluaci√≥n mediante m√©tricas</li>
</ul>
</li>
<li>Recuerda incluir <strong>conclusiones y comentarios</strong> sobre las tareas que vas realizando.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="P√°gina del documento"><a class="pagination-nav__link pagination-nav__link--prev" href="/DevTacora/docs/category/clasificaci√≥n"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">Clasificaci√≥n</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/arbol-decision"><div class="pagination-nav__sublabel">Siguiente</div><div class="pagination-nav__label">Decision Trees</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#c√≥mo-funciona-knn" class="table-of-contents__link toc-highlight">C√≥mo funciona KNN</a><ul><li><a href="#distancias" class="table-of-contents__link toc-highlight">Distancias</a></li><li><a href="#el-par√°metro-k-y-su-efecto-en-el-modelo" class="table-of-contents__link toc-highlight">El par√°metro k y su efecto en el modelo</a></li><li><a href="#proceso-de-predicci√≥n-paso-a-paso" class="table-of-contents__link toc-highlight">Proceso de predicci√≥n paso a paso</a></li></ul></li><li><a href="#cu√°ndo-se-utiliza-y-principales-caracter√≠sticas" class="table-of-contents__link toc-highlight">Cu√°ndo se utiliza y principales caracter√≠sticas</a></li><li><a href="#ventajas" class="table-of-contents__link toc-highlight">Ventajas</a></li><li><a href="#limitaciones" class="table-of-contents__link toc-highlight">Limitaciones</a></li><li><a href="#importancia-del-preprocesamiento" class="table-of-contents__link toc-highlight">Importancia del preprocesamiento</a></li><li><a href="#implementaci√≥n-en-python" class="table-of-contents__link toc-highlight">Implementaci√≥n en Python</a><ul><li><a href="#paso-1-b√∫squeda-de-la-mejor-k" class="table-of-contents__link toc-highlight">Paso 1. B√∫squeda de la mejor <em>k</em></a><ul><li><a href="#opci√≥n-1-5-fold-cross-validation" class="table-of-contents__link toc-highlight">Opci√≥n 1. 5-Fold Cross-Validation</a><ul><li><a href="#aplicaci√≥n-de-5-fold-cv-con-varias-k" class="table-of-contents__link toc-highlight">Aplicaci√≥n de 5-FOLD CV con varias k</a></li><li><a href="#gr√°fico-accuracy-vs-k" class="table-of-contents__link toc-highlight">Gr√°fico: Accuracy vs k</a></li><li><a href="#selecci√≥n-de-la-mejor-k" class="table-of-contents__link toc-highlight">Selecci√≥n de la mejor <em>k</em></a></li></ul></li><li><a href="#opci√≥n-2-gridsearchcv" class="table-of-contents__link toc-highlight">Opci√≥n 2. GridSearchCV</a></li></ul></li><li><a href="#paso-2-entrenamiento-con-la-mejor-k" class="table-of-contents__link toc-highlight">Paso 2. Entrenamiento con la mejor <em>k</em></a></li><li><a href="#paso-3-evaluaci√≥n-mediante-m√©tricas" class="table-of-contents__link toc-highlight">Paso 3. Evaluaci√≥n mediante m√©tricas</a><ul><li><a href="#accuracy" class="table-of-contents__link toc-highlight">Accuracy</a></li><li><a href="#matriz-de-confusi√≥n" class="table-of-contents__link toc-highlight">Matriz de confusi√≥n</a></li></ul></li></ul></li><li><a href="#flujo-recomendado-en-un-problema-de-knn" class="table-of-contents__link toc-highlight">Flujo recomendado en un problema de KNN</a></li><li><a href="#actividad-de-seguimiento-retenci√≥n-de-empleados" class="table-of-contents__link toc-highlight">Actividad de Seguimiento: Retenci√≥n de empleados</a><ul><li><a href="#dataset" class="table-of-contents__link toc-highlight">Dataset</a></li><li><a href="#entregable" class="table-of-contents__link toc-highlight">Entregable</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">
        <section classname="bg-white border-t border-gray-100">
      <div classname="max-w-4xl mx-auto px-6 py-16 text-center">
        <h3 classname="text-2xl font-bold text-gray-900 mb-4">
          Construyendo conocimiento, l√≠nea por l√≠nea
        </h3>
        <p classname="text-gray-600 leading-relaxed">
          ¬© 2025 Alicia C√°mara Casares - Contenido bajo licencia 
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer" classname="text-blue-600 hover:text-blue-700 underline">
                CC BY-NC-SA 4.0
              </a>.
        </p>
      </div>
    </section>
      </div></div></div></footer></div>
</body>
</html>