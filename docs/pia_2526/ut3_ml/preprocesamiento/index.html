<!doctype html>
<html lang="es" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-pia_2526/ut3_ml/preprocesamiento" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Preprocesamiento de Datos | DevTacora</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://acamarac02.github.io/DevTacora/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://acamarac02.github.io/DevTacora/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento"><meta data-rh="true" property="og:locale" content="es"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Preprocesamiento de Datos | DevTacora"><meta data-rh="true" name="description" content="Introducci√≥n al Preprocesamiento de Datos en Machine Learning. Qu√© es, por qu√© se realiza despu√©s del EDA, principales pasos para limpiar, transformar y preparar los datos antes del modelado utilizando pandas y scikit-learn."><meta data-rh="true" property="og:description" content="Introducci√≥n al Preprocesamiento de Datos en Machine Learning. Qu√© es, por qu√© se realiza despu√©s del EDA, principales pasos para limpiar, transformar y preparar los datos antes del modelado utilizando pandas y scikit-learn."><meta data-rh="true" name="keywords" content="Preprocesamiento,Machine Learning,pandas,scikit-learn,limpieza de datos,escalado,codificaci√≥n,preparaci√≥n de datos"><link data-rh="true" rel="icon" href="/DevTacora/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento"><link data-rh="true" rel="alternate" href="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento" hreflang="es"><link data-rh="true" rel="alternate" href="https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"UT3. Machine Learning","item":"https://acamarac02.github.io/DevTacora/docs/category/ut3-machine-learning"},{"@type":"ListItem","position":2,"name":"Preprocesamiento de Datos","item":"https://acamarac02.github.io/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento"}]}</script><link rel="alternate" type="application/rss+xml" href="/DevTacora/blog/rss.xml" title="DevTacora RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/DevTacora/blog/atom.xml" title="DevTacora Atom Feed">




<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7WCKN9ZY1F"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-7WCKN9ZY1F",{anonymize_ip:!0})</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/DevTacora/assets/css/styles.71ba2beb.css">
<script src="/DevTacora/assets/js/runtime~main.7281359a.js" defer="defer"></script>
<script src="/DevTacora/assets/js/main.8213481a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav aria-label="Principal" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Alternar barra lateral" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/DevTacora/"><div class="navbar__logo"><img src="/DevTacora/img/devtacora_logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/DevTacora/img/devtacora_logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">DevTacora</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/DevTacora/docs/pia_2526/">PIA</a><a class="navbar__item navbar__link" href="/DevTacora/docs/pmdm_2526/">PMDM</a><a class="navbar__item navbar__link" href="/DevTacora/docs/category/ut5-persistencia-de-datos">PMDM 24-25</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/DevTacora/docs/licencia">Licencia</a><a href="https://www.linkedin.com/in/aliciacamcas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Cambiar entre modo oscuro y claro (actualmente system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Barra lateral de Documentos" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/DevTacora/docs/pia_2526/">Presentaci√≥n</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/DevTacora/docs/category/ut1-introducci√≥n-a-la-ia">UT1. Introducci√≥n a la IA</a><button aria-label="Ampliar la categor√≠a &#x27;UT1. Introducci√≥n a la IA&#x27; de la barra lateral" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/DevTacora/docs/category/ut2-python-para-la-ia">UT2. Python para la IA</a><button aria-label="Ampliar la categor√≠a &#x27;UT2. Python para la IA&#x27; de la barra lateral" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/DevTacora/docs/category/ut3-machine-learning">UT3. Machine Learning</a><button aria-label="Colapsar categor√≠a &#x27;UT3. Machine Learning&#x27; de la barra lateral" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/introduccion">Introducci√≥n</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/primer-modelo">Primer modelo de ML: Titanic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/eda">Exploratory Data Analysis (EDA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/DevTacora/docs/pia_2526/ut3_ml/preprocesamiento">Preprocesamiento de Datos</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/DevTacora/docs/category/aprendizaje-supervisado">Aprendizaje supervisado</a><button aria-label="Ampliar la categor√≠a &#x27;Aprendizaje supervisado&#x27; de la barra lateral" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Rastro de navegaci√≥n"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="P√°gina de Inicio" class="breadcrumbs__link" href="/DevTacora/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/DevTacora/docs/category/ut3-machine-learning"><span>UT3. Machine Learning</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Preprocesamiento de Datos</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">En esta p√°gina</button></div><div class="theme-doc-markdown markdown"><header><h1>Preprocesamiento de Datos</h1></header><div class="justify-text"><p>El <strong>Preprocesamiento de Datos</strong> es la <strong>segunda etapa del proceso de Machine Learning</strong>, y comienza justo despu√©s de haber realizado el <strong>An√°lisis Exploratorio de Datos (EDA)</strong>.<br>
<!-- -->Si en el EDA analizamos y comprendemos los datos, en el preprocesamiento el objetivo es <strong>prepararlos adecuadamente</strong> para que los algoritmos de aprendizaje autom√°tico puedan trabajar con ellos de forma correcta y eficiente.</p><p>Durante esta fase, se realizan todas las tareas necesarias para <strong>limpiar, transformar y estandarizar</strong> los datos.<br>
<!-- -->Esto incluye, por ejemplo, rellenar valores nulos, eliminar duplicados, codificar variables categ√≥ricas o escalar las num√©ricas.</p><div class="hidden-summary"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introducci√≥n">Introducci√≥n<a href="#introducci√≥n" class="hash-link" aria-label="Enlace directo al Introducci√≥n" title="Enlace directo al Introducci√≥n">‚Äã</a></h2></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="por-qu√©-es-esencial-tras-el-eda">¬øPor qu√© es esencial tras el EDA?<a href="#por-qu√©-es-esencial-tras-el-eda" class="hash-link" aria-label="Enlace directo al ¬øPor qu√© es esencial tras el EDA?" title="Enlace directo al ¬øPor qu√© es esencial tras el EDA?">‚Äã</a></h3><p>El EDA nos permite descubrir <strong>problemas o irregularidades</strong> en el dataset: valores perdidos, outliers, tipos de datos incorrectos o variables irrelevantes.<br>
<!-- -->El preprocesamiento es la fase donde <strong>se corrigen esos problemas</strong> y se dejan los datos listos para el modelado.</p><table><thead><tr><th>Etapa</th><th>Objetivo principal</th><th>Tipo de tareas</th></tr></thead><tbody><tr><td><strong>EDA</strong></td><td>Comprender los datos y detectar patrones o errores.</td><td>An√°lisis descriptivo, visualizaci√≥n, detecci√≥n de nulos y outliers.</td></tr><tr><td><strong>Preprocesamiento</strong></td><td>Corregir, transformar y preparar los datos para el modelo.</td><td>Limpieza, imputaci√≥n, codificaci√≥n, escalado, selecci√≥n de variables.</td></tr></tbody></table><p>üí¨ <strong>Ejemplo:</strong>
En el Titanic, durante el EDA descubrimos que hay valores nulos en <code>Age</code> y <code>Cabin</code>, y que <code>Fare</code> tiene outliers.<br>
<!-- -->En el preprocesamiento, decidiremos <strong>c√≥mo rellenar esos nulos</strong>, <strong>si eliminar o ajustar los outliers</strong>, y <strong>c√≥mo convertir las variables categ√≥ricas</strong> (como <code>Sex</code> o <code>Embarked</code>) a formato num√©rico.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objetivos-del-preprocesamiento">Objetivos del preprocesamiento<a href="#objetivos-del-preprocesamiento" class="hash-link" aria-label="Enlace directo al Objetivos del preprocesamiento" title="Enlace directo al Objetivos del preprocesamiento">‚Äã</a></h3><p>El objetivo final es dejar el dataset:</p><ul>
<li><strong>Limpio:</strong> sin errores, duplicados ni valores faltantes.</li>
<li><strong>Coherente:</strong> con tipos de datos correctos y valores representativos.</li>
<li><strong>Preparado:</strong> con todas las variables transformadas en un formato num√©rico adecuado para los modelos de Machine Learning.</li>
</ul><p>En otras palabras, buscamos que los datos sean <strong>de calidad y comparables entre s√≠</strong>, para que el modelo aprenda de forma fiable.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="herramientas-que-usaremos">Herramientas que usaremos<a href="#herramientas-que-usaremos" class="hash-link" aria-label="Enlace directo al Herramientas que usaremos" title="Enlace directo al Herramientas que usaremos">‚Äã</a></h3><p>En Python, las principales herramientas para el preprocesamiento son:</p><ul>
<li><strong><code>pandas</code></strong> ‚Üí para limpiar, transformar y manipular los datos.</li>
<li><strong><code>scikit-learn (sklearn.preprocessing)</code></strong> ‚Üí para aplicar transformaciones autom√°ticas como imputaci√≥n, codificaci√≥n y escalado.</li>
</ul><p>Estas librer√≠as se complementan y permiten llevar a cabo todo el flujo de preparaci√≥n de datos antes de entrenar el modelo.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="paso-1-operaciones-antes-de-la-divisi√≥n">Paso 1. Operaciones antes de la divisi√≥n<a href="#paso-1-operaciones-antes-de-la-divisi√≥n" class="hash-link" aria-label="Enlace directo al Paso 1. Operaciones antes de la divisi√≥n" title="Enlace directo al Paso 1. Operaciones antes de la divisi√≥n">‚Äã</a></h2><p>Antes de separar el dataset en conjuntos de entrenamiento (<em>train</em>) y prueba (<em>test</em>), debemos realizar una <strong>limpieza estructural b√°sica</strong>.<br>
<!-- -->Este paso no modifica el contenido estad√≠stico de los datos, sino que se asegura de que el dataset sea <strong>coherente, entendible y correctamente tipado</strong>.</p><p>Estas operaciones se hacen <strong>antes de dividir</strong> porque afectan por igual a todos los registros y no implican ning√∫n tipo de aprendizaje sobre los valores de los datos (no calculan medias, ni modas, ni escalados).</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-11-limpieza-estructural">Paso 1.1 Limpieza estructural<a href="#paso-11-limpieza-estructural" class="hash-link" aria-label="Enlace directo al Paso 1.1 Limpieza estructural" title="Enlace directo al Paso 1.1 Limpieza estructural">‚Äã</a></h3><p>El objetivo de la limpieza estructural es <strong>asegurar que el dataset est√© bien formado</strong>:</p><ul>
<li>Comprobar que los tipos de datos son correctos.</li>
<li>Corregir formatos o errores de escritura en las variables.</li>
</ul><p>A continuaci√≥n veremos cada una de estas operaciones aplicadas al dataset <strong>Titanic</strong>.</p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="correcci√≥n-de-tipos-de-datos">Correcci√≥n de tipos de datos<a href="#correcci√≥n-de-tipos-de-datos" class="hash-link" aria-label="Enlace directo al Correcci√≥n de tipos de datos" title="Enlace directo al Correcci√≥n de tipos de datos">‚Äã</a></h4><p>Los tipos de datos son fundamentales.
Pandas puede leer columnas con el tipo incorrecto (por ejemplo, n√∫meros como texto o fechas como <code>object</code>), lo que puede generar errores en el an√°lisis y el modelado.</p><p>Podemos revisar los tipos con:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Si detectamos alguna columna con tipo err√≥neo, podemos convertirla usando <code>astype()</code>.</p><p>Ejemplo: supongamos que una columna num√©rica ha sido le√≠da como texto (<code>object</code>):</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Convertir una columna a tipo num√©rico</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n te√≥rica:</strong></p><ul>
<li>Los modelos de Machine Learning requieren que <strong>las variables num√©ricas sean realmente num√©ricas</strong>, no cadenas de texto.</li>
<li>Asegurar los tipos correctos evita errores posteriores en imputaci√≥n, escalado o codificaci√≥n.</li>
</ul><p>üí¨ <strong>Conclusi√≥n:</strong></p><blockquote>
<p>Revisar y corregir los tipos de datos garantiza que todas las columnas se comporten como se espera en las transformaciones posteriores.</p>
</blockquote><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="normalizaci√≥n-de-formatos-y-categor√≠as">Normalizaci√≥n de formatos y categor√≠as<a href="#normalizaci√≥n-de-formatos-y-categor√≠as" class="hash-link" aria-label="Enlace directo al Normalizaci√≥n de formatos y categor√≠as" title="Enlace directo al Normalizaci√≥n de formatos y categor√≠as">‚Äã</a></h4><p>En las variables categ√≥ricas o de texto, a veces encontramos <strong>errores de formato</strong>:</p><ul>
<li>Espacios en blanco (<code>&quot; S &quot;</code> en lugar de <code>&quot;S&quot;</code>).</li>
<li>May√∫sculas/min√∫sculas mezcladas (<code>&quot;Male&quot;</code> vs <code>&quot;male&quot;</code>).</li>
<li>Valores mal escritos (<code>&quot;Southampton&quot;</code> vs <code>&quot;southampton&quot;</code>).</li>
</ul><p>Estos errores de formato los veriamos al ejecutar <code>unique()</code> sobre una variable categ√≥rica o al generar gr√°ficos sobre ellas. A continuaci√≥n se muestra un ejemplo donde metemos una dato err√≥neo en Titanic para estudiar c√≥mo solucionarlo:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Crear una nueva fila con &quot;Male&quot; como sexo para que podamos ver el error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nueva_fila </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;PassengerId&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9999</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Survived&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Pclass&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Name&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Smith, Mr. John&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Sex&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Male&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Ticket&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A/5 9999&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7.25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Cabin&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;S&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># A√±adir la fila al DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">nueva_fila</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ignore_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mostrar los valores √∫nicos de la columna &#x27;Sex&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Sex&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>La salida obtenida en este caso ser√≠a:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;male&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;female&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Male&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Estos detalles pueden hacer que el modelo interprete <strong>dos valores iguales como distintos</strong>, lo que distorsiona la codificaci√≥n posterior.</p><p>Ese problema anterior se solucionar√≠a pasando a min√∫sculas todos los valores:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Normalizar los valores de la columna &#x27;Sex&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Pasamos a min√∫sculas y, de paso, eliminamos posibles espacios</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Sex&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Sex&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verificar que se ha corregido</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Sex&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Salida esperada:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;male&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;female&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Si aparecieran errores tipogr√°ficos, se pueden reemplazar manualmente:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Ejemplo: sustituir valores incorrectos (si los hubiera)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;SOUTHAMPTON&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;S&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CHERBOURG&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;QUEENSTOWN&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Q&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n te√≥rica:</strong></p><ul>
<li>La <strong>homogeneizaci√≥n de categor√≠as</strong> es clave para que el modelo reconozca correctamente las clases.</li>
<li>Si dos valores equivalentes se escriben distinto, el modelo los tratar√° como categor√≠as diferentes.</li>
</ul><p>üí¨ <strong>Conclusi√≥n:</strong></p><blockquote>
<p>Antes de codificar las variables categ√≥ricas, debemos garantizar que todas las categor√≠as est√©n escritas de forma uniforme.</p>
</blockquote><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-12-duplicados">Paso 1.2 Duplicados<a href="#paso-12-duplicados" class="hash-link" aria-label="Enlace directo al Paso 1.2 Duplicados" title="Enlace directo al Paso 1.2 Duplicados">‚Äã</a></h3><p>En muchos datasets reales, especialmente cuando los datos provienen de distintas fuentes o se han unido varios ficheros, es frecuente encontrar <strong>filas duplicadas</strong>.<br>
<!-- -->Estas duplicidades pueden provocar que el modelo <strong>aprenda varias veces la misma informaci√≥n</strong>, generando sesgos o influyendo en las estad√≠sticas de forma incorrecta.</p><p>Por eso, un paso b√°sico de la limpieza estructural consiste en <strong>detectar y eliminar los registros duplicados</strong> antes de seguir con el preprocesamiento.</p><p>En el An√°lisis Exploratorio de Datos ya estudiamos c√≥mo consultar los duplicados:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Comprobar si hay filas duplicadas en el dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Salida esperada (en el Titanic original):</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">0</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n te√≥rica:</strong></p><ul>
<li>Si el resultado es <code>0</code>, significa que <strong>no hay filas duplicadas exactas</strong>.</li>
<li>Si devuelve un n√∫mero mayor que <code>0</code>, indica cu√°ntos registros est√°n repetidos completamente.</li>
</ul><p>Podemos ver cu√°les son esas filas duplicadas con:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Mostrar las filas duplicadas (si las hubiera)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div><p>Si detectamos registros repetidos, se eliminan f√°cilmente con <code>drop_duplicates()</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Eliminar filas duplicadas</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop_duplicates</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n te√≥rica:</strong></p><ul>
<li>Por defecto, <code>drop_duplicates()</code> elimina las filas repetidas <strong>manteniendo la primera aparici√≥n</strong>.</li>
<li>Este m√©todo elimina duplicados considerando <strong>todas las columnas</strong>.</li>
</ul><div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Nota importante sobre el orden EDA ‚Üí Preprocesamiento</div><div class="admonitionContent_BuS1"><p>Los pasos <strong>1.1 (Correcci√≥n de tipos y normalizaci√≥n de categor√≠as)</strong> y <strong>1.2 (Eliminaci√≥n de columnas irrelevantes o duplicadas)</strong> pueden realizarse <strong>durante el EDA</strong>, antes de generar gr√°ficos univariantes y bivariantes.
Esto permite obtener <strong>gr√°ficos limpios y coherentes</strong>, evitando categor√≠as duplicadas (‚Äúmale‚Äù, ‚ÄúMale‚Äù, ‚Äú male ‚Äù), tipos incorrectos o columnas que no aportan valor visual.</p><p>Sin embargo, <strong>todos los pasos restantes del preprocesamiento</strong> (tratamiento de valores imposibles, imputaci√≥n, codificaci√≥n, escalado, feature engineering‚Ä¶) <strong>deben realizarse √∫nicamente despu√©s de completar el EDA</strong>, cuando ya se ha comprendido la estructura y los problemas del dataset.</p></div></div><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-13-outliers-y-errores-evidentes">Paso 1.3 Outliers y errores evidentes<a href="#paso-13-outliers-y-errores-evidentes" class="hash-link" aria-label="Enlace directo al Paso 1.3 Outliers y errores evidentes" title="Enlace directo al Paso 1.3 Outliers y errores evidentes">‚Äã</a></h3><p>Los <strong>outliers</strong> (valores at√≠picos) son datos que se alejan mucho del resto de observaciones. A veces son simplemente <strong>casos reales extremos</strong> (por ejemplo, una tarifa muy alta en primera clase), pero otras veces se deben a <strong>errores de registro o introducci√≥n de datos</strong> (por ejemplo, una edad de 250 a√±os).</p><p>En esta fase inicial del preprocesamiento, <strong>no buscamos eliminar todos los valores extremos</strong>, sino <strong>detectar y corregir solo los claramente imposibles o err√≥neos</strong>.</p><p>Una forma sencilla de detectar outliers es mediante un <strong>boxplot (diagrama de caja)</strong>. Por ejemplo, si introducimos un registro nuevo con una edad de 250 a√±os, podr√≠amos ver lo siguiente:</p><p><img decoding="async" loading="lazy" alt="Gr√°fico EDA" src="/DevTacora/assets/images/boxplot-valor-erroneo-1176351e75914a967e0dcbad609d797d.png" width="489" height="240" class="img_ev3q"></p><p>No todos los outliers deben eliminarse. Algunos son <strong>casos reales v√°lidos</strong>, y eliminarlos podr√≠a distorsionar el modelo.
Por eso, antes de borrar nada, conviene preguntarse:</p><blockquote>
<p>¬øEste valor es posible en el contexto del dataset?</p>
</blockquote><p>Veamos ejemplos:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Revisar valores m√°ximos en columnas num√©ricas</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Posible salida:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Age     80.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Fare    512.3292</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtype: float64</span><br></span></code></pre></div></div><p>üí° <strong>Interpretaci√≥n:</strong></p><ul>
<li>Una edad de 80 a√±os es realista (no hay problema).</li>
<li>Una tarifa de m√°s de 500 tambi√©n puede ser v√°lida para pasajeros de primera clase.</li>
<li>Pero si encontr√°ramos una edad de <strong>250 a√±os</strong> o un valor negativo en la tarifa (<code>Fare = -10</code>), ser√≠an claramente errores de registro.</li>
</ul><p>Podemos usar condiciones simples para <strong>detectar valores imposibles</strong> y corregirlos o eliminarlos. En nuestro caso, vamos a sustituirlos por valores vac√≠os, que m√°s tarde se imputar√°n.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Ejemplo: eliminar edades imposibles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ejemplo: corregir tarifas negativas (si existieran)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Esto aprende de datos, se deber√≠a hacer despu√©s de dividir en train y test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">median</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n te√≥rica:</strong></p><ul>
<li>Usamos <strong>filtros l√≥gicos</strong> (<code>df[&quot;Age&quot;] &lt;= 100</code>) para quedarnos solo con valores v√°lidos.</li>
<li>Si un valor err√≥neo es aislado y no queremos eliminar la fila completa, podemos <strong>reemplazarlo</strong> por un valor representativo (por ejemplo, la mediana).</li>
</ul><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>CUIDADO CON EL TRATAMIENTO DE LOS OUTLIERS</div><div class="admonitionContent_BuS1"><p>Si lo que queremos es <strong>corregir datos</strong>, como el caso de la tarifa que se explicaba antes, habr√≠a que hacerlo <strong>despu√©s de dividir en train y test</strong>.</p></div></div><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="paso-2-divisi√≥n-en-traintest">Paso 2. Divisi√≥n en <em>train/test</em><a href="#paso-2-divisi√≥n-en-traintest" class="hash-link" aria-label="Enlace directo al paso-2-divisi√≥n-en-traintest" title="Enlace directo al paso-2-divisi√≥n-en-traintest">‚Äã</a></h2><p>Una vez que el dataset est√° limpio a nivel <strong>estructural</strong> (sin duplicados, sin columnas irrelevantes, sin tipos incorrectos y sin errores evidentes), estamos listos para el paso m√°s importante del flujo de Machine Learning: la <strong>divisi√≥n en conjuntos de entrenamiento y prueba</strong>.</p><p>Este paso es fundamental para construir modelos fiables y evaluar su rendimiento de forma justa.</p><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>¬øPor qu√© dividir antes de ‚Äúaprender‚Äù par√°metros?</div><div class="admonitionContent_BuS1"><p>Cada vez que aplicamos una t√©cnica de preprocesamiento que <strong>aprende algo de los datos</strong>, como calcular la <strong>mediana</strong> para imputar nulos, determinar las <strong>categor√≠as</strong> para One-Hot Encoding, calcular la <strong>media y desviaci√≥n</strong> para escalar, estamos extrayendo <strong>informaci√≥n estad√≠stica</strong> del dataset.</p><p>Si hacemos esta extracci√≥n <strong>antes</strong> de dividir, estar√≠amos utilizando <strong>informaci√≥n del futuro</strong> (del conjunto de test) para preparar nuestros datos. Esto se llama <strong>data leakage</strong> (<em>filtraci√≥n de datos</em>), y provoca:</p><ul>
<li>modelos que parecen m√°s precisos de lo que realmente son,</li>
<li>una evaluaci√≥n injusta,</li>
<li>generalizaci√≥n mucho peor en datos nuevos.</li>
</ul><p>üí° <strong>Regla de oro del preprocesamiento:</strong></p><blockquote>
<p>Todo lo que <strong>aprende par√°metros</strong> debe ajustarse <strong>solo con los datos de entrenamiento</strong>, y luego aplicarse a los datos de prueba sin volver a aprender nada.</p>
</blockquote></div></div><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-21-separar-las-features-y-target">Paso 2.1. Separar las features y target<a href="#paso-21-separar-las-features-y-target" class="hash-link" aria-label="Enlace directo al Paso 2.1. Separar las features y target" title="Enlace directo al Paso 2.1. Separar las features y target">‚Äã</a></h3><p>Antes de dividir, debemos indicar:</p><ul>
<li>qu√© columnas vamos a usar para predecir ‚Üí <strong>X</strong> (features)</li>
<li>qu√© columna queremos predecir ‚Üí <strong>y</strong> (target)</li>
</ul><p>Ejemplo con Titanic:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Seleccionamos las columnas relevantes (features) y la variable objetivo (target)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># En EDA ya dejamos claro que Name, Cabin, etc. no eran √∫tiles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Pclass&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Sex&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Age&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Fare&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SibSp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Parch&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Embarked&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Survived&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n te√≥rica:</strong></p><ul>
<li><code>X</code> contiene todas las variables que el modelo utilizar√° como entrada.</li>
<li><code>y</code> contiene √∫nicamente la variable que queremos predecir.</li>
<li>Usamos <code>.copy()</code> para evitar modificar el DataFrame original cuando realicemos transformaciones posteriores.</li>
</ul><p>Supongamos que nuestro Dataframe (variable <code>df</code>) contiene:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   Survived  Pclass     Sex   Age   Fare  SibSp  Parch Embarked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0         0       3    male  22.0   7.25      1      0        S</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1         1       1  female  38.0  71.28      1      0        C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2         1       3  female  26.0   7.92      0      0        S</span><br></span></code></pre></div></div><p>Despu√©s de aplicar el c√≥digo anterior, la variable <code>X</code> ser√≠a un Dataframe con el contenido:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   Pclass     Sex   Age   Fare  SibSp  Parch Embarked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0       3    male  22.0   7.25      1      0        S</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1       1  female  38.0  71.28      1      0        C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2       3  female  26.0   7.92      0      0        S</span><br></span></code></pre></div></div><p>Y la variable <code>y</code> ser√≠a una Serie con la variable objetivo correspondiente a cada fila de X.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: Survived, dtype: int64</span><br></span></code></pre></div></div><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-22-divisi√≥n-del-dataset">Paso 2.2. Divisi√≥n del dataset<a href="#paso-22-divisi√≥n-del-dataset" class="hash-link" aria-label="Enlace directo al Paso 2.2. Divisi√≥n del dataset" title="Enlace directo al Paso 2.2. Divisi√≥n del dataset">‚Äã</a></h3><p>La funci√≥n <code>train_test_split</code> de scikit-learn permite dividir el dataset de forma aleatoria en:</p><ul>
<li><strong>train</strong> ‚Üí usado para entrenar (ajustar) el modelo.</li>
<li><strong>test</strong> ‚Üí usado para evaluar el rendimiento final del modelo.</li>
</ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train_test_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># el 20% para test, 80% para train</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># fija la aleatoriedad para reproducir resultados</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stratify</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">y           </span><span class="token comment" style="color:#999988;font-style:italic"># mantiene la proporci√≥n de clases en train y test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n de los par√°metros:</strong></p><ul>
<li>
<p><strong><code>test_size=0.2</code></strong>
Usamos un 20% para test. Es est√°ndar para muchos problemas y datasets medianos.</p>
</li>
<li>
<p><strong><code>random_state=42</code></strong>
Asegura que todos obtengamos exactamente la misma divisi√≥n.
Si no lo pones, cada ejecuci√≥n divide el dataset de forma distinta.</p>
</li>
<li>
<p><strong><code>stratify=y</code></strong>
Muy importante cuando el target tiene clases desbalanceadas (por ejemplo, supervivencia en Titanic).
Genera train y test con la <strong>misma proporci√≥n de clases</strong> que el dataset original.
Ejemplo: si el Titanic tiene un 38% de supervivientes y un 62% de fallecidos, ambos conjuntos mantendr√°n esa proporci√≥n.</p>
</li>
</ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="paso-3-operaciones-despu√©s-de-la-divisi√≥n">Paso 3. Operaciones despu√©s de la divisi√≥n<a href="#paso-3-operaciones-despu√©s-de-la-divisi√≥n" class="hash-link" aria-label="Enlace directo al Paso 3. Operaciones despu√©s de la divisi√≥n" title="Enlace directo al Paso 3. Operaciones despu√©s de la divisi√≥n">‚Äã</a></h2><p>Una vez que ya tenemos nuestros conjuntos <strong>X_train, X_test, y_train y y_test</strong>, comienza la fase m√°s importante del preprocesamiento:   todas las transformaciones que <strong>aprenden par√°metros</strong> deben realizarse <strong>ajust√°ndose √∫nicamente al train</strong>, y luego aplicarse al test.</p><p>El objetivo principal en esta fase es:</p><blockquote>
<p><strong>Aprender par√°metros con train ‚Üí aplicar esos mismos par√°metros a test.</strong></p>
</blockquote><p>Esto evita el <strong>data leakage</strong> y garantiza que el modelo se eval√∫a de forma justa.</p><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Nota clave: lo que ocurre a partir de aqu√≠</div><div class="admonitionContent_BuS1"><p>Una vez dividido el dataset, <strong>todas las transformaciones que aprendan informaci√≥n del conjunto</strong> (imputaci√≥n, codificaci√≥n, escalado‚Ä¶) deben seguir esta estructura:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># EJEMPLO DE FLUJO CORRECTO (imputaci√≥n como ejemplo)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imputer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SimpleImputer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strategy</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;median&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imputer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># aprende la mediana solo con train</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imputer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># aplica lo aprendido al test</span><br></span></code></pre></div></div><p>üí° <strong>Por qu√© es tan importante:</strong></p><ul>
<li><code>fit</code> (entrenar) ‚Üí solo en <strong>train</strong></li>
<li><code>transform</code> (aplicar) ‚Üí en <strong>train</strong> y <strong>test</strong></li>
</ul><p>‚ö†Ô∏è Nunca debe llamarse <code>fit</code> con los datos de <strong>test</strong>.</p><p><strong>Ejemplo visual para entenderlo</strong></p><p>Imagina que tenemos esta columna de edades antes de dividir:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[20, 30, 40, 80]</span><br></span></code></pre></div></div><p>Despu√©s del <em>train/test split</em>, queda as√≠:</p><p>Train (lo que el modelo puede ver al aprender):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[20, 30, 40]</span><br></span></code></pre></div></div><p>Test (datos nuevos que simulan el futuro):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[80]</span><br></span></code></pre></div></div><p>Si hacemos:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imputer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>El imputador <strong>aprende la mediana de train</strong>, que es:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mediana(train) = 30</span><br></span></code></pre></div></div><p>Y despu√©s aplicamos:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imputer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>‚Üí El imputador usa <strong>solo la mediana aprendida (30)</strong>, sin mirar el valor 80 del futuro.</p><p><strong>¬øQu√© pasar√≠a si hici√©ramos <code>fit</code> tambi√©n con test?</strong></p><p>Estar√≠amos calculando la mediana as√≠:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mediana([20, 30, 40, 80]) = 35</span><br></span></code></pre></div></div><p>Es decir, el imputador est√° usando informaci√≥n del test para aprender. Esto es <strong>data leakage</strong> (filtraci√≥n de datos). El modelo estar√≠a ‚Äúviendo el futuro‚Äù y la evaluaci√≥n ya no ser√≠a realista.</p></div></div><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-31-tratamiento-de-valores-nulos-post-split">Paso 3.1 Tratamiento de valores nulos (post-split)<a href="#paso-31-tratamiento-de-valores-nulos-post-split" class="hash-link" aria-label="Enlace directo al Paso 3.1 Tratamiento de valores nulos (post-split)" title="Enlace directo al Paso 3.1 Tratamiento de valores nulos (post-split)">‚Äã</a></h3><p>Ya vimos en EDA que pod√≠amos ver los nulos con la instrucci√≥n:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isnull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Las estrategias de tratamiento m√°s comunes son:</p><ul>
<li><strong>Eliminar filas o columnas</strong> con demasiados nulos (poco habitual aqu√≠, porque ya hicimos la limpieza estructural antes del split).</li>
<li><strong>Imputar valores faltantes</strong> usando:<!-- -->
<ul>
<li>Media</li>
<li>Mediana (m√°s robusta)</li>
<li>Moda (para categ√≥ricas)</li>
</ul>
</li>
</ul><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="imputaci√≥n-para-variables-num√©ricas">Imputaci√≥n para variables num√©ricas<a href="#imputaci√≥n-para-variables-num√©ricas" class="hash-link" aria-label="Enlace directo al Imputaci√≥n para variables num√©ricas" title="Enlace directo al Imputaci√≥n para variables num√©ricas">‚Äã</a></h4><p>En Titanic, la columna <code>Age</code> tiene valores nulos, as√≠ que usaremos <code>SimpleImputer</code> con la <strong>mediana</strong>, que suele funcionar mejor que la media en datos sesgados.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">impute </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SimpleImputer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Imputador para columnas num√©ricas con estrategia de mediana</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imputer_num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SimpleImputer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strategy</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;median&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ajustamos (fit) SOLO con train</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imputer_num</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transformamos test con lo aprendido</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imputer_num</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>üí° <strong>Explicaci√≥n:</strong></p><ul>
<li><code>fit_transform()</code> aprende la mediana de Age en train ‚Üí la aplica al propio train.</li>
<li><code>transform()</code> aplica esa misma mediana al test, sin recalcular nada.</li>
</ul><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>¬øMedia o mediana? Decisi√≥n seg√∫n la distribuci√≥n</div><div class="admonitionContent_BuS1"><p>Para decidir si debemos imputar con <strong>media</strong> o <strong>mediana</strong>, es importante observar <strong>la forma de la distribuci√≥n</strong>. En el caso de la edad en el Titanic, vemos que <strong>no tiene forma de campana sim√©trica</strong> (no es una distribuci√≥n normal).<br>
<!-- -->Hay muchos valores concentrados entre 15 y 35 a√±os, y luego la cola se alarga hacia la derecha.</p><p>Esto significa que la variable est√° <strong>sesgada</strong> (asim√©trica), y por tanto <strong>la media estar√≠a demasiado influida por los valores altos</strong>. En cambio, la <strong>mediana</strong> es m√°s robusta y representa mejor el valor central real.</p><p>Por eso, en este caso, <strong>la estrategia recomendada es usar la mediana</strong> para imputar los valores nulos de <code>Age</code>.</p><p><img decoding="async" loading="lazy" alt="Gr√°fico EDA" src="/DevTacora/assets/images/histograma-edad-81e806966568c145f13432fee8be42b3.png" width="571" height="455" class="img_ev3q"></p></div></div><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="imputaci√≥n-para-variables-categ√≥ricas">Imputaci√≥n para variables categ√≥ricas<a href="#imputaci√≥n-para-variables-categ√≥ricas" class="hash-link" aria-label="Enlace directo al Imputaci√≥n para variables categ√≥ricas" title="Enlace directo al Imputaci√≥n para variables categ√≥ricas">‚Äã</a></h4><p>Ejemplo con <code>Embarked</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Imputador para columnas categ√≥ricas, qued√°ndose con la categor√≠a m√°s frecuente</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">imputer_cat </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SimpleImputer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strategy</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;most_frequent&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imputer_cat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ravel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> imputer_cat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ravel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Esto rellena los valores nulos con la <strong>categor√≠a m√°s frecuente</strong> de los pasajeros en <em>train</em>.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-32-codificaci√≥n-de-variables-categ√≥ricas">Paso 3.2 Codificaci√≥n de variables categ√≥ricas<a href="#paso-32-codificaci√≥n-de-variables-categ√≥ricas" class="hash-link" aria-label="Enlace directo al Paso 3.2 Codificaci√≥n de variables categ√≥ricas" title="Enlace directo al Paso 3.2 Codificaci√≥n de variables categ√≥ricas">‚Äã</a></h3><p>Los modelos de Machine Learning <strong>no pueden trabajar directamente con texto</strong>, por lo que todas las variables categ√≥ricas deben convertirse a valores num√©ricos.</p><p>Para ello existen dos t√©cnicas principales: <strong>Label Encoding</strong> y <strong>One-Hot Encoding</strong>. Cada una se usa en situaciones distintas y genera tipos de columnas diferentes.</p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="c√≥mo-elegir-entre-label-y-one-hot">¬øC√≥mo elegir entre Label y One-Hot?<a href="#c√≥mo-elegir-entre-label-y-one-hot" class="hash-link" aria-label="Enlace directo al ¬øC√≥mo elegir entre Label y One-Hot?" title="Enlace directo al ¬øC√≥mo elegir entre Label y One-Hot?">‚Äã</a></h4><table><thead><tr><th>Tipo de variable</th><th>Ejemplo</th><th>Codificaci√≥n recomendada</th></tr></thead><tbody><tr><td><strong>Ordinal</strong> (tiene orden)</td><td>Clase del Titanic</td><td>Label Encoding</td></tr><tr><td><strong>Nominal</strong> (sin orden)</td><td>Sexo, puerto</td><td>One-Hot Encoding</td></tr><tr><td><strong>Much√≠simas categor√≠as</strong></td><td>C√≥digos √∫nicos, IDs</td><td>Ninguna (mejor eliminar o agrupar)</td></tr></tbody></table><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="label-encoding-para-variables-ordinales">Label Encoding (para variables <em>ordinales</em>)<a href="#label-encoding-para-variables-ordinales" class="hash-link" aria-label="Enlace directo al label-encoding-para-variables-ordinales" title="Enlace directo al label-encoding-para-variables-ordinales">‚Äã</a></h4><p>Vamos a suponer que en el Titanic la columna <strong>Pclass</strong> no viniera como n√∫meros <code>1, 2, 3</code>, sino como texto:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;1st&quot;, &quot;2nd&quot;, &quot;3rd&quot;</span><br></span></code></pre></div></div><p>Es una variable <strong>categ√≥rica ordinal</strong> (hay un orden claro: 1st &lt; 2nd &lt; 3rd), as√≠ que aqu√≠ <strong>s√≠ tiene sentido</strong> usar <strong>Label Encoding</strong>.</p><p>La idea es la misma que con los nulos:</p><p>üëâ <strong>Ajustamos (fit) solo con <code>X_train</code></strong> y despu√©s <strong>aplicamos (transform) a <code>X_train</code> y <code>X_test</code></strong>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preprocessing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> LabelEncoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encoder_pclass </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LabelEncoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ajustamos el encoder SOLO con los datos de train</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encoder_pclass</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transformamos train y test con el mismo mapeo aprendido</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass_encoded&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> encoder_pclass</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass_encoded&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> encoder_pclass</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Si las clases fueran, por ejemplo:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&quot;1st&quot;, &quot;2nd&quot;, &quot;3rd&quot;]</span><br></span></code></pre></div></div><p>el encoder podr√≠a aprender algo como:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;1st&quot; -&gt; 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;2nd&quot; -&gt; 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;3rd&quot; -&gt; 2</span><br></span></code></pre></div></div><p>Y las nuevas columnas quedar√≠an as√≠:</p><table><thead><tr><th>Pclass</th><th>Pclass_encoded</th></tr></thead><tbody><tr><td>1st</td><td>0</td></tr><tr><td>3rd</td><td>2</td></tr><tr><td>2nd</td><td>1</td></tr></tbody></table><p>üí° <strong>Importante:</strong></p><ul>
<li><code>fit</code> aprende qu√© categor√≠as existen y en qu√© orden las codifica ‚Üí <strong>solo en X_train</strong>.</li>
<li><code>transform</code> aplica ese mismo mapeo a <strong>X_train y X_test</strong>.</li>
<li>Genera <strong>una √∫nica columna num√©rica</strong>, que conserva el orden natural de la variable (<code>1st &lt; 2nd &lt; 3rd</code>).</li>
</ul><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="one-hot-encoding-para-variables-nominales">One-Hot Encoding (para variables <em>nominales</em>)<a href="#one-hot-encoding-para-variables-nominales" class="hash-link" aria-label="Enlace directo al one-hot-encoding-para-variables-nominales" title="Enlace directo al one-hot-encoding-para-variables-nominales">‚Äã</a></h4><p>En el Titanic, columnas como <strong>Sex</strong> o <strong>Embarked</strong> contienen categor√≠as que <strong>no tienen un orden</strong>:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Sex:       &quot;male&quot;, &quot;female&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Embarked:  &quot;S&quot;, &quot;C&quot;, &quot;Q&quot;</span><br></span></code></pre></div></div><p>Cuando las categor√≠as <strong>no tienen jerarqu√≠a</strong>, no podemos asignarles n√∫meros como 0, 1, 2 porque el modelo podr√≠a interpretar err√≥neamente que uno ‚Äúvale m√°s‚Äù que otro.</p><p>üëâ En estos casos, la t√©cnica correcta es <strong>One-Hot Encoding</strong>.</p><p>Esta t√©cnica crea <strong>una columna por cada categor√≠a</strong>, con valores 0/1 indicando si esa fila pertenece a esa categor√≠a.</p><p>La idea es la misma que antes:</p><ul>
<li>Ajustamos (fit) el codificador solo con <code>X_train</code></li>
<li>Transformamos tanto <code>X_train</code> como <code>X_test</code> con lo aprendido</li>
</ul><p><strong>Ejemplo con la columna <code>Embarked</code> del Titanic</strong></p><p>Vamos a transformar esta variable nominal en columnas num√©ricas:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preprocessing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> OneHotEncoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Empezamos por Embarked</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encoder_embarked </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> OneHotEncoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handle_unknown</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sparse_output</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ajustamos SOLO con los datos de train</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encoder_embarked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Transformamos train y test usando lo aprendido</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># embarked_train y embarked_test son arrays numpy, hay que procesarlos m√°s tarde para obtener un DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">embarked_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> encoder_embarked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">embarked_test  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> encoder_embarked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Convertimos las matrices a DataFrames para verlas mejor y a√±adirlas posteriormente a nuestro DataFrame completo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">embarked_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">embarked_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">encoder_embarked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_feature_names_out</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              index</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">embarked_test  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">embarked_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">encoder_embarked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_feature_names_out</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              index</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Vamos a entender c√≥mo funciona el c√≥digo anterior. Supongamos que tenemos este DataFrame:</p><table><thead><tr><th>Embarked</th></tr></thead><tbody><tr><td>S</td></tr><tr><td>C</td></tr><tr><td>Q</td></tr><tr><td>S</td></tr><tr><td>C</td></tr></tbody></table><p>Si aplicamos <strong>One-Hot Encoding</strong>, obtendremos tres nuevas columnas (una por cada categor√≠a):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Embarked_C   Embarked_Q   Embarked_S</span><br></span></code></pre></div></div><p>La transformaci√≥n completa quedar√≠a as√≠:</p><table><thead><tr><th>Embarked</th><th>Embarked_C</th><th>Embarked_Q</th><th>Embarked_S</th></tr></thead><tbody><tr><td>S</td><td>0</td><td>0</td><td>1</td></tr><tr><td>C</td><td>1</td><td>0</td><td>0</td></tr><tr><td>Q</td><td>0</td><td>1</td><td>0</td></tr><tr><td>S</td><td>0</td><td>0</td><td>1</td></tr><tr><td>C</td><td>1</td><td>0</td><td>0</td></tr></tbody></table><p>üí° <strong>Interpretaci√≥n r√°pida:</strong></p><ul>
<li>Cada categor√≠a se convierte en una columna.</li>
<li>El valor 1 indica la categor√≠a correspondiente de esa fila.</li>
<li>Solo una columna vale 1 porque cada pasajero solo puede embarcar por un puerto.</li>
</ul><hr><p>Tras aplicar One-Hot Encoding, en el √∫ltimo paso:</p><ol>
<li>Se <strong>eliminan las columnas originales</strong> (<code>Embarked</code>, <code>Sex</code>, etc.)</li>
<li>Se <strong>a√±aden las columnas generadas</strong> al DataFrame</li>
</ol><p>Ejemplo:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Eliminamos columnas categ√≥ricas originales, sustituy√©ndolas por las nuevas generadas</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> embarked_train</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Embarked&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> embarked_test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-33-feature-engineering-b√°sico">Paso 3.3. Feature Engineering b√°sico<a href="#paso-33-feature-engineering-b√°sico" class="hash-link" aria-label="Enlace directo al Paso 3.3. Feature Engineering b√°sico" title="Enlace directo al Paso 3.3. Feature Engineering b√°sico">‚Äã</a></h3><p>El <strong>Feature Engineering</strong> consiste en crear nuevas variables (features) que puedan aportar informaci√≥n adicional al modelo.<br>
<!-- -->En esta fase del curso solo veremos <strong>transformaciones sencillas y muy intuitivas</strong>, sin t√©cnicas avanzadas.</p><p>El objetivo es mejorar la capacidad predictiva del modelo utilizando informaci√≥n que ya existe en el dataset, pero combinada de forma m√°s √∫til.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creaci√≥n-de-variables-intuitivas">Creaci√≥n de variables intuitivas<a href="#creaci√≥n-de-variables-intuitivas" class="hash-link" aria-label="Enlace directo al Creaci√≥n de variables intuitivas" title="Enlace directo al Creaci√≥n de variables intuitivas">‚Äã</a></h4><p>A veces, combinar varias columnas puede generar una nueva variable con m√°s significado que las originales por separado.</p><p>En el Titanic, las columnas:</p><ul>
<li><code>SibSp</code> ‚Üí n√∫mero de hermanos/esposos a bordo</li>
<li><code>Parch</code> ‚Üí n√∫mero de padres/hijos a bordo</li>
</ul><p>por separado aportan informaci√≥n, pero <strong>juntas pueden representar mejor el tama√±o del grupo familiar</strong>.</p><p>Creamos una nueva columna:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Crear tama√±o familiar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;FamilySize&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;FamilySize&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre></div></div><p>¬øPor qu√© sumamos 1?</p><p>üëâ Para incluir al propio pasajero en el tama√±o total de la familia.</p><p>Ejemplo:</p><table><thead><tr><th>SibSp</th><th>Parch</th><th>FamilySize</th></tr></thead><tbody><tr><td>1</td><td>0</td><td>2</td></tr><tr><td>0</td><td>0</td><td>1</td></tr><tr><td>3</td><td>1</td><td>5</td></tr></tbody></table><p>üí° <strong>Interpretaci√≥n:</strong>
Los grupos m√°s grandes ten√≠an, en general, menor probabilidad de sobrevivir, por lo que esta variable puede ayudar al modelo.</p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="eliminaci√≥n-de-variables-redundantes">Eliminaci√≥n de variables redundantes<a href="#eliminaci√≥n-de-variables-redundantes" class="hash-link" aria-label="Enlace directo al Eliminaci√≥n de variables redundantes" title="Enlace directo al Eliminaci√≥n de variables redundantes">‚Äã</a></h4><p>Una vez que hemos creado una nueva variable derivada de otras dos, es posible que las variables originales <strong>ya no sean necesarias</strong> o aporten informaci√≥n duplicada.</p><p>En este nivel b√°sico, la regla que seguiremos ser√°:</p><p>üëâ <strong>Si la nueva variable resume bien la informaci√≥n, podemos eliminar las columnas que la generaron.</strong></p><p>Por ejemplo, tras crear <code>FamilySize</code>, podr√≠amos eliminar <code>SibSp</code> y <code>Parch</code> para evitar redundancia:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Esto hace el dataset m√°s compacto y claro para el modelo.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-34-escalado-y-normalizaci√≥n-de-variables-num√©ricas">Paso 3.4. Escalado y normalizaci√≥n de variables num√©ricas<a href="#paso-34-escalado-y-normalizaci√≥n-de-variables-num√©ricas" class="hash-link" aria-label="Enlace directo al Paso 3.4. Escalado y normalizaci√≥n de variables num√©ricas" title="Enlace directo al Paso 3.4. Escalado y normalizaci√≥n de variables num√©ricas">‚Äã</a></h3><p>Tras imputar valores nulos y codificar las variables categ√≥ricas, el siguiente paso es <strong>escalar o normalizar las variables num√©ricas</strong>.<br>
<!-- -->Este proceso es fundamental en muchos modelos de Machine Learning, especialmente aquellos que son sensibles a la magnitud de los valores (por ejemplo, KNN, regresi√≥n log√≠stica, redes neuronales, SVM‚Ä¶).</p><p>En un dataset como el Titanic, algunas columnas num√©ricas tienen escalas muy distintas:</p><table><thead><tr><th>Variable</th><th>Rango aproximado</th></tr></thead><tbody><tr><td><code>Age</code></td><td>0 ‚Äì 80</td></tr><tr><td><code>Fare</code></td><td>0 ‚Äì 512</td></tr><tr><td><code>SibSp</code></td><td>0 ‚Äì 8</td></tr></tbody></table><p>Si no escalamos estas variables:</p><ul>
<li>Los modelos podr√≠an <strong>dar m√°s importancia</strong> a las columnas con valores m√°s grandes (<code>Fare</code>).</li>
<li>La distancia entre puntos en modelos basados en distancia (como KNN o clustering) estar√≠a <strong>sesgada</strong>.</li>
<li>El entrenamiento podr√≠a tardar m√°s y converger peor.</li>
</ul><p>‚û°Ô∏è <strong>Escalar no cambia la forma de los datos</strong>, pero s√≠ su rango, para que todas las variables ‚Äújueguen en igualdad de condiciones‚Äù.</p><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Nota avanzada (Paso previo sobre los outliers)</div><div class="admonitionContent_BuS1"><p>En algunas variables <strong>muy sesgadas</strong>, como <code>Fare</code> en el Titanic, los valores altos son mucho mayores que los valores t√≠picos.<br>
<!-- -->Esto produce una distribuci√≥n con <strong>cola larga</strong>, que puede afectar a ciertos modelos o a algunos m√©todos de escalado (por ejemplo, MinMaxScaler).</p><p><img decoding="async" loading="lazy" alt="Gr√°fico EDA" src="/DevTacora/assets/images/boxplot-fare-ca9672fa663c0764e001425dacc088aa.png" width="520" height="455" class="img_ev3q"></p><p>En an√°lisis m√°s avanzados existe la posibilidad de aplicar <strong>transformaciones matem√°ticas</strong> como:</p><ul>
<li><code>log()</code> ‚Üí reduce el impacto de los valores muy grandes</li>
<li><code>sqrt()</code> ‚Üí suaviza moderadamente la distribuci√≥n</li>
<li>Transformaciones m√°s complejas como <strong>Box-Cox</strong> o <strong>Yeo-Johnson</strong></li>
</ul><p>Estas transformaciones no eliminan outliers reales, sino que simplemente <strong>reducen su influencia</strong> para modelos muy sensibles a distribuciones sesgadas.</p><p>Sin embargo, estas t√©cnicas pertenecen a un nivel m√°s avanzado de <em>Feature Engineering</em>.<br>
<!-- -->En este curso inicial <strong>no son necesarias</strong> y no las aplicaremos, ya que los modelos que veremos funcionan correctamente sin esta complejidad adicional.</p></div></div><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="m√©todos-m√°s-utilizados">M√©todos m√°s utilizados<a href="#m√©todos-m√°s-utilizados" class="hash-link" aria-label="Enlace directo al M√©todos m√°s utilizados" title="Enlace directo al M√©todos m√°s utilizados">‚Äã</a></h4><p>Aqu√≠ veremos los dos escaladores que se usan en la mayor√≠a de proyectos:</p><ul>
<li><strong>StandardScaler</strong> ‚Üí distribuye con media = 0 y desviaci√≥n est√°ndar = 1</li>
<li><strong>MinMaxScaler</strong> ‚Üí lleva todos los valores al rango [0, 1]</li>
</ul><p>Ambos se utilizan <strong>despu√©s</strong> del <em>train/test split</em>, tras las imputaciones necesarias y antes de entrenar el modelo.</p><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="standardscaler-escalado-est√°ndar">StandardScaler (escalado est√°ndar)<a href="#standardscaler-escalado-est√°ndar" class="hash-link" aria-label="Enlace directo al StandardScaler (escalado est√°ndar)" title="Enlace directo al StandardScaler (escalado est√°ndar)">‚Äã</a></h4><p>El <code>StandardScaler</code> transforma cada variable num√©rica para que tenga:</p><ul>
<li><strong>Media = 0</strong></li>
<li><strong>Desviaci√≥n est√°ndar = 1</strong></li>
</ul><p>Matem√°ticamente:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">valor_escalado = (valor - media) / desviaci√≥n_est√°ndar</span><br></span></code></pre></div></div><p><strong>¬øCu√°ndo usar StandardScaler?</strong></p><p>‚úî <strong>Para casi todos los modelos cl√°sicos de Machine Learning.</strong></p><p>Porque:</p><ul>
<li>Centra los datos (media=0), lo cual ayuda al entrenamiento.</li>
<li>No obliga a tener datos en un rango fijo.</li>
<li>Funciona bien incluso si las variables no est√°n ‚Äúperfectamente distribuidas‚Äù.</li>
</ul><p><strong>Ejemplo con Titanic</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preprocessing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> StandardScaler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ¬°IMPORTANTE! Seleccionamos solo las columnas num√©ricas que queremos escalar (por ahora seleccionaremos todas)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Creamos el escalador</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scaler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> StandardScaler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ajustamos el escalador SOLO con los datos de train (fit)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scaler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Aplicamos la transformaci√≥n a test (transform)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scaler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Tras esto, cada columna quedar√° escalada, por ejemplo:</p><table><thead><tr><th>Variable</th><th>Antes</th><th>Despu√©s</th></tr></thead><tbody><tr><td>Age</td><td>22</td><td>-0.73</td></tr><tr><td>Age</td><td>38</td><td>1.22</td></tr><tr><td>Fare</td><td>512</td><td>4.11</td></tr><tr><td>Parch</td><td>0</td><td>-0.45</td></tr></tbody></table><p>üí° <strong>Interpretaci√≥n:</strong></p><ul>
<li>Valores negativos ‚Üí menores que la media</li>
<li>Valores positivos ‚Üí mayores que la media</li>
</ul><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="minmaxscaler-normalizaci√≥n-01">MinMaxScaler (normalizaci√≥n 0‚Äì1)<a href="#minmaxscaler-normalizaci√≥n-01" class="hash-link" aria-label="Enlace directo al MinMaxScaler (normalizaci√≥n 0‚Äì1)" title="Enlace directo al MinMaxScaler (normalizaci√≥n 0‚Äì1)">‚Äã</a></h4><p>El <code>MinMaxScaler</code> transforma cada variable num√©rica para que todos sus valores queden dentro del rango:</p><ul>
<li><strong>M√≠nimo = 0</strong></li>
<li><strong>M√°ximo = 1</strong></li>
</ul><p>Matem√°ticamente:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">valor_escalado = (valor - min) / (max - min)</span><br></span></code></pre></div></div><p>Es decir, cada valor se reescala proporcionalmente seg√∫n el valor m√≠nimo y m√°ximo de la columna.</p><hr><p><strong>¬øCu√°ndo usar MinMaxScaler?</strong></p><p>‚úî <strong>Cuando queremos que todos los valores queden entre 0 y 1.</strong><br>
<!-- -->‚úî √ötil en modelos que funcionan mejor con entradas normalizadas en un rango fijo, como:</p><ul>
<li>Redes neuronales</li>
<li>Modelos que trabajan con activaciones entre 0 y 1</li>
</ul><p>‚ùå <strong>No es ideal si hay valores extremos muy altos (outliers reales).</strong> En esos casos, un √∫nico valor muy grande puede hacer que casi todos los dem√°s queden muy cerca de 0 tras escalar.</p><p><strong>Ejemplo con Titanic</strong></p><p>Vamos a escalar las mismas columnas num√©ricas que antes:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preprocessing </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MinMaxScaler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Seleccionamos las columnas num√©ricas que queremos escalar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Pclass&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Age&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Fare&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SibSp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Parch&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Creamos el escalador</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scaler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MinMaxScaler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ajustamos el escalador SOLO con los datos de train (fit)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scaler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Aplicamos la transformaci√≥n a test (transform)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scaler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">num_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Tras esto, cada columna quedar√° normalizada al rango 0‚Äì1. Por ejemplo:</p><table><thead><tr><th>Variable</th><th>Antes</th><th>Despu√©s</th></tr></thead><tbody><tr><td>Age</td><td>22</td><td>0.28</td></tr><tr><td>Age</td><td>38</td><td>0.54</td></tr><tr><td>Fare</td><td>512</td><td>1.00</td></tr><tr><td>Parch</td><td>0</td><td>0.00</td></tr></tbody></table><p>üí° <strong>Interpretaci√≥n:</strong></p><ul>
<li><strong>0</strong> representa el valor m√≠nimo visto en <em>train</em>.</li>
<li><strong>1</strong> representa el valor m√°ximo visto en <em>train</em>.</li>
<li>El resto de valores quedan en posiciones proporcionales dentro del intervalo 0‚Äì1.</li>
</ul><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Nota sobre MinMaxScaler</div><div class="admonitionContent_BuS1"><p>Aunque MinMaxScaler funciona bien en muchos casos, recuerda que si existe un valor extremadamente alto (como una tarifa de 500), el resto de valores quedar√°n muy cerca de 0.
Por eso, aunque es √∫til, suele utilizarse menos que StandardScaler en problemas cl√°sicos.</p></div></div><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="resumen-standardscaler-vs-minmaxscaler">Resumen StandardScaler vs MinMaxScaler<a href="#resumen-standardscaler-vs-minmaxscaler" class="hash-link" aria-label="Enlace directo al Resumen StandardScaler vs MinMaxScaler" title="Enlace directo al Resumen StandardScaler vs MinMaxScaler">‚Äã</a></h4><table><thead><tr><th>Caracter√≠stica</th><th>StandardScaler</th><th>MinMaxScaler</th></tr></thead><tbody><tr><td>Rango</td><td>No fijo (puede ser negativo)</td><td>Entre 0 y 1</td></tr><tr><td>Usa</td><td>Media y desviaci√≥n</td><td>M√≠nimo y m√°ximo</td></tr><tr><td>Afectado por outliers</td><td>S√≠ (mucho)</td><td>S√≠ (much√≠simo)</td></tr><tr><td>Mejor para</td><td>Modelos lineales, KNN, SVM</td><td>Redes neuronales, datos entre 0-1</td></tr></tbody></table><hr><h4 class="anchor anchorWithStickyNavbar_LWe7" id="debo-escalar-todas-las-columnas-num√©ricas">¬øDebo escalar todas las columnas num√©ricas?<a href="#debo-escalar-todas-las-columnas-num√©ricas" class="hash-link" aria-label="Enlace directo al ¬øDebo escalar todas las columnas num√©ricas?" title="Enlace directo al ¬øDebo escalar todas las columnas num√©ricas?">‚Äã</a></h4><p>‚úî <strong>S√≠</strong>, si usas modelos basados en distancias (KNN, SVM).<br>
<!-- -->‚úî <strong>S√≠</strong>, si usas regresi√≥n log√≠stica o redes neuronales.<br>
<!-- -->‚ùå <strong>No es necesario</strong> para √°rboles de decisi√≥n o Random Forest (no les afecta).</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="paso-4-preparaci√≥n-final-del-dataset">Paso 4. Preparaci√≥n final del dataset<a href="#paso-4-preparaci√≥n-final-del-dataset" class="hash-link" aria-label="Enlace directo al Paso 4. Preparaci√≥n final del dataset" title="Enlace directo al Paso 4. Preparaci√≥n final del dataset">‚Äã</a></h2><p>Despu√©s de haber realizado todas las tareas de preprocesamiento ‚Äîlimpieza estructural, divisi√≥n en <em>train/test</em>, imputaci √≥n, codificaci√≥n, escalado y feature engineering‚Äî ya tenemos nuestros datos pr√°cticamente listos para entrenar modelos de Machine Learning.</p><p>Antes de continuar, es recomendable hacer una <strong>√∫ltima revisi√≥n r√°pida</strong> para comprobar que todo ha quedado correctamente transformado.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-41-revisi√≥n-r√°pida-de-coherencia">Paso 4.1 Revisi√≥n r√°pida de coherencia<a href="#paso-41-revisi√≥n-r√°pida-de-coherencia" class="hash-link" aria-label="Enlace directo al Paso 4.1 Revisi√≥n r√°pida de coherencia" title="Enlace directo al Paso 4.1 Revisi√≥n r√°pida de coherencia">‚Äã</a></h3><p>En este punto debemos asegurarnos de que:</p><p>‚úî <strong>No quedan valores nulos</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isnull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isnull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Si alguna columna sigue teniendo nulos, puede deberse a:</p><ul>
<li>una codificaci√≥n incompleta,</li>
<li>un problema en la imputaci√≥n,</li>
<li>o columnas que no se incluyeron en el proceso.</li>
</ul><p>‚úî <strong>Todas las columnas son num√©ricas</strong></p><p>Los modelos cl√°sicos de Machine Learning <strong>solo aceptan variables num√©ricas</strong>. Debemos asegurarnos de que ya no quedan columnas categ√≥ricas sin transformar:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dtypes</span><br></span></code></pre></div></div><p>En este punto todo deber√≠a ser <code>int</code>, <code>float</code> o <code>uint8</code> (en caso de One-Hot Encoding).</p><p>‚úî <strong>Las columnas de train y test coinciden</strong></p><p>Esto es MUY importante. Si el n√∫mero o nombre de columnas no coincide entre <code>X_train</code> y <code>X_test</code>, el modelo no podr√° predecir correctamente.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><p>Si no coinciden, normalmente significa que:</p><ul>
<li>falt√≥ eliminar alguna columna original antes de concatenar,</li>
<li>hubo categor√≠as presentes en train que no aparecieron en test,</li>
<li>o se mezclaron escaladores o imputadores incorrectamente.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-42-dataset-final-listo-para-el-modelado">Paso 4.2 Dataset final listo para el modelado<a href="#paso-42-dataset-final-listo-para-el-modelado" class="hash-link" aria-label="Enlace directo al Paso 4.2 Dataset final listo para el modelado" title="Enlace directo al Paso 4.2 Dataset final listo para el modelado">‚Äã</a></h3><p>Cuando se cumple todo los descrito en el paso anterior, <strong>nuestro dataset est√° preparado para entrenar un modelo.</strong></p><p>A partir de aqu√≠, podemos comenzar con:</p><ul>
<li>Regresi√≥n log√≠stica</li>
<li>√Årboles</li>
<li>Random Forest</li>
<li>KNN</li>
<li>SVM</li>
<li>etc.</li>
</ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="paso-43-guardar-los-datasets-transformados-opcional-pero-recomendable">Paso 4.3 Guardar los datasets transformados (opcional, pero recomendable)<a href="#paso-43-guardar-los-datasets-transformados-opcional-pero-recomendable" class="hash-link" aria-label="Enlace directo al Paso 4.3 Guardar los datasets transformados (opcional, pero recomendable)" title="Enlace directo al Paso 4.3 Guardar los datasets transformados (opcional, pero recomendable)">‚Äã</a></h3><p>Es muy habitual guardar las versiones preprocesadas de los datos, especialmente si queremos:</p><ul>
<li>reutilizarlos,</li>
<li>compartirlos,</li>
<li>hacer pruebas con diferentes modelos,</li>
<li>o evitar repetir todo el proceso de preprocesamiento.</li>
</ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">X_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;titanic_X_train_preprocessed.csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;titanic_X_test_preprocessed.csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;titanic_y_train.csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;titanic_y_test.csv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ejercicio-de-titanic">Ejercicio de Titanic<a href="#ejercicio-de-titanic" class="hash-link" aria-label="Enlace directo al Ejercicio de Titanic" title="Enlace directo al Ejercicio de Titanic">‚Äã</a></h2><p>Realiza el preprocesamiento del dataset <strong>Titanic</strong>, pero esta vez con un fichero ‚Äúensuciado‚Äù a prop√≥sito para poder aplicar la mayor√≠a de las t√©cnicas vistas.</p><p>Puedes partir del cuaderno que ya tienes de EDA (cuidado, tendr√°s que volver a ejecutarlo con el nuevo dataset):</p><p>üëâ <a href="/DevTacora/assets/files/EDA_Titanic-d3829ade827a195700af8fce3aef1407.ipynb" target="_blank">Cuaderno de EDA ‚Äî Titanic</a></p><p>üìÇ Dataset para este ejercicio: <a href="/DevTacora/assets/files/titanic_sucio-488a5c3690f6101661c0c9c3d3266cec.csv" target="_blank"><code>titanic_sucio.csv</code></a></p><p>Como opci√≥n adicional, puedes entrenar un modelo sencillo (por ejemplo, <strong>KNN</strong>) con el dataset ya preprocesado para comprobar que todo el flujo funciona correctamente y que los resultados mejoran con respecto al preprocesamiento sencillo que hac√≠amos al inicio del tema.</p></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="P√°gina del documento"><a class="pagination-nav__link pagination-nav__link--prev" href="/DevTacora/docs/pia_2526/ut3_ml/eda"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">Exploratory Data Analysis (EDA)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/DevTacora/docs/category/aprendizaje-supervisado"><div class="pagination-nav__sublabel">Siguiente</div><div class="pagination-nav__label">Aprendizaje supervisado</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introducci√≥n" class="table-of-contents__link toc-highlight">Introducci√≥n</a><ul><li><a href="#por-qu√©-es-esencial-tras-el-eda" class="table-of-contents__link toc-highlight">¬øPor qu√© es esencial tras el EDA?</a></li><li><a href="#objetivos-del-preprocesamiento" class="table-of-contents__link toc-highlight">Objetivos del preprocesamiento</a></li><li><a href="#herramientas-que-usaremos" class="table-of-contents__link toc-highlight">Herramientas que usaremos</a></li></ul></li><li><a href="#paso-1-operaciones-antes-de-la-divisi√≥n" class="table-of-contents__link toc-highlight">Paso 1. Operaciones antes de la divisi√≥n</a><ul><li><a href="#paso-11-limpieza-estructural" class="table-of-contents__link toc-highlight">Paso 1.1 Limpieza estructural</a><ul><li><a href="#correcci√≥n-de-tipos-de-datos" class="table-of-contents__link toc-highlight">Correcci√≥n de tipos de datos</a></li><li><a href="#normalizaci√≥n-de-formatos-y-categor√≠as" class="table-of-contents__link toc-highlight">Normalizaci√≥n de formatos y categor√≠as</a></li></ul></li><li><a href="#paso-12-duplicados" class="table-of-contents__link toc-highlight">Paso 1.2 Duplicados</a></li><li><a href="#paso-13-outliers-y-errores-evidentes" class="table-of-contents__link toc-highlight">Paso 1.3 Outliers y errores evidentes</a></li></ul></li><li><a href="#paso-2-divisi√≥n-en-traintest" class="table-of-contents__link toc-highlight">Paso 2. Divisi√≥n en <em>train/test</em></a><ul><li><a href="#paso-21-separar-las-features-y-target" class="table-of-contents__link toc-highlight">Paso 2.1. Separar las features y target</a></li><li><a href="#paso-22-divisi√≥n-del-dataset" class="table-of-contents__link toc-highlight">Paso 2.2. Divisi√≥n del dataset</a></li></ul></li><li><a href="#paso-3-operaciones-despu√©s-de-la-divisi√≥n" class="table-of-contents__link toc-highlight">Paso 3. Operaciones despu√©s de la divisi√≥n</a><ul><li><a href="#paso-31-tratamiento-de-valores-nulos-post-split" class="table-of-contents__link toc-highlight">Paso 3.1 Tratamiento de valores nulos (post-split)</a><ul><li><a href="#imputaci√≥n-para-variables-num√©ricas" class="table-of-contents__link toc-highlight">Imputaci√≥n para variables num√©ricas</a></li><li><a href="#imputaci√≥n-para-variables-categ√≥ricas" class="table-of-contents__link toc-highlight">Imputaci√≥n para variables categ√≥ricas</a></li></ul></li><li><a href="#paso-32-codificaci√≥n-de-variables-categ√≥ricas" class="table-of-contents__link toc-highlight">Paso 3.2 Codificaci√≥n de variables categ√≥ricas</a><ul><li><a href="#c√≥mo-elegir-entre-label-y-one-hot" class="table-of-contents__link toc-highlight">¬øC√≥mo elegir entre Label y One-Hot?</a></li><li><a href="#label-encoding-para-variables-ordinales" class="table-of-contents__link toc-highlight">Label Encoding (para variables <em>ordinales</em>)</a></li><li><a href="#one-hot-encoding-para-variables-nominales" class="table-of-contents__link toc-highlight">One-Hot Encoding (para variables <em>nominales</em>)</a></li></ul></li><li><a href="#paso-33-feature-engineering-b√°sico" class="table-of-contents__link toc-highlight">Paso 3.3. Feature Engineering b√°sico</a><ul><li><a href="#creaci√≥n-de-variables-intuitivas" class="table-of-contents__link toc-highlight">Creaci√≥n de variables intuitivas</a></li><li><a href="#eliminaci√≥n-de-variables-redundantes" class="table-of-contents__link toc-highlight">Eliminaci√≥n de variables redundantes</a></li></ul></li><li><a href="#paso-34-escalado-y-normalizaci√≥n-de-variables-num√©ricas" class="table-of-contents__link toc-highlight">Paso 3.4. Escalado y normalizaci√≥n de variables num√©ricas</a><ul><li><a href="#m√©todos-m√°s-utilizados" class="table-of-contents__link toc-highlight">M√©todos m√°s utilizados</a></li><li><a href="#standardscaler-escalado-est√°ndar" class="table-of-contents__link toc-highlight">StandardScaler (escalado est√°ndar)</a></li><li><a href="#minmaxscaler-normalizaci√≥n-01" class="table-of-contents__link toc-highlight">MinMaxScaler (normalizaci√≥n 0‚Äì1)</a></li><li><a href="#resumen-standardscaler-vs-minmaxscaler" class="table-of-contents__link toc-highlight">Resumen StandardScaler vs MinMaxScaler</a></li><li><a href="#debo-escalar-todas-las-columnas-num√©ricas" class="table-of-contents__link toc-highlight">¬øDebo escalar todas las columnas num√©ricas?</a></li></ul></li></ul></li><li><a href="#paso-4-preparaci√≥n-final-del-dataset" class="table-of-contents__link toc-highlight">Paso 4. Preparaci√≥n final del dataset</a><ul><li><a href="#paso-41-revisi√≥n-r√°pida-de-coherencia" class="table-of-contents__link toc-highlight">Paso 4.1 Revisi√≥n r√°pida de coherencia</a></li><li><a href="#paso-42-dataset-final-listo-para-el-modelado" class="table-of-contents__link toc-highlight">Paso 4.2 Dataset final listo para el modelado</a></li><li><a href="#paso-43-guardar-los-datasets-transformados-opcional-pero-recomendable" class="table-of-contents__link toc-highlight">Paso 4.3 Guardar los datasets transformados (opcional, pero recomendable)</a></li></ul></li><li><a href="#ejercicio-de-titanic" class="table-of-contents__link toc-highlight">Ejercicio de Titanic</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">
        <section classname="bg-white border-t border-gray-100">
      <div classname="max-w-4xl mx-auto px-6 py-16 text-center">
        <h3 classname="text-2xl font-bold text-gray-900 mb-4">
          Construyendo conocimiento, l√≠nea por l√≠nea
        </h3>
        <p classname="text-gray-600 leading-relaxed">
          ¬© 2026 Alicia C√°mara Casares - Contenido bajo licencia 
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer" classname="text-blue-600 hover:text-blue-700 underline">
                CC BY-NC-SA 4.0
              </a>.
        </p>
      </div>
    </section>
      </div></div></div></footer></div>
</body>
</html>