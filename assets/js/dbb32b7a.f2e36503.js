"use strict";(self.webpackChunkpmdm=self.webpackChunkpmdm||[]).push([[2256],{15278:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"pia_2526/ut3_ml/aprendizaje-supervisado/regresion/knn_regresion","title":"KNN Regresi\xf3n","description":"Introducci\xf3n a KNN Regression en Machine Learning. Funcionamiento del algoritmo, diferencias con KNN clasificaci\xf3n, hiperpar\xe1metros principales, importancia del escalado, m\xe9tricas de evaluaci\xf3n y ejemplos pr\xe1cticos con scikit-learn.","source":"@site/docs/01_pia_2526/ut3_ml/5-aprendizaje-supervisado/2-regresion/03_knn_regresion.md","sourceDirName":"01_pia_2526/ut3_ml/5-aprendizaje-supervisado/2-regresion","slug":"/pia_2526/ut3_ml/aprendizaje-supervisado/regresion/knn_regresion","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/regresion/knn_regresion","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"KNN Regresi\xf3n","sidebar_position":2,"toc_max_heading_level":5,"description":"Introducci\xf3n a KNN Regression en Machine Learning. Funcionamiento del algoritmo, diferencias con KNN clasificaci\xf3n, hiperpar\xe1metros principales, importancia del escalado, m\xe9tricas de evaluaci\xf3n y ejemplos pr\xe1cticos con scikit-learn.","keywords":["KNN","KNN Regression","Regresi\xf3n KNN","Machine Learning","vecinos m\xe1s cercanos","distancia","scikit-learn"]},"sidebar":"pia_2526_Sidebar","previous":{"title":"Regresi\xf3n Lineal","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/regresion/regresion_lineal"},"next":{"title":"Decision Trees Regresi\xf3n","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/regresion/arbol_decision_regresion"}}');var a=n(74848),r=n(28453);const l={title:"KNN Regresi\xf3n",sidebar_position:2,toc_max_heading_level:5,description:"Introducci\xf3n a KNN Regression en Machine Learning. Funcionamiento del algoritmo, diferencias con KNN clasificaci\xf3n, hiperpar\xe1metros principales, importancia del escalado, m\xe9tricas de evaluaci\xf3n y ejemplos pr\xe1cticos con scikit-learn.",keywords:["KNN","KNN Regression","Regresi\xf3n KNN","Machine Learning","vecinos m\xe1s cercanos","distancia","scikit-learn"]},c=void 0,d={},o=[{value:"Idea principal del algoritmo",id:"idea-principal-del-algoritmo",level:2},{value:"Funcionamiento del modelo",id:"funcionamiento-del-modelo",level:2},{value:"C\xe1lculo de la distancia",id:"c\xe1lculo-de-la-distancia",level:3},{value:"Entrenamiento vs predicci\xf3n",id:"entrenamiento-vs-predicci\xf3n",level:3},{value:"Interpretaci\xf3n geom\xe9trica",id:"interpretaci\xf3n-geom\xe9trica",level:3},{value:"Modelos param\xe9tricos",id:"modelos-param\xe9tricos",level:4},{value:"Modelos no param\xe9tricos",id:"modelos-no-param\xe9tricos",level:4},{value:"Uso de KNN Regresi\xf3n",id:"uso-de-knn-regresi\xf3n",level:2},{value:"Cu\xe1ndo S\xcd usarlo",id:"cu\xe1ndo-s\xed-usarlo",level:3},{value:"Cu\xe1ndo NO funciona bien",id:"cu\xe1ndo-no-funciona-bien",level:3},{value:"Importancia del preprocesamiento",id:"importancia-del-preprocesamiento",level:2},{value:"Principales hiperpar\xe1metros",id:"principales-hiperpar\xe1metros",level:2},{value:"N\xfamero de vecinos (<code>n_neighbors</code>)",id:"n\xfamero-de-vecinos-n_neighbors",level:3},{value:"Pesos (<code>weights</code>)",id:"pesos-weights",level:3},{value:"Ajuste de hiperpar\xe1metros",id:"ajuste-de-hiperpar\xe1metros",level:3},{value:"M\xe9tricas de evaluaci\xf3n",id:"m\xe9tricas-de-evaluaci\xf3n",level:2},{value:"Flujo recomendado en un problema de KNN Regresi\xf3n",id:"flujo-recomendado-en-un-problema-de-knn-regresi\xf3n",level:2},{value:"Ejemplo KNN Regresi\xf3n",id:"ejemplo-knn-regresi\xf3n",level:2},{value:"Actividad de seguimiento: Bike Sharing Dataset",id:"actividad-de-seguimiento-bike-sharing-dataset",level:2}];function t(e){const s={a:"a",admonition:"admonition",annotation:"annotation",blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:["La ",(0,a.jsx)(s.strong,{children:"KNN Regresi\xf3n (K-Nearest Neighbors Regression)"})," es un algoritmo de Machine Learning utilizado para ",(0,a.jsx)(s.strong,{children:"predecir valores num\xe9ricos"})," bas\xe1ndose en la informaci\xf3n de los datos m\xe1s cercanos."]}),"\n",(0,a.jsxs)(s.p,{children:["A diferencia de la Regresi\xf3n Lineal, ",(0,a.jsx)(s.strong,{children:"KNN no aprende una f\xf3rmula matem\xe1tica"}),", sino que realiza las predicciones ",(0,a.jsx)(s.strong,{children:"directamente a partir de los datos de entrenamiento"}),"."]}),"\n",(0,a.jsx)(s.p,{children:"Por su simplicidad conceptual, KNN Regresi\xf3n suele utilizarse como:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Primer ",(0,a.jsx)(s.strong,{children:"modelo no lineal"})]}),"\n",(0,a.jsx)(s.li,{children:"Modelo de comparaci\xf3n frente a regresi\xf3n lineal"}),"\n",(0,a.jsx)(s.li,{children:"Algoritmo introductorio para entender modelos basados en distancia"}),"\n"]}),"\n",(0,a.jsxs)(s.admonition,{title:"Lectura recomendada",type:"info",children:[(0,a.jsxs)(s.p,{children:["Para reforzar la comprensi\xf3n de las diferencias entre ",(0,a.jsx)(s.strong,{children:"Regresi\xf3n Lineal"})," y ",(0,a.jsx)(s.strong,{children:"KNN"}),", se recomienda la siguiente lectura:"]}),(0,a.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,a.jsx)(s.strong,{children:"KNN vs Linear Regression: How to Choose the Right ML Algorithm"}),(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.a,{href:"https://medium.com/@skytoinds/knn-vs-linear-regression-how-to-choose-the-right-ml-algorithm-4f6bf01a4202",children:"https://medium.com/@skytoinds/knn-vs-linear-regression-how-to-choose-the-right-ml-algorithm-4f6bf01a4202"})]}),(0,a.jsx)(s.p,{children:"El art\xedculo compara ambos modelos desde un punto de vista conceptual, destacando aspectos como la forma de la funci\xf3n de predicci\xf3n, la flexibilidad del modelo y el papel de los datos en cada enfoque."})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"idea-principal-del-algoritmo",children:"Idea principal del algoritmo"}),"\n",(0,a.jsx)(s.p,{children:"La idea de KNN Regresi\xf3n es muy intuitiva:"}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsx)(s.p,{children:"\u201cSi varios puntos cercanos tienen valores parecidos, un nuevo punto deber\xeda tener un valor similar.\u201d"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Para predecir un nuevo valor:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Se buscan los ",(0,a.jsx)(s.strong,{children:"k puntos m\xe1s cercanos"})]}),"\n",(0,a.jsxs)(s.li,{children:["Se calcula la ",(0,a.jsx)(s.strong,{children:"media"})," de sus valores objetivo"]}),"\n",(0,a.jsx)(s.li,{children:"Esa media es la predicci\xf3n final"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(20257).A+"",width:"547",height:"413"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"funcionamiento-del-modelo",children:"Funcionamiento del modelo"}),"\n",(0,a.jsx)(s.p,{children:"El funcionamiento interno de KNN Regresi\xf3n sigue siempre los mismos pasos:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Elegir el valor de ",(0,a.jsx)(s.strong,{children:"k"})]}),"\n",(0,a.jsxs)(s.li,{children:["Calcular la ",(0,a.jsx)(s.strong,{children:"distancia"})," entre el punto nuevo y todos los puntos del dataset"]}),"\n",(0,a.jsxs)(s.li,{children:["Seleccionar los ",(0,a.jsx)(s.strong,{children:"k vecinos m\xe1s cercanos"})]}),"\n",(0,a.jsxs)(s.li,{children:["Calcular la ",(0,a.jsx)(s.strong,{children:"media"})," (o media ponderada) de sus valores objetivo"]}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-text",children:"Nuevo punto \u2192 buscar vecinos \u2192 promediar valores \u2192 predicci\xf3n\n"})}),"\n",(0,a.jsx)(s.h3,{id:"c\xe1lculo-de-la-distancia",children:"C\xe1lculo de la distancia"}),"\n",(0,a.jsxs)(s.p,{children:["Para decidir qu\xe9 puntos son \u201ccercanos\u201d, KNN utiliza una ",(0,a.jsx)(s.strong,{children:"m\xe9trica de distancia"}),".\nLa m\xe1s habitual es la ",(0,a.jsx)(s.strong,{children:"distancia eucl\xeddea"}),", aunque existen otras como Manhattan."]}),"\n",(0,a.jsxs)(s.p,{children:["La distancia se calcula teniendo en cuenta ",(0,a.jsx)(s.strong,{children:"todas las variables de entrada"}),", por lo que:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Las variables deben estar en la ",(0,a.jsx)(s.strong,{children:"misma escala"})]}),"\n",(0,a.jsx)(s.li,{children:"Variables con valores grandes pueden dominar la distancia"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Por este motivo, el ",(0,a.jsx)(s.strong,{children:"escalado de los datos es obligatorio"})," en KNN."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"entrenamiento-vs-predicci\xf3n",children:"Entrenamiento vs predicci\xf3n"}),"\n",(0,a.jsx)(s.p,{children:"KNN Regresi\xf3n es un algoritmo basado en instancias:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Durante el ",(0,a.jsx)(s.strong,{children:"entrenamiento"}),", el modelo ",(0,a.jsx)(s.strong,{children:"no aprende par\xe1metros"})]}),"\n",(0,a.jsxs)(s.li,{children:["Simplemente ",(0,a.jsx)(s.strong,{children:"almacena el dataset de entrenamiento"})]}),"\n",(0,a.jsxs)(s.li,{children:["El trabajo computacional ocurre en la ",(0,a.jsx)(s.strong,{children:"fase de predicci\xf3n"})]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Cada vez que se realiza una predicci\xf3n, el modelo debe:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Calcular distancias a todos los puntos"}),"\n",(0,a.jsx)(s.li,{children:"Buscar los vecinos m\xe1s cercanos"}),"\n",(0,a.jsx)(s.li,{children:"Calcular la predicci\xf3n final"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Esto explica por qu\xe9 KNN es muy barato de entrenar pero costoso en tiempo y memoria al predecir"}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"interpretaci\xf3n-geom\xe9trica",children:"Interpretaci\xf3n geom\xe9trica"}),"\n",(0,a.jsxs)(s.p,{children:["KNN Regresi\xf3n ",(0,a.jsx)(s.strong,{children:"no ajusta una recta ni un plano"}),".\nLa predicci\xf3n depende \xfanicamente de la ",(0,a.jsx)(s.strong,{children:"regi\xf3n local"})," del espacio de datos donde cae el nuevo punto."]}),"\n",(0,a.jsx)(s.p,{children:"Esto lo convierte en un modelo:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Flexible"}),"\n",(0,a.jsx)(s.li,{children:"No lineal"}),"\n",(0,a.jsx)(s.li,{children:"Muy dependiente de la distribuci\xf3n de los datos"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(18624).A+"",width:"780",height:"551"})}),"\n",(0,a.jsxs)(s.admonition,{title:"Modelos param\xe9tricos vs no param\xe9tricos",type:"info",children:[(0,a.jsxs)(s.p,{children:["En Machine Learning, los modelos de regresi\xf3n pueden clasificarse, de forma general, en ",(0,a.jsx)(s.strong,{children:"modelos param\xe9tricos"})," y ",(0,a.jsx)(s.strong,{children:"modelos no param\xe9tricos"}),"."]}),(0,a.jsxs)(s.p,{children:["Esta distinci\xf3n no tiene que ver con si el modelo es simple o complejo, sino con ",(0,a.jsx)(s.strong,{children:"c\xf3mo representa la relaci\xf3n entre las variables de entrada y la variable objetivo"}),"."]}),(0,a.jsx)(s.hr,{}),(0,a.jsx)(s.h4,{id:"modelos-param\xe9tricos",children:"Modelos param\xe9tricos"}),(0,a.jsxs)(s.p,{children:["Los ",(0,a.jsx)(s.strong,{children:"modelos param\xe9tricos"})," asumen de antemano una ",(0,a.jsx)(s.strong,{children:"forma concreta"})," para la funci\xf3n de predicci\xf3n.\nEsa funci\xf3n se describe mediante un ",(0,a.jsx)(s.strong,{children:"n\xfamero fijo de par\xe1metros"}),", independientemente de cu\xe1ntos datos tengamos."]}),(0,a.jsxs)(s.p,{children:["La ",(0,a.jsx)(s.strong,{children:"Regresi\xf3n Lineal"})," es un ejemplo claro de modelo param\xe9trico:"]}),(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mi,{children:"y"}),(0,a.jsx)(s.mo,{children:"^"})]}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"w"}),(0,a.jsx)(s.mn,{children:"0"})]}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"w"}),(0,a.jsx)(s.mn,{children:"1"})]}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"x"}),(0,a.jsx)(s.mn,{children:"1"})]}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsx)(s.mo,{children:"\u22ef"}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"w"}),(0,a.jsx)(s.mi,{children:"n"})]}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"x"}),(0,a.jsx)(s.mi,{children:"n"})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\hat{y} = w_0 + w_1x_1 + \\dots + w_nx_n"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"})]}),(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.1944em"},children:(0,a.jsx)(s.span,{className:"mord",children:"^"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1944em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.7333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"0"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.7333em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,a.jsx)(s.span,{className:"minner",children:"\u22ef"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02691em"},children:"w"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0269em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})]})]})}),(0,a.jsxs)(s.p,{children:["El modelo siempre tiene la misma estructura (una combinaci\xf3n lineal de las variables).\nDurante el entrenamiento, ",(0,a.jsx)(s.strong,{children:"solo se ajustan los valores de los coeficientes"}),"."]}),(0,a.jsxs)(s.p,{children:["Aunque aumente la cantidad de datos, ",(0,a.jsx)(s.strong,{children:"la forma del modelo no cambia"}),", \xfanicamente cambian sus par\xe1metros."]}),(0,a.jsx)(s.hr,{}),(0,a.jsx)(s.h4,{id:"modelos-no-param\xe9tricos",children:"Modelos no param\xe9tricos"}),(0,a.jsxs)(s.p,{children:["Los ",(0,a.jsx)(s.strong,{children:"modelos no param\xe9tricos"})," no asumen una forma concreta para la funci\xf3n de predicci\xf3n.\nEn su lugar, permiten que la ",(0,a.jsx)(s.strong,{children:"estructura del modelo dependa directamente de los datos"}),"."]}),(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"KNN Regresi\xf3n"})," es un modelo no param\xe9trico:"]}),(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"No aprende coeficientes"}),"\n",(0,a.jsx)(s.li,{children:"No ajusta una funci\xf3n expl\xedcita"}),"\n",(0,a.jsx)(s.li,{children:"Utiliza directamente los datos de entrenamiento para realizar las predicciones"}),"\n"]}),(0,a.jsx)(s.p,{children:"La forma de la funci\xf3n de predicci\xf3n depende de:"}),(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"la distribuci\xf3n de los datos"}),"\n",(0,a.jsxs)(s.li,{children:["el valor de ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"k"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"(k)"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,a.jsx)(s.span,{className:"mclose",children:")"})]})})]})]}),"\n",(0,a.jsx)(s.li,{children:"la m\xe9trica de distancia utilizada"}),"\n"]}),(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(53515).A+"",width:"1232",height:"502"})})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"uso-de-knn-regresi\xf3n",children:"Uso de KNN Regresi\xf3n"}),"\n",(0,a.jsx)(s.h3,{id:"cu\xe1ndo-s\xed-usarlo",children:"Cu\xe1ndo S\xcd usarlo"}),"\n",(0,a.jsx)(s.p,{children:"KNN Regresi\xf3n puede funcionar bien cuando:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["La relaci\xf3n entre variables es ",(0,a.jsx)(s.strong,{children:"no lineal"})]}),"\n",(0,a.jsx)(s.li,{children:"El dataset no es excesivamente grande"}),"\n",(0,a.jsx)(s.li,{children:"Los datos est\xe1n bien distribuidos"}),"\n",(0,a.jsx)(s.li,{children:"Se dispone de un buen preprocesamiento"}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"cu\xe1ndo-no-funciona-bien",children:"Cu\xe1ndo NO funciona bien"}),"\n",(0,a.jsx)(s.p,{children:"KNN Regresi\xf3n suele rendir mal cuando:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"El dataset es muy grande (coste computacional)"}),"\n",(0,a.jsx)(s.li,{children:"Hay mucho ruido"}),"\n",(0,a.jsx)(s.li,{children:"Existen muchos outliers"}),"\n",(0,a.jsx)(s.li,{children:"El n\xfamero de variables es elevado (curse of dimensionality)"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"En la pr\xe1ctica:"}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsx)(s.p,{children:"KNN es un buen modelo de referencia, pero rara vez es el mejor modelo final."}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"importancia-del-preprocesamiento",children:"Importancia del preprocesamiento"}),"\n",(0,a.jsxs)(s.p,{children:["En KNN Regresi\xf3n, el preprocesamiento ",(0,a.jsx)(s.strong,{children:"es obligatorio"}),"."]}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Aspecto"}),(0,a.jsx)(s.th,{children:"\xbfEs necesario?"}),(0,a.jsx)(s.th,{children:"Explicaci\xf3n"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Tratamiento de nulos"}),(0,a.jsx)(s.td,{children:"\u2714 S\xed"}),(0,a.jsx)(s.td,{children:"No admite valores nulos"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Escalado"}),(0,a.jsx)(s.td,{children:"\u2714 Obligatorio"}),(0,a.jsx)(s.td,{children:"La distancia depende de la escala"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Outliers"}),(0,a.jsx)(s.td,{children:"\u2714 Muy importante"}),(0,a.jsx)(s.td,{children:"Pueden dominar la predicci\xf3n"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"Selecci\xf3n de variables"}),(0,a.jsx)(s.td,{children:"\u2714 Recomendado"}),(0,a.jsx)(s.td,{children:"Reduce ruido y dimensionalidad"})]})]})]}),"\n",(0,a.jsx)(s.admonition,{title:"Escalado obligatorio",type:"warning",children:(0,a.jsxs)(s.p,{children:["Si las variables no est\xe1n en la misma escala, ",(0,a.jsx)(s.strong,{children:"la distancia no tiene sentido"})," y el modelo producir\xe1 predicciones err\xf3neas."]})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"principales-hiperpar\xe1metros",children:"Principales hiperpar\xe1metros"}),"\n",(0,a.jsxs)(s.p,{children:["KNN Regresi\xf3n depende fuertemente de sus hiperpar\xe1metros, ya que estos determinan ",(0,a.jsx)(s.strong,{children:"c\xf3mo se definen los vecinos y c\xf3mo se calcula la predicci\xf3n"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["Por este motivo, es habitual ",(0,a.jsx)(s.strong,{children:"buscar autom\xe1ticamente la mejor combinaci\xf3n de hiperpar\xe1metros"})," utilizando ",(0,a.jsx)(s.strong,{children:"validaci\xf3n cruzada"}),", del mismo modo que ya se ha hecho en los algoritmos de clasificaci\xf3n."]}),"\n",(0,a.jsxs)(s.p,{children:["En la pr\xe1ctica, esto se realiza mediante herramientas como ",(0,a.jsx)(s.strong,{children:"GridSearchCV"}),", que permiten evaluar distintas combinaciones y seleccionar la que ofrece mejor rendimiento medio."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsxs)(s.h3,{id:"n\xfamero-de-vecinos-n_neighbors",children:["N\xfamero de vecinos (",(0,a.jsx)(s.code,{children:"n_neighbors"}),")"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"k peque\xf1o"})," \u2192 modelo muy sensible al ruido (overfitting)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"k grande"})," \u2192 modelo muy suavizado (underfitting)"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["No existe un valor universal de (k).\nEl valor \xf3ptimo debe ajustarse mediante ",(0,a.jsx)(s.strong,{children:"validaci\xf3n cruzada"}),", evaluando el rendimiento del modelo en distintos subconjuntos de datos."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsxs)(s.h3,{id:"pesos-weights",children:["Pesos (",(0,a.jsx)(s.code,{children:"weights"}),")"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"uniform"})," \u2192 todos los vecinos pesan igual"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"distance"})," \u2192 los vecinos m\xe1s cercanos tienen mayor influencia en la predicci\xf3n"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["En muchos casos, ",(0,a.jsx)(s.code,{children:'weights="distance"'})," mejora el rendimiento, especialmente cuando los datos no est\xe1n uniformemente distribuidos."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"ajuste-de-hiperpar\xe1metros",children:"Ajuste de hiperpar\xe1metros"}),"\n",(0,a.jsxs)(s.p,{children:["Al igual que en clasificaci\xf3n, en problemas de regresi\xf3n es posible combinar ",(0,a.jsx)(s.strong,{children:"KNN Regresi\xf3n"}),", ",(0,a.jsx)(s.strong,{children:"validaci\xf3n cruzada"})," y ",(0,a.jsx)(s.strong,{children:"GridSearchCV"})," para:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Probar distintos valores de ",(0,a.jsx)(s.code,{children:"n_neighbors"})]}),"\n",(0,a.jsx)(s.li,{children:"Comparar diferentes esquemas de pesos"}),"\n",(0,a.jsx)(s.li,{children:"Seleccionar autom\xe1ticamente la mejor configuraci\xf3n"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Esto permite obtener un modelo m\xe1s robusto y reducir el riesgo de ",(0,a.jsx)(s.strong,{children:"overfitting"})," o ",(0,a.jsx)(s.strong,{children:"underfitting"}),"."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"m\xe9tricas-de-evaluaci\xf3n",children:"M\xe9tricas de evaluaci\xf3n"}),"\n",(0,a.jsx)(s.p,{children:"En KNN Regresi\xf3n se utilizan las mismas m\xe9tricas que en otros modelos de regresi\xf3n:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"MAE"})," (Mean Absolute Error)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"MSE"})," (Mean Squared Error)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"R\xb2"})," (Coeficiente de determinaci\xf3n)"]}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"flujo-recomendado-en-un-problema-de-knn-regresi\xf3n",children:"Flujo recomendado en un problema de KNN Regresi\xf3n"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Paso"}),(0,a.jsx)(s.th,{children:"Qu\xe9 se hace"}),(0,a.jsx)(s.th,{children:"Por qu\xe9 es importante"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"1. EDA"}),(0,a.jsx)(s.td,{children:"Analizar escalas y outliers"}),(0,a.jsx)(s.td,{children:"KNN es sensible a ambos"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"2. Preprocesamiento"}),(0,a.jsx)(s.td,{children:"Limpieza y escalado"}),(0,a.jsx)(s.td,{children:"Hace v\xe1lida la distancia"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"3. Entrenamiento"}),(0,a.jsx)(s.td,{children:"Ajustar hiperpar\xe1metros"}),(0,a.jsx)(s.td,{children:"Controla el sesgo"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"4. Evaluaci\xf3n"}),(0,a.jsx)(s.td,{children:"MAE, MSE, R\xb2 + An\xe1lisis gr\xe1fico del rendimiento"}),(0,a.jsx)(s.td,{children:"Medir rendimiento"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"5. Comparaci\xf3n"}),(0,a.jsx)(s.td,{children:"Comparar con otros modelos"}),(0,a.jsx)(s.td,{children:"Determina qu\xe9 modelo se adapta mejor a nuestro dataset"})]})]})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"ejemplo-knn-regresi\xf3n",children:"Ejemplo KNN Regresi\xf3n"}),"\n",(0,a.jsxs)(s.p,{children:["Para ver c\xf3mo funciona un ",(0,a.jsx)(s.strong,{children:"KNN Regression"})," en la pr\xe1ctica, puedes ejecutar este ejemplo utilizando el dataset ",(0,a.jsx)(s.strong,{children:"California Housing"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,a.jsx)(s.strong,{children:"Puedes abrir el cuaderno aqu\xed:"}),"\n",(0,a.jsx)(s.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(52549).A+"",children:"Colab: KNN Regression con California Housing"})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"actividad-de-seguimiento-bike-sharing-dataset",children:"Actividad de seguimiento: Bike Sharing Dataset"}),"\n",(0,a.jsxs)(s.p,{children:["Utiliza el ",(0,a.jsx)(s.strong,{children:"Bike Sharing Dataset"})," y compara:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Regresi\xf3n Lineal"}),"\n",(0,a.jsx)(s.li,{children:"KNN Regresi\xf3n"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Recuerda que debes realizar:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Entrenamiento con GridSearch"}),"\n",(0,a.jsx)(s.li,{children:"An\xe1lisis mejores hiperpar\xe1metros"}),"\n",(0,a.jsx)(s.li,{children:"M\xe9tricas de evaluaci\xf3n"}),"\n",(0,a.jsx)(s.li,{children:"Gr\xe1fica de an\xe1lisis de resultados (Valores reales vs predichos; Residuos)"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Usa el mismo Colab que la entrega anterior"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Entrega:"})," Notebook (Colab) con conclusiones razonadas."]})]})}function m(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}},18624:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/knn-regressor-2-0a79bcaa81c382969d57dc0ea5869991.png"},20257:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/knn-regressor-7dd3e7bf7c5b723bd500722666e2964f.png"},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var i=n(96540);const a={},r=i.createContext(a);function l(e){const s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(r.Provider,{value:s},e.children)}},52549:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/files/ejemplo_knn_regresion-69b4e4d64b0cf8bd868c95a0f19c3c38.ipynb"},53515:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/lr-vs-knn-1f4426618b1426ce14dab4dbced5249b.png"}}]);