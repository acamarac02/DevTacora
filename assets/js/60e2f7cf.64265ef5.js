"use strict";(self.webpackChunkpmdm=self.webpackChunkpmdm||[]).push([[1082],{521:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>t,contentTitle:()=>d,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>s});const i=JSON.parse('{"id":"pmdm_2526/ut5_persistencia/room/favorito-elementos","title":"Marcar como favorito","description":"En este tutorial vamos a\xf1adir un bot\xf3n de favorito (ImageButton) a cada Animal del RecyclerView, de forma que al presionar el bot\xf3n, se marcar\xe1 o desmarcar\xe1 como favorito, y se actualizar\xe1 el estado visual. Adem\xe1s, guardaremos el nuevo estado en la base de datos.","source":"@site/docs/01_pmdm_2526/ut5_persistencia/room/3-favorito-elementos.md","sourceDirName":"01_pmdm_2526/ut5_persistencia/room","slug":"/pmdm_2526/ut5_persistencia/room/favorito-elementos","permalink":"/DevTacora/docs/pmdm_2526/ut5_persistencia/room/favorito-elementos","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"Marcar como favorito","title":"Marcar como favorito"},"sidebar":"pmdm_2526_Sidebar","previous":{"title":"Insertar y eliminar elementos","permalink":"/DevTacora/docs/pmdm_2526/ut5_persistencia/room/insertar-elementos"},"next":{"title":"Shared preferences","permalink":"/DevTacora/docs/pmdm_2526/ut5_persistencia/shared-preferences"}}');var n=o(4848),r=o(8453);const l={sidebar_position:3,sidebar_label:"Marcar como favorito",title:"Marcar como favorito"},d=void 0,t={},s=[{value:"Modificar el layout del ViewHolder",id:"modificar-el-layout-del-viewholder",level:2},{value:"A\xf1adir el estado de favorito a la entidad (<code>Animal</code>)",id:"a\xf1adir-el-estado-de-favorito-a-la-entidad-animal",level:2},{value:"Modificar el Adaptador del RecyclerView",id:"modificar-el-adaptador-del-recyclerview",level:2}];function c(e){const a={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)("div",{class:"justify-text",children:[(0,n.jsxs)(a.p,{children:["En este tutorial vamos a\xf1adir un ",(0,n.jsx)(a.strong,{children:"bot\xf3n de favorito (ImageButton)"})," a cada Animal del ",(0,n.jsx)(a.code,{children:"RecyclerView"}),", de forma que al presionar el bot\xf3n, se marcar\xe1 o desmarcar\xe1 como favorito, y se actualizar\xe1 el estado visual. Adem\xe1s, guardaremos el nuevo estado en la base de datos."]}),(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"UT5. Seleccion favoritos",src:o(6078).A+"",width:"406",height:"856"})}),(0,n.jsxs)(a.p,{children:["Para el bot\xf3n usaremos los siguientes iconos (",(0,n.jsx)(a.a,{href:"https://www.flaticon.es/iconos-gratis/estrella",children:"Estrella iconos creados por Pixel perfect"}),"):\n",(0,n.jsx)(a.img,{alt:"UT5. Icono no favorito",src:o(5829).A+"",width:"32",height:"32"}),"\n",(0,n.jsx)(a.img,{alt:"UT5. Icono favorito",src:o(7294).A+"",width:"32",height:"32"})]}),(0,n.jsx)(a.h2,{id:"modificar-el-layout-del-viewholder",children:"Modificar el layout del ViewHolder"}),(0,n.jsxs)(a.p,{children:["Modifica el layout de los ",(0,n.jsx)(a.code,{children:"ViewHolder"})," del ",(0,n.jsx)(a.code,{children:"RecyclerView"})," para a\xf1adir un ",(0,n.jsx)(a.code,{children:"ImageButton"})," para el bot\xf3n de favorito. Por defecto vamos a poner el icono de no favorito aunque lo controlaremos m\xe1s adelante desde Java."]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-xml",metastring:'title="viewholder_animal.xml"',children:'<CardView ...>\n    <LinearLayout\n        android:layout_width="match_parent"\n        android:layout_height="wrap_content"\n        android:orientation="horizontal"\n        android:padding="16dp">\n\n        <TextView\n            android:id="@+id/tvNombreAnimal"\n            android:layout_width="0dp"\n            android:layout_weight="1"\n            android:layout_height="wrap_content"\n            android:text="Nombre animal"\n            android:textSize="18sp"\n            android:textStyle="bold"\n            android:padding="4dp" />\n\n        <ImageButton\n            android:id="@+id/btnFavorito"\n            android:layout_width="40dp"\n            android:layout_height="40dp"\n            android:background="?attr/selectableItemBackground"\n            android:src="@drawable/icon_no_fav"\n            android:contentDescription="A\xf1adir a favoritos" />\n    </LinearLayout>\n</CardView>\n'})}),(0,n.jsxs)(a.p,{children:["El background ",(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"selectableItemBackground"})})," a\xf1ade un efecto t\xe1ctil al presionar el bot\xf3n."]}),(0,n.jsxs)(a.h2,{id:"a\xf1adir-el-estado-de-favorito-a-la-entidad-animal",children:["A\xf1adir el estado de favorito a la entidad (",(0,n.jsx)(a.code,{children:"Animal"}),")"]}),(0,n.jsxs)(a.p,{children:["Modifica la entidad ",(0,n.jsx)(a.code,{children:"Animal"})," para incluir un campo que indique si el animal est\xe1 marcado como favorito:"]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",metastring:'title="Animal.java"',children:'@Entity(tableName = "animal")\npublic class Animal implements Serializable {\n\n    @PrimaryKey(autoGenerate = true)\n    private int id;\n    private String nombre;\n    private String descripcion;\n    private byte[] foto;\n    private boolean favorito;\n\n    // Constructor\n    public Animal(String nombre, String descripcion, byte[] foto) {\n        this.nombre = nombre;\n        this.descripcion = descripcion;\n        this.foto = foto;\n        this.favorito = false; // Por defecto, cuando creamos un animal se pondr\xe1 como no favorito\n    }\n}\n'})}),(0,n.jsx)(a.admonition,{type:"warning",children:(0,n.jsxs)(a.p,{children:["Recuerda que un cambio en el modelo implica realizar una migraci\xf3n de la base de datos. Tambi\xe9n puedes ",(0,n.jsx)(a.strong,{children:"desinstalar la aplicaci\xf3n"})," del dispositivo y volver a instalarla sin realizar la migraci\xf3n."]})}),(0,n.jsx)(a.h2,{id:"modificar-el-adaptador-del-recyclerview",children:"Modificar el Adaptador del RecyclerView"}),(0,n.jsxs)(a.p,{children:["Ahora modificamos el adaptador del ",(0,n.jsx)(a.code,{children:"RecyclerView"})," para:"]}),(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Mostrar el icono de favorito o no favorito seg\xfan el estado del animal"}),"\n",(0,n.jsxs)(a.li,{children:["Responder al click del bot\xf3n favorito, que implica:","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Actualizar el estado del animal"}),"\n",(0,n.jsxs)(a.li,{children:["Actualizar el icono en el ",(0,n.jsx)(a.code,{children:"ViewHolder"})]}),"\n",(0,n.jsx)(a.li,{children:"Ejecutar el update en base de datos"}),"\n"]}),"\n"]}),"\n"]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-java",children:"public class AnimalAdapter extends RecyclerView.Adapter<AnimalAdapter.AnimalViewHolder> {\n\n    ...\n\n    @Override\n    public void onBindViewHolder(@NonNull AnimalViewHolder holder, int position) {\n        Animal animal = listaAnimales.get(position);\n        holder.binding.tvNombreAnimal.setText(animal.getNombre());\n\n        // Cuando se cargue el RecyclerView, actualizamos el icono seg\xfan el estado del animal\n        establecerIconoFavorito(animal, holder);\n\n        holder.itemView.setOnClickListener(v -> navegarPantallaDetalle(animal));\n\n        // Escuchamos los eventos de click sobre el bot\xf3n de favorito\n        holder.binding.btnFavorito.setOnClickListener(v -> marcarFavorito(animal, holder));\n    }\n\n    // M\xe9todo que se ejecuta en el evento de click\n    private void marcarFavorito(Animal animal, AnimalViewHolder holder) {\n        // Cambiamos el estado del animal seleccionado\n        if (animal.isFavorito()) animal.setFavorito(false);\n        else animal.setFavorito(true);\n\n        // Cambiamos el icono del animal seleccionado\n        establecerIconoFavorito(animal, holder);\n\n        // Actualizamos el estado del animal en base de datos\n        viewModel.actualizarAnimal(animal);\n    }\n\n    // M\xe9todo que establece el icono seg\xfan el estado del animal\n    private void establecerIconoFavorito(Animal animal, AnimalViewHolder holder) {\n        if (animal.isFavorito()) {\n            holder.binding.btnFavorito.setImageResource(R.drawable.icon_fav);\n        } else {\n            holder.binding.btnFavorito.setImageResource(R.drawable.icon_no_fav);\n        }\n    }\n}\n"})}),(0,n.jsx)(a.admonition,{type:"info",children:(0,n.jsxs)(a.p,{children:["No olvides implementar el m\xe9todo ",(0,n.jsx)(a.code,{children:"actualizarAnimal"})," en el ",(0,n.jsx)(a.code,{children:"ViewModel"}),", ",(0,n.jsx)(a.code,{children:"Repository"})," y ",(0,n.jsx)(a.code,{children:"Dao"})," para realizar actualizaciones de registros sobre la base de datos."]})})]})}function m(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},7294:(e,a,o)=>{o.d(a,{A:()=>i});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsgAAALIBa5Ro4AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASBSURBVFiFvZdNbFRVFMd/9743M/2ezkw7M/1wgjhQECaiQYUiQmLChxqjIomJElE3uCDYjYgbJSRqXUHsxgUBbGIwwEKlNBoiYYWREGDTIFVbKNAOzfSDlk47894cF9Npaek0fSD9Jze5771z/ud/77kf58HDYel4m38UF/A+IICM9+cVhr+MgZwAXymDgDlv0YM+3gGkLqKkLqIEkKoA786bgEhItQPS9LEp3+4yBZBISF2dl+BuNzGlkNIiZPCUR+60esRbnE2Fy8VTTvm0U4cFIdUoAh+8bFBWDKVF8N4mA4CFYfWVUz6n8HlcWEohV5rdImc9Imc90v6DW7RG3C4sIOCE0NEMLAjr3WNpjM3Pa+oiauJ9tEax8VlNKo2xKKJ3PyoBxlBSdgDs3GLc9zH3LjGQ2QHcb5AHatpzAAgBlZGQsdhbLAu1pjZjS2Q4SXVHj0QX1SquNLvR06RnMrBkW4r2G8LjYfV3SRG3DK267Axdw0nV0dFt/wX0AnEgca/vG+Ul3DINbMYPlnxNa+TEPtdE7qe3E/tcovXsHICYBnZ5CbeA15VpELdsggDlJRD2K4I+RdgPIV+2XxWAoE+xIqp4LDh90qbiely4/I8Q7xO6E9A7IPT0CT192X53Qhi8m7U1DW6rogLOj4yy8skFitZvXERCswd4WFyPC5s/SdPWKRQVcF6PjPJmwKtutnUKqz5Kc7FdHlnwi+3ZGG2dQsCrbo6MskUDXYlBWRr2q/PdCeHFnSlazmX+9+CnL2RYvytFd0II+dXlxKAsB7py2yU1nORIyMfT/UMs/vH3DEGfYuUSxwfljDjcavP2XovkGIT8nI738RIwDFP3q313lKNhP6VDI6xuOZehfwg2PadRD7gsRGDvYYuGJptMBirLOXS7n62AlbO578AYTvJboIy+VJpNf7SJ6uiG19ZotEMRlg0fNlocOG5jaCTopeH2AJ9Nt5vxxEqO8WdJCRc1bL1wVXR1hWJlnbN0fPeLzZfNNgVurLJCtvTe4chMdnlZh4b4ubaSZoAbvc53xs1xn+oKvk8M8VM+u1mHZWfUaoBnFjtfjDkfkSzHgwgwevrkCYDVy5yvwjWxrE93QqLMcjnNJiCWHMMVrVGE/c4FhHyKhdWK0RQuIOZYQG1QbwBYtWxmk84eoaHJoqHJ4lp85jVSvzzrGwnrjY4FFHnkFYA1y6eOPm3BgeM2se0p9h+z2X/MZum2FF8cshhNTeXIpa7QJZvzxcmLgFf1A3Lp4GTpdfJrl0RrsmW4Ukhtpfq1yk+rUtlrNlqjpKVx8rq+dNAtgIxzOUIIkLJixDrjka7jbtm2wZi4zwNlxD0mE9NqmqwLeFVX7vur9Vr+PeoW+8xkxQxUzTm622ArIOtXaNm/05TigiyJx0XaV0oj4J7Bzaz0safQwxgghR7k8+2GvBDTAojb4K05C9CaPdxTwSiFVFXQMsdRhKsrOJlLC5PV1KdzFgDUK4VFNn/XCwpY58QZwDRZG/BybXwANlDvlCMGrOfhfjpNYC2wKJ/BfzWWzm89fxVaAAAAAElFTkSuQmCC"},5829:(e,a,o)=>{o.d(a,{A:()=>i});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsgAAALIBa5Ro4AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAKZSURBVFiFxZfLaxRBEMZ/m12DlwQlmGRjHgoRFdRN9KJBxYOCWS9qzgEv4hO8GY/5DzSHXPSiRi9eRXISXyCexAeCEOIDcY0RwcQHxJiMh/qaGTc7Y2birAVFz3RX1fd1dVdPDyxNNkr/i/QDnrS/2uBZ4HWAwFsgV00CfQJ+KfXUVzW5J9BTwGk9360W+CZgHpgG6oE64ItIbKkGgUsCuxDoG1LfxbTBVwLfsQysD/R3AnPAD6AhTQID2ExvVRgb1djZtMCzwCuB7K8wXsQvyexig2bK3huAJmAV0AI0SluANcAeYAzYgC1DUGqwklyHVcQboARMSkvAJ+Aj8DnoeEiOM/gHS5jOAYcjJtQnm7/FmRHmwQzwXjMEK6cJMZ4Q20ngg9onwLsIAgDtQAHLZB7LZl7vjXqul20J4IFYvZBz2tIuLA+4D9AGPFdHCehOEbwLy7gnzDY3UIdfRl+BAymA7wWmhHEbWFFuUAtclcEv4Pg/BD8C/FTsG8DyMMMMMIi/W4dYWKpxJHG8o8CsnK4Q42AJSA64rBizihlLerH94AHHEhA4gb+nesOMaiICjALDem5NQGC12mHFik0AYJvaxwkIOJ+tCXwBW3dXNs0J/JvkO02yPUS3AowlcZaMK0ZXmEHUEmxX+yhkvAM4L+0IsXmodkcETqhcw9iXH0jLgDP4FeJhN6FBFh4wJzU+koSAS18h0FfElsTD7gPXpfP4y1UM2BfUPx4X3G2gKWwDteIf0+5/YF/AfjfwLDB+E1iLLbG7MefjEHA/Hnf4M93fsFTXVvDJydYBumVxn/uoi8wCOReYjUv3yCJn0Yxlyy2L04E4BHrwvwVPgV1xnCU7sRuU+7r2xA2wGbuELuWnM4eR7wwz+A3ca8ssKDay+wAAAABJRU5ErkJggg=="},6078:(e,a,o)=>{o.d(a,{A:()=>i});const i=o.p+"assets/images/7-video-favorito-d702c3e39254e077cb76d83f662d07f4.gif"},8453:(e,a,o)=>{o.d(a,{R:()=>l,x:()=>d});var i=o(6540);const n={},r=i.createContext(n);function l(e){const a=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),i.createElement(r.Provider,{value:a},e.children)}}}]);