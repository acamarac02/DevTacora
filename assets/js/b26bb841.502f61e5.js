"use strict";(self.webpackChunkpmdm=self.webpackChunkpmdm||[]).push([[2452],{10198:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/files/employee-611bdcd619dee88800db232fcaf1504b.csv"},14142:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/scatterplot-knn-103780d3f22eb0bc3bb4951b008e67c4.png"},14194:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/knn-ejemplo-2-7faf3854598bcd11d7c55889d949d6c3.png"},22896:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/knn-crossval-9033078481d8dfc3e46074254f96d3db.png"},27485:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn","title":"K-Nearest Neighbors (KNN)","description":"Introducci\xf3n al algoritmo K-Nearest Neighbors (KNN) aplicado a problemas de clasificaci\xf3n. C\xf3mo funciona, por qu\xe9 depende del preprocesamiento, c\xf3mo elegir el mejor valor de k y c\xf3mo evaluarlo con m\xe9tricas de clasificaci\xf3n.","source":"@site/docs/01_pia_2526/ut3_ml/5-aprendizaje-supervisado/1-clasificacion/1-knn.md","sourceDirName":"01_pia_2526/ut3_ml/5-aprendizaje-supervisado/1-clasificacion","slug":"/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"K-Nearest Neighbors (KNN)","sidebar_position":1,"toc_max_heading_level":5,"description":"Introducci\xf3n al algoritmo K-Nearest Neighbors (KNN) aplicado a problemas de clasificaci\xf3n. C\xf3mo funciona, por qu\xe9 depende del preprocesamiento, c\xf3mo elegir el mejor valor de k y c\xf3mo evaluarlo con m\xe9tricas de clasificaci\xf3n.","keywords":["KNN","Clasificaci\xf3n","Machine Learning","vecinos m\xe1s cercanos","scikit-learn","m\xe9tricas","distancia","hiperpar\xe1metros"]},"sidebar":"pia_2526_Sidebar","previous":{"title":"Clasificaci\xf3n","permalink":"/DevTacora/docs/category/clasificaci\xf3n"},"next":{"title":"Decision Trees","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/arbol-decision"}}');var i=n(74848),r=n(28453);const l={title:"K-Nearest Neighbors (KNN)",sidebar_position:1,toc_max_heading_level:5,description:"Introducci\xf3n al algoritmo K-Nearest Neighbors (KNN) aplicado a problemas de clasificaci\xf3n. C\xf3mo funciona, por qu\xe9 depende del preprocesamiento, c\xf3mo elegir el mejor valor de k y c\xf3mo evaluarlo con m\xe9tricas de clasificaci\xf3n.",keywords:["KNN","Clasificaci\xf3n","Machine Learning","vecinos m\xe1s cercanos","scikit-learn","m\xe9tricas","distancia","hiperpar\xe1metros"]},c=void 0,o={},d=[{value:"C\xf3mo funciona KNN",id:"c\xf3mo-funciona-knn",level:2},{value:"Distancias",id:"distancias",level:3},{value:"El par\xe1metro k y su efecto en el modelo",id:"el-par\xe1metro-k-y-su-efecto-en-el-modelo",level:3},{value:"Proceso de predicci\xf3n paso a paso",id:"proceso-de-predicci\xf3n-paso-a-paso",level:3},{value:"Cu\xe1ndo se utiliza y principales caracter\xedsticas",id:"cu\xe1ndo-se-utiliza-y-principales-caracter\xedsticas",level:2},{value:"Ventajas",id:"ventajas",level:2},{value:"Limitaciones",id:"limitaciones",level:2},{value:"Importancia del preprocesamiento",id:"importancia-del-preprocesamiento",level:2},{value:"Implementaci\xf3n en Python",id:"implementaci\xf3n-en-python",level:2},{value:"Paso 1. B\xfasqueda de la mejor <em>k</em>",id:"paso-1-b\xfasqueda-de-la-mejor-k",level:3},{value:"Opci\xf3n 1. 5-Fold Cross-Validation",id:"opci\xf3n-1-5-fold-cross-validation",level:4},{value:"Aplicaci\xf3n de 5-FOLD CV con varias k",id:"aplicaci\xf3n-de-5-fold-cv-con-varias-k",level:5},{value:"Gr\xe1fico: Accuracy vs k",id:"gr\xe1fico-accuracy-vs-k",level:5},{value:"Selecci\xf3n de la mejor <em>k</em>",id:"selecci\xf3n-de-la-mejor-k",level:5},{value:"Opci\xf3n 2. GridSearchCV",id:"opci\xf3n-2-gridsearchcv",level:4},{value:"Paso 2. Entrenamiento con la mejor <em>k</em>",id:"paso-2-entrenamiento-con-la-mejor-k",level:3},{value:"Paso 3. Evaluaci\xf3n mediante m\xe9tricas",id:"paso-3-evaluaci\xf3n-mediante-m\xe9tricas",level:3},{value:"Accuracy",id:"accuracy",level:4},{value:"Matriz de confusi\xf3n",id:"matriz-de-confusi\xf3n",level:4},{value:"Flujo recomendado en un problema de KNN",id:"flujo-recomendado-en-un-problema-de-knn",level:2},{value:"Actividad de Seguimiento: Retenci\xf3n de empleados",id:"actividad-de-seguimiento-retenci\xf3n-de-empleados",level:2},{value:"Dataset",id:"dataset",level:3},{value:"Entregable",id:"entregable",level:3}];function t(e){const s={a:"a",admonition:"admonition",annotation:"annotation",blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",h5:"h5",hr:"hr",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msqrt:"msqrt",msub:"msub",msup:"msup",mtext:"mtext",ol:"ol",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",strong:"strong",svg:"svg",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.p,{children:["El algoritmo ",(0,i.jsx)(s.strong,{children:"K-Nearest Neighbors (KNN)"})," es uno de los modelos m\xe1s sencillos e intuitivos de todo el aprendizaje supervisado.\nSu idea principal es muy f\xe1cil de entender:"]}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Para predecir la clase de una nueva observaci\xf3n, el modelo \u201cmira\u201d a los k puntos m\xe1s cercanos y decide seg\xfan lo que digan sus vecinos."})}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["No construye una f\xf3rmula, ni ajusta par\xe1metros, ni aprende pesos.\nSimplemente ",(0,i.jsx)(s.strong,{children:"compara distancias"})," entre observaciones. Por eso se le llama un modelo ",(0,i.jsx)(s.strong,{children:"basado en instancias"}),"."]}),"\n",(0,i.jsx)(s.h2,{id:"c\xf3mo-funciona-knn",children:"C\xf3mo funciona KNN"}),"\n",(0,i.jsxs)(s.p,{children:["El algoritmo ",(0,i.jsx)(s.strong,{children:"K-Nearest Neighbors (KNN)"})," toma sus decisiones bas\xe1ndose en una idea muy sencilla:\n",(0,i.jsx)(s.strong,{children:"si un punto nuevo se parece a otros puntos que ya conocemos, deber\xeda pertenecer a la misma clase que ellos."})]}),"\n",(0,i.jsx)(s.p,{children:"Para aplicar esta idea, KNN utiliza tres elementos clave:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Una medida de distancia"})," para saber qu\xe9 observaciones est\xe1n cerca."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Un par\xe1metro k"}),", que indica cu\xe1ntos vecinos mirar."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Un proceso de votaci\xf3n"}),", donde los vecinos \u201cdeciden\u201d la clase final."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"A continuaci\xf3n explicamos cada uno de estos elementos."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"distancias",children:"Distancias"}),"\n",(0,i.jsxs)(s.p,{children:["Para que el modelo pueda saber cu\xe1les son los puntos \u201cm\xe1s cercanos\u201d, es necesario medir la distancia entre observaciones.\nLa m\xe1s utilizada por defecto es la ",(0,i.jsx)(s.strong,{children:"distancia eucl\xeddea"}),", que se corresponde con la distancia recta entre dos puntos:"]}),"\n",(0,i.jsx)(s.span,{className:"katex-display",children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"d"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"p"}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsx)(s.mi,{children:"q"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.msqrt,{children:(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{children:"p"}),(0,i.jsx)(s.mn,{children:"1"})]}),(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{children:"q"}),(0,i.jsx)(s.mn,{children:"1"})]}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mn,{children:"2"})]}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{children:"p"}),(0,i.jsx)(s.mn,{children:"2"})]}),(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{children:"q"}),(0,i.jsx)(s.mn,{children:"2"})]}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mn,{children:"2"})]}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mo,{children:"\u2026"}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{children:"p"}),(0,i.jsx)(s.mi,{children:"n"})]}),(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{children:"q"}),(0,i.jsx)(s.mi,{children:"n"})]}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mn,{children:"2"})]})]})})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"d(p, q) = \\sqrt{(p_1 - q_1)^2 + (p_2 - q_2)^2 + \\ldots + (p_n - q_n)^2}"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1.24em",verticalAlign:"-0.2561em"}}),(0,i.jsx)(s.span,{className:"mord sqrt",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsxs)(s.span,{className:"vlist",style:{height:"0.9839em"},children:[(0,i.jsxs)(s.span,{className:"svg-align",style:{top:"-3.2em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsxs)(s.span,{className:"mord",style:{paddingLeft:"1em"},children:[(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]}),(0,i.jsxs)(s.span,{className:"mclose",children:[(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.7401em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]}),(0,i.jsxs)(s.span,{className:"mclose",children:[(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.7401em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"minner",children:"\u2026"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]}),(0,i.jsxs)(s.span,{className:"mclose",children:[(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.7401em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})]}),(0,i.jsxs)(s.span,{style:{top:"-2.9439em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsx)(s.span,{className:"hide-tail",style:{minWidth:"1.02em",height:"1.28em"},children:(0,i.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.28em",viewBox:"0 0 400000 1296",preserveAspectRatio:"xMinYMin slice",children:(0,i.jsx)(s.path,{d:"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z"})})})]})]}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.2561em"},children:(0,i.jsx)(s.span,{})})})]})})]})]})]})}),"\n",(0,i.jsx)(s.p,{children:"Esto significa que dos observaciones ser\xe1n consideradas \u201csimilares\u201d si:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"sus valores num\xe9ricos est\xe1n cerca entre s\xed,"}),"\n",(0,i.jsx)(s.li,{children:"y sus variables categ\xf3ricas han sido codificadas adecuadamente."}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"el-par\xe1metro-k-y-su-efecto-en-el-modelo",children:"El par\xe1metro k y su efecto en el modelo"}),"\n",(0,i.jsxs)(s.p,{children:["El valor de ",(0,i.jsx)(s.strong,{children:"k"})," determina cu\xe1ntos vecinos toma en cuenta KNN para votar la clase final. Elegir un buen valor es fundamental porque controla el equilibrio entre ",(0,i.jsx)(s.strong,{children:"sobreajuste (overfitting)"})," y ",(0,i.jsx)(s.strong,{children:"subajuste (underfitting)"})," en el modelo:"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"k muy peque\xf1o \u2192 Overfitting (sobreajuste)"}),".",(0,i.jsx)(s.br,{}),"\n","El modelo se fija demasiado en los vecinos m\xe1s cercanos."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Es muy sensible al ruido."}),"\n",(0,i.jsx)(s.li,{children:"Cambiar un solo punto puede modificar la predicci\xf3n."}),"\n",(0,i.jsx)(s.li,{children:"Se adapta demasiado al conjunto de entrenamiento y generaliza peor."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["\u27a1 Resultado: ",(0,i.jsx)(s.strong,{children:"accuracy muy alta en train, baja en test"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"k muy grande \u2192 Underfitting (subajuste)"}),".",(0,i.jsx)(s.br,{}),"\n","El modelo suaviza demasiado las decisiones."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Considera tantos vecinos que pierde detalles importantes."}),"\n",(0,i.jsx)(s.li,{children:"Mezcla puntos de clases diferentes."}),"\n",(0,i.jsx)(s.li,{children:"La frontera de decisi\xf3n es demasiado simple."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["\u27a1 Resultado: ",(0,i.jsx)(s.strong,{children:"accuracy baja tanto en train como en test"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["El ",(0,i.jsx)(s.strong,{children:"objetivo"})," es encontrar un k intermedio que permita:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"un modelo estable,"}),"\n",(0,i.jsx)(s.li,{children:"que generalice bien,"}),"\n",(0,i.jsx)(s.li,{children:"sin sensibilidad excesiva al ruido."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Ese valor se suele encontrar probando varios valores de k y comparando el error en test. M\xe1s adelante haremos un gr\xe1fico \u201c",(0,i.jsx)(s.em,{children:"accuracy vs k"}),"\u201d que lo muestra visualmente."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"proceso-de-predicci\xf3n-paso-a-paso",children:"Proceso de predicci\xf3n paso a paso"}),"\n",(0,i.jsx)(s.p,{children:"Cuando KNN tiene que decidir la clase de una nueva observaci\xf3n, sigue tres pasos muy claros:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"1. Calcular todas las distancias"})}),"\n",(0,i.jsxs)(s.p,{children:["Compara la observaci\xf3n nueva con ",(0,i.jsx)(s.strong,{children:"todas"})," las del conjunto de entrenamiento.\nPara cada observaci\xf3n calcula una distancia (eucl\xeddea, Manhattan, etc.)."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Ejemplo KNN",src:n(98303).A+"",width:"800",height:"400"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"2. Seleccionar los k vecinos m\xe1s cercanos"})}),"\n",(0,i.jsxs)(s.p,{children:["Ordena todas las distancias de menor a mayor y se queda con los ",(0,i.jsx)(s.strong,{children:"k puntos m\xe1s cercanos"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Ejemplo:\nSi k = 5 \u2192 se toman los 5 puntos m\xe1s pr\xf3ximos."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Ejemplo KNN",src:n(14194).A+"",width:"800",height:"400"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"3. Votar la clase mayoritaria"})}),"\n",(0,i.jsx)(s.p,{children:"Los vecinos \u201cvotan\u201d su clase.\nLa clase que m\xe1s se repita entre esos k vecinos es la que el modelo asigna."}),"\n",(0,i.jsx)(s.p,{children:"Ejemplos:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Si los 5 vecinos son ",(0,i.jsx)(s.code,{children:"[1, 0, 1, 1, 0]"})," \u2192 la clase predicha es ",(0,i.jsx)(s.strong,{children:"1"}),"."]}),"\n",(0,i.jsx)(s.li,{children:"Si est\xe1n empatados, KNN utiliza criterios internos para romper el empate (dependiendo de la implementaci\xf3n)."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Ejemplo KNN",src:n(63195).A+"",width:"800",height:"400"})}),"\n",(0,i.jsxs)(s.admonition,{title:"PARTICULARIDAD DE KNN",type:"info",children:[(0,i.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,i.jsx)(s.strong,{children:"KNN no entrena un modelo"}),"\nKNN ",(0,i.jsx)(s.strong,{children:"no ajusta par\xe1metros"})," como hacen la regresi\xf3n log\xedstica o las redes neuronales."]}),(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:"Solo guarda los datos de entrenamiento y los usa para comparar distancias durante la predicci\xf3n."}),"\n"]}),(0,i.jsx)(s.p,{children:"Esto hace que:"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"El entrenamiento sea pr\xe1cticamente instant\xe1neo."}),"\n",(0,i.jsx)(s.li,{children:"Pero la predicci\xf3n sea m\xe1s costosa si hay muchos datos."}),"\n"]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"cu\xe1ndo-se-utiliza-y-principales-caracter\xedsticas",children:"Cu\xe1ndo se utiliza y principales caracter\xedsticas"}),"\n",(0,i.jsx)(s.p,{children:"KNN es un modelo \xfatil cuando:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Queremos un primer modelo sencillo, r\xe1pido de implementar."}),"\n",(0,i.jsx)(s.li,{children:"El dataset no es muy grande (KNN calcula distancias para cada predicci\xf3n)."}),"\n",(0,i.jsxs)(s.li,{children:["Las variables son significativas en t\xe9rminos de ",(0,i.jsx)(s.strong,{children:"similitud"})," (lo similar debe estar cerca)."]}),"\n"]}),"\n",(0,i.jsxs)(s.admonition,{title:"\xbfQu\xe9 significa la similitud?",type:"tip",children:[(0,i.jsx)(s.p,{children:"KNN funciona bien cuando se cumple la siguiente idea:"}),(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Si dos observaciones son similares en sus features, deber\xedan pertenecer a la misma clase."})}),"\n"]}),(0,i.jsx)(s.p,{children:"Ejemplos (Titanic):"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Pasajeros con ",(0,i.jsx)(s.strong,{children:"Pclass = 1"}),", ",(0,i.jsx)(s.strong,{children:"Sex = female"}),", ",(0,i.jsx)(s.strong,{children:"Fare alto"})," \u2192 suelen estar en la clase \u201c",(0,i.jsx)(s.em,{children:"sobrevivi\xf3"}),"\u201d."]}),"\n",(0,i.jsxs)(s.li,{children:["Pasajeros ",(0,i.jsx)(s.strong,{children:"varones"})," en ",(0,i.jsx)(s.strong,{children:"tercera clase"})," \u2192 suelen estar en \u201c",(0,i.jsx)(s.em,{children:"no sobrevivi\xf3"}),"\u201d."]}),"\n"]}),(0,i.jsxs)(s.p,{children:["Puedes comprobarlo visualmente utilizando un ",(0,i.jsx)(s.strong,{children:"scatterplot coloreado por clase"}),", representando dos variables num\xe9ricas relevantes:"]}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'sns.scatterplot(x="Age", y="Fare", hue="Survived", data=df)\n'})}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(14142).A+"",width:"571",height:"432"})}),(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Interpretaci\xf3n:"})}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Si los puntos de la misma clase forman ",(0,i.jsx)(s.strong,{children:"grupos visibles"})," \u2192 la similitud es \xfatil y KNN probablemente funcionar\xe1 bien."]}),"\n",(0,i.jsxs)(s.li,{children:["Si las clases est\xe1n totalmente ",(0,i.jsx)(s.strong,{children:"mezcladas"})," \u2192 la distancia no ayuda y KNN no ser\xe1 un buen modelo."]}),"\n"]}),(0,i.jsx)(s.p,{children:"Este gr\xe1fico es lo m\xe1s parecido a \u201cver\u201d c\xf3mo funcionar\xe1 KNN antes de ejecutarlo."}),(0,i.jsx)(s.p,{children:"Ten en cuenta que:\n\ud83d\udc49 \u201cCon estas dos features, la similitud NO es \xfatil.\u201d\n\ud83d\udc49 \u201cSi a\xf1ades variables categ\xf3ricas transformadas, la cosa cambia.\u201d"})]}),"\n",(0,i.jsx)(s.p,{children:"Caracter\xedsticas importantes de KNN:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"No aprende una ecuaci\xf3n"}),", solo almacena los datos."]}),"\n",(0,i.jsx)(s.li,{children:"El entrenamiento es pr\xe1cticamente inmediato."}),"\n",(0,i.jsxs)(s.li,{children:["El coste computacional ocurre durante la ",(0,i.jsx)(s.strong,{children:"predicci\xf3n"}),", no durante el entrenamiento."]}),"\n",(0,i.jsxs)(s.li,{children:["Funciona especialmente bien cuando el dataset est\xe1 ",(0,i.jsx)(s.strong,{children:"limpio, bien escalado y sin ruido"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"ventajas",children:"Ventajas"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Muy f\xe1cil de entender"}),"."]}),"\n",(0,i.jsx)(s.li,{children:"Sirve como modelo base para comparar con modelos m\xe1s complejos."}),"\n",(0,i.jsx)(s.li,{children:"Capaz de capturar relaciones no lineales."}),"\n",(0,i.jsx)(s.li,{children:"Suele ofrecer buenos resultados si el preprocesamiento es correcto."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"limitaciones",children:"Limitaciones"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Depende completamente de las distancias"}),", as\xed que necesita:","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"escalado de variables,"}),"\n",(0,i.jsx)(s.li,{children:"ausencia de outliers muy fuertes,"}),"\n",(0,i.jsx)(s.li,{children:"buena codificaci\xf3n categ\xf3rica."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.li,{children:"Es lento cuando el dataset tiene miles o millones de registros (tiene que calcular muchas distancias)."}),"\n",(0,i.jsx)(s.li,{children:"Sensible al ruido: un solo vecino \u201craro\u201d puede afectar la predicci\xf3n."}),"\n",(0,i.jsxs)(s.li,{children:["Elegir un buen valor de ",(0,i.jsx)(s.strong,{children:"k"})," es crucial (muy peque\xf1o \u2192 sobreajuste, muy grande \u2192 subajuste)."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"importancia-del-preprocesamiento",children:"Importancia del preprocesamiento"}),"\n",(0,i.jsxs)(s.p,{children:["KNN es uno de los modelos m\xe1s sensibles al preprocesamiento de los datos.\nEsto se debe a que ",(0,i.jsx)(s.strong,{children:"todas sus decisiones se basan en distancias"}),", y cualquier detalle en las features puede alterar completamente el resultado."]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Aspecto"}),(0,i.jsx)(s.th,{children:"\xbfEs necesario?"}),(0,i.jsx)(s.th,{children:"Explicaci\xf3n"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Escalado (StandardScaler / MinMax)"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"\u2714 Obligatorio"})}),(0,i.jsx)(s.td,{children:"Como KNN mide distancias, si una feature tiene valores muy grandes dominar\xe1 la distancia total. Escalado imprescindible."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Codificaci\xf3n de categ\xf3ricas"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"\u2714 S\xed"})}),(0,i.jsxs)(s.td,{children:["KNN no trabaja con texto. Se requiere ",(0,i.jsx)(s.strong,{children:"One-Hot Encoding"})," cuando no hay orden. ",(0,i.jsx)(s.strong,{children:"Label Encoding puede distorsionar"})," porque introduce un orden artificial entre categor\xedas."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Tratamiento de outliers"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"\u2714 Muy recomendado"})}),(0,i.jsx)(s.td,{children:"KNN es extremadamente sensible a outliers. Un valor extremo puede alterar todas las distancias y cambiar las predicciones."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Eliminar nulos o imputarlos"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"\u2714 S\xed"})}),(0,i.jsx)(s.td,{children:"KNN no permite nulos. Imputar es preferible a eliminar datos, ya que suele ser sensible al tama\xf1o de dataset."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Eliminar columnas irrelevantes"})}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"\u2714 Muy recomendado"})}),(0,i.jsx)(s.td,{children:"Cada feature influye en la distancia. Variables in\xfatiles generan ruido y empeoran la precisi\xf3n."})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"implementaci\xf3n-en-python",children:"Implementaci\xf3n en Python"}),"\n",(0,i.jsxs)(s.p,{children:["Partimos del punto en el que el ",(0,i.jsx)(s.strong,{children:"preprocesamiento ya est\xe1 completado"}),".\nRecuerda que en el ",(0,i.jsx)(s.strong,{children:"Paso 2"})," del preprocesamiento divid\xedamos el dataset en entrenamiento y prueba:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"X_train, X_test, y_train, y_test = train_test_split(\n    X,\n    y,\n    test_size=0.2,\n    random_state=42,\n    stratify=y\n)\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Y en el ",(0,i.jsx)(s.strong,{children:"Paso 3"})," aplic\xe1bamos todas las transformaciones necesarias \xfanicamente sobre el conjunto de ",(0,i.jsx)(s.em,{children:"train"})," (imputaci\xf3n de nulos, codificaci\xf3n, escalado\u2026) y luego las traslad\xe1bamos a ",(0,i.jsx)(s.em,{children:"test"})," utilizando los par\xe1metros aprendidos."]}),"\n",(0,i.jsxs)(s.p,{children:["En este apartado asumimos que ",(0,i.jsx)(s.strong,{children:"todo ese proceso ya est\xe1 hecho"}),", por lo que comenzamos directamente a trabajar con los datos ",(0,i.jsx)(s.strong,{children:"ya preprocesados"})," para entrenar y evaluar el modelo KNN."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h3,{id:"paso-1-b\xfasqueda-de-la-mejor-k",children:["Paso 1. B\xfasqueda de la mejor ",(0,i.jsx)(s.em,{children:"k"})]}),"\n",(0,i.jsxs)(s.p,{children:["Antes de entrenar definitivamente el modelo KNN, necesitamos elegir el valor \xf3ptimo de ",(0,i.jsx)(s.strong,{children:"k"}),", es decir, cu\xe1ntos vecinos tendr\xe1 en cuenta el algoritmo para tomar decisiones. Recuerda que la elecci\xf3n de ",(0,i.jsx)(s.em,{children:"k"})," influye directamente en el rendimiento del modelo."]}),"\n",(0,i.jsxs)(s.p,{children:["Para determinar qu\xe9 valor funciona mejor, utilizaremos un proceso llamado ",(0,i.jsx)(s.strong,{children:"validaci\xf3n cruzada"})," (",(0,i.jsx)(s.em,{children:"cross-validation"}),").\nAqu\xed veremos dos m\xe9todos:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Opci\xf3n 1: 5-Fold Cross-Validation"})," (b\xfasqueda manual de k)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Opci\xf3n 2: GridSearchCV"})," (m\xe9todo m\xe1s avanzado)"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h4,{id:"opci\xf3n-1-5-fold-cross-validation",children:"Opci\xf3n 1. 5-Fold Cross-Validation"}),"\n",(0,i.jsxs)(s.p,{children:["La ",(0,i.jsx)(s.strong,{children:"validaci\xf3n cruzada"})," es una t\xe9cnica para evaluar un modelo de manera m\xe1s fiable y evitar depender de una \xfanica divisi\xf3n train/test."]}),"\n",(0,i.jsx)(s.p,{children:"En lugar de entrenar el modelo una sola vez, hacemos:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Dividir el conjunto de entrenamiento (X_train) en ",(0,i.jsx)(s.strong,{children:"5 subconjuntos"})," (folds)."]}),"\n",(0,i.jsx)(s.li,{children:"Entrenar el modelo con 4 de ellos."}),"\n",(0,i.jsx)(s.li,{children:"Validar con el fold restante."}),"\n",(0,i.jsx)(s.li,{children:"Repetir el proceso cambiando el fold de validaci\xf3n hasta completar las 5 combinaciones."}),"\n",(0,i.jsxs)(s.li,{children:["Calcular la ",(0,i.jsx)(s.strong,{children:"media de accuracy"})," obtenida."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Esto nos da una estimaci\xf3n mucho m\xe1s robusta del rendimiento del modelo."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"5 Fold",src:n(22896).A+"",width:"800",height:"400"})}),"\n",(0,i.jsx)(s.p,{children:"El objetivo es:"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:["Probar varios valores de ",(0,i.jsx)(s.strong,{children:"k"}),", medir su rendimiento medio con cross-validation y elegir el que obtenga el mejor resultado."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h5,{id:"aplicaci\xf3n-de-5-fold-cv-con-varias-k",children:"Aplicaci\xf3n de 5-FOLD CV con varias k"}),"\n",(0,i.jsx)(s.p,{children:"A continuaci\xf3n se muestra un ejemplo desde k = 1 hasta k = 30:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"from sklearn.model_selection import cross_val_score\nfrom sklearn.neighbors import KNeighborsClassifier\nimport numpy as np\n\n# Rango de valores de k que queremos probar (del 1 al 30)\nk_values = range(1, 31)\n\n# Aqu\xed iremos guardando la accuracy media de cada k\naccuracy_scores = []\n\n# Recorremos todos los posibles valores de k\nfor k in k_values:\n    # Creamos un modelo KNN con ese valor de k\n    knn = KNeighborsClassifier(n_neighbors=k)\n    \n    # Aplicamos validaci\xf3n cruzada (5-fold) solo sobre el conjunto de entrenamiento\n    #   - cross_val_score entrena y valida el modelo 5 veces (cv=5)\n    #   - devuelve un array con 5 valores de accuracy (uno por cada fold)\n    scores = cross_val_score(knn, X_train, y_train, cv=5)\n    \n    # Calculamos la media de esos 5 valores y la guardamos\n    accuracy_scores.append(scores.mean())\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Despu\xe9s de ejecutar este c\xf3digo, habremos evaluado ",(0,i.jsx)(s.strong,{children:"30 modelos diferentes"}),", uno por cada valor de ",(0,i.jsx)(s.em,{children:"k"})," (desde 1 hasta 30).\nPara cada uno de esos modelos se realiza un proceso llamado ",(0,i.jsx)(s.strong,{children:"5-Fold Cross-Validation"}),", que funciona as\xed:"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["El conjunto de entrenamiento (",(0,i.jsx)(s.em,{children:"X_train_scaled"}),", ",(0,i.jsx)(s.em,{children:"y_train"}),") se divide en ",(0,i.jsx)(s.strong,{children:"5 partes iguales"})," llamadas ",(0,i.jsx)(s.em,{children:"folds"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Para un valor concreto de k:","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Se entrena el modelo ",(0,i.jsx)(s.strong,{children:"5 veces"}),", cada vez utilizando 4 folds para entrenar y ",(0,i.jsx)(s.strong,{children:"1 fold distinto"})," para validar."]}),"\n",(0,i.jsx)(s.li,{children:"En cada una de esas 5 repeticiones se obtiene una accuracy diferente."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Al final, calculamos la ",(0,i.jsx)(s.strong,{children:"media"})," de esas 5 accuracies.\nEsa media representa lo bien que funciona ese valor de k."]}),"\n",(0,i.jsxs)(s.li,{children:["Repetimos el proceso para ",(0,i.jsx)(s.strong,{children:"cada k"})," del rango 1\u201330."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Este procedimiento nos da una estimaci\xf3n mucho m\xe1s fiable que entrenar el modelo una sola vez, ya que utiliza diferentes particiones del conjunto de entrenamiento y reduce el riesgo de depender de un \xfanico train/validation."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h5,{id:"gr\xe1fico-accuracy-vs-k",children:"Gr\xe1fico: Accuracy vs k"}),"\n",(0,i.jsxs)(s.p,{children:["Una vez obtenida la accuracy media para cada valor de ",(0,i.jsx)(s.strong,{children:"k"})," mediante 5-Fold Cross-Validation, es muy \xfatil visualizar c\xf3mo cambia esa accuracy en funci\xf3n de k.\nEste gr\xe1fico nos permite ver:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"cu\xe1ndo el modelo mejora,"}),"\n",(0,i.jsx)(s.li,{children:"cu\xe1ndo deja de mejorar,"}),"\n",(0,i.jsx)(s.li,{children:"y cu\xe1ndo empieza a empeorar si usamos un k demasiado grande."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["En lugar de representar el error, esta vez representamos directamente la ",(0,i.jsx)(s.strong,{children:"accuracy media"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'import matplotlib.pyplot as plt\n\nplt.figure(figsize=(10, 5))\nplt.plot(k_values, accuracy_scores, marker=\'o\')\nplt.xlabel("Valor de k")\nplt.ylabel("Accuracy medio (5-Fold)")\nplt.title("Accuracy vs k (5-Fold Cross-Validation)")\nplt.grid(True)\nplt.show()\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Accuracy 5-Fold",src:n(34745).A+"",width:"855",height:"470"})}),"\n",(0,i.jsx)(s.p,{children:"El comportamiento t\xedpico de la accuracy es:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"k peque\xf1o \u2192 accuracy baja"}),"\nEl modelo usa pocos vecinos y es demasiado sensible al ruido."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Zona intermedia \u2192 accuracy m\xe1xima"}),"\nAqu\xed el modelo logra un equilibrio entre simplicidad y estabilidad.\nEste suele ser el ",(0,i.jsx)(s.strong,{children:"mejor valor de k"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"k grande \u2192 la accuracy vuelve a bajar"}),"\nEl modelo empieza a mezclar demasiados vecinos y las clases se confunden."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h5,{id:"selecci\xf3n-de-la-mejor-k",children:["Selecci\xf3n de la mejor ",(0,i.jsx)(s.em,{children:"k"})]}),"\n",(0,i.jsx)(s.p,{children:"El valor \xf3ptimo de k es aquel que:"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"consigue la mayor accuracy media en validaci\xf3n cruzada"}),",\nsin que la curva empiece a caer despu\xe9s."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"En otras palabras:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["buscamos el ",(0,i.jsx)(s.strong,{children:"pico m\xe1ximo"})," del gr\xe1fico,"]}),"\n",(0,i.jsx)(s.li,{children:"pero siempre comprobando que no sea un valor extremo (por ejemplo, k=1 suele dar accuracy artificialmente alta en train y mala en test)."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"En c\xf3digo, podemos recuperar el valor as\xed:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'best_k = k_values[np.argmax(accuracy_scores)]\nprint("Mejor valor de k:", best_k)\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h4,{id:"opci\xf3n-2-gridsearchcv",children:"Opci\xf3n 2. GridSearchCV"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"GridSearchCV"})," es una herramienta de scikit-learn que ",(0,i.jsx)(s.strong,{children:"automatiza todo el proceso de b\xfasqueda de hiperpar\xe1metros"}),", incluido el valor \xf3ptimo de ",(0,i.jsx)(s.em,{children:"k"})," en KNN.",(0,i.jsx)(s.br,{}),"\n","Hace exactamente lo mismo que el m\xe9todo manual anterior, pero de manera m\xe1s c\xf3moda y estructurada:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Prueba autom\xe1ticamente una lista de valores de k."}),"\n",(0,i.jsx)(s.li,{children:"Aplica validaci\xf3n cruzada para cada uno (por ejemplo, 5-fold)."}),"\n",(0,i.jsx)(s.li,{children:"Calcula la m\xe9trica media (accuracy por defecto)."}),"\n",(0,i.jsx)(s.li,{children:"Devuelve el mejor modelo y el mejor valor de k."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Es decir:"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"GridSearchCV = Validaci\xf3n cruzada + B\xfasqueda de hiperpar\xe1metros en un solo paso."})}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"from sklearn.model_selection import GridSearchCV\nfrom sklearn.neighbors import KNeighborsClassifier\n\n# Definimos los valores de k que queremos probar\nparam_grid = {\n    'n_neighbors': range(1, 31)\n}\n\n# Creamos el modelo base\nknn = KNeighborsClassifier()\n\n# Configuramos GridSearchCV:\n# - knn: el modelo\n# - param_grid: valores de k a probar\n# - cv=5: validaci\xf3n cruzada 5-fold\n# - scoring='accuracy': m\xe9trica que optimiza\ngrid = GridSearchCV(\n    estimator=knn,\n    param_grid=param_grid,\n    cv=5,\n    scoring='accuracy'\n)\n\n# Entrenamos GridSearchCV con el conjunto de entrenamiento preprocesado\ngrid.fit(X_train, y_train)\n\n# Extraemos el mejor valor de k\nprint(\"Mejor k encontrado:\", grid.best_params_['n_neighbors'])\n\n# Extraemos el mejor modelo ya entrenado\nknn_best = grid.best_estimator_\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Ventajas de GridSearchCV"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Automatiza la validaci\xf3n cruzada."}),"\n",(0,i.jsx)(s.li,{children:"Devuelve directamente el modelo \xf3ptimo."}),"\n",(0,i.jsx)(s.li,{children:"Facilita probar m\xfaltiples hiperpar\xe1metros (no solo k)."}),"\n",(0,i.jsx)(s.li,{children:"Muy \xfatil cuando los modelos son m\xe1s complejos (SVM, Random Forest, etc.)."}),"\n"]}),"\n",(0,i.jsxs)(s.admonition,{title:"Nota sobre GridSearchCV",type:"info",children:[(0,i.jsxs)(s.p,{children:["Si utilizas ",(0,i.jsx)(s.strong,{children:"GridSearchCV"}),", no necesitas realizar el ",(0,i.jsx)(s.strong,{children:"Paso 2 (Entrenamiento con la mejor k)"}),"."]}),(0,i.jsxs)(s.p,{children:["\xbfPor qu\xe9?",(0,i.jsx)(s.br,{}),"\n","Porque el m\xe9todo:"]}),(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Prueba todos los valores de k especificados."}),"\n",(0,i.jsx)(s.li,{children:"Aplica validaci\xf3n cruzada para cada uno."}),"\n",(0,i.jsx)(s.li,{children:"Selecciona el mejor valor de k."}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Entrena autom\xe1ticamente el modelo final"})," con ese mejor valor usando todo el conjunto de entrenamiento."]}),"\n"]}),(0,i.jsx)(s.p,{children:"El modelo final ya est\xe1 disponible en:"}),(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"knn_best = grid.best_estimator_\n"})}),(0,i.jsxs)(s.p,{children:["Este modelo se encuentra ",(0,i.jsx)(s.strong,{children:"totalmente entrenado y listo para predecir"}),", por lo que no es necesario volver a llamarlo a ",(0,i.jsx)(s.code,{children:"fit()"}),"."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h3,{id:"paso-2-entrenamiento-con-la-mejor-k",children:["Paso 2. Entrenamiento con la mejor ",(0,i.jsx)(s.em,{children:"k"})]}),"\n",(0,i.jsxs)(s.p,{children:["Una vez identificado el valor \xf3ptimo de ",(0,i.jsx)(s.strong,{children:"k"})," mediante validaci\xf3n cruzada, el siguiente paso es entrenar el modelo KNN definitivo utilizando ",(0,i.jsx)(s.strong,{children:"todo el conjunto de entrenamiento preprocesado"})," (",(0,i.jsx)(s.code,{children:"X_train"})," y ",(0,i.jsx)(s.code,{children:"y_train"}),")."]}),"\n",(0,i.jsx)(s.p,{children:"La l\xf3gica es simple:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Elegimos ",(0,i.jsx)(s.code,{children:"best_k"})," (el valor de k que obtuvo la mayor accuracy media en el paso anterior)."]}),"\n",(0,i.jsx)(s.li,{children:"Creamos un modelo KNN con ese valor."}),"\n",(0,i.jsxs)(s.li,{children:["Lo entrenamos utilizando ",(0,i.jsx)(s.strong,{children:"todos los datos de entrenamiento"}),", no solo los folds."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"De esta forma aprovechamos al m\xe1ximo la informaci\xf3n disponible antes de evaluar en test."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# Entrenar el modelo definitivo con toda la parte de entrenamiento\nfrom sklearn.neighbors import KNeighborsClassifier\n\nknn_final = KNeighborsClassifier(n_neighbors=best_k)\nknn_final.fit(X_train, y_train)\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"\xbfPor qu\xe9 entrenamos de nuevo?"})}),"\n",(0,i.jsxs)(s.p,{children:["Durante la validaci\xf3n cruzada, el modelo se entren\xf3 ",(0,i.jsx)(s.strong,{children:"muchas veces"}),", pero:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["cada entrenamiento us\xf3 solo ",(0,i.jsx)(s.strong,{children:"4/5"})," del conjunto de entrenamiento,"]}),"\n",(0,i.jsx)(s.li,{children:"y los folds iban cambiando."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Ahora que ya sabemos cu\xe1l es el mejor ",(0,i.jsx)(s.em,{children:"k"}),", debemos entrenar el modelo final usando ",(0,i.jsx)(s.strong,{children:"el 100% del conjunto de entrenamiento"}),", para que aprenda con la m\xe1xima cantidad de datos posible antes de evaluar en test."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Resultado de este paso"})}),"\n",(0,i.jsxs)(s.p,{children:["Ahora ya tenemos un modelo KNN completamente entrenado con el mejor valor de ",(0,i.jsx)(s.em,{children:"k"}),", listo para:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["hacer predicciones sobre ",(0,i.jsx)(s.code,{children:"X_test"}),","]}),"\n",(0,i.jsx)(s.li,{children:"y evaluar su rendimiento con las m\xe9tricas del siguiente apartado."}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"paso-3-evaluaci\xf3n-mediante-m\xe9tricas",children:"Paso 3. Evaluaci\xf3n mediante m\xe9tricas"}),"\n",(0,i.jsxs)(s.p,{children:["Una vez entrenado el modelo con el mejor valor de ",(0,i.jsx)(s.strong,{children:"k"}),", el siguiente paso es evaluar su rendimiento en el conjunto de ",(0,i.jsx)(s.strong,{children:"test"}),".\nPara ello utilizaremos las m\xe9tricas m\xe1s importantes en problemas de ",(0,i.jsx)(s.strong,{children:"clasificaci\xf3n"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Accuracy"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Matriz de confusi\xf3n"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Precision"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Recall"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"F1-score"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Support"})}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Estas m\xe9tricas nos permiten saber ",(0,i.jsx)(s.strong,{children:"qu\xe9 tan bien est\xe1 funcionando el modelo"}),", si se est\xe1 equivocando m\xe1s en una clase que en otra, y si tiene problemas de equilibrio entre clases."]}),"\n",(0,i.jsx)(s.p,{children:"Antes de evaluar el modelo, necesitamos generar las predicciones sobre el conjunto de test:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"y_pred = knn_final.predict(X_test)\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h4,{id:"accuracy",children:"Accuracy"}),"\n",(0,i.jsxs)(s.p,{children:["La ",(0,i.jsx)(s.strong,{children:"accuracy"})," mide el porcentaje de predicciones correctas sobre el total:"]}),"\n",(0,i.jsx)(s.span,{className:"katex-display",children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mtext,{children:"accuracy"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsxs)(s.mfrac,{children:[(0,i.jsx)(s.mtext,{children:"aciertos"}),(0,i.jsx)(s.mtext,{children:"total"})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{accuracy} = \\frac{\\text{aciertos}}{\\text{total}}"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"accuracy"})}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"2.0309em",verticalAlign:"-0.686em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(s.span,{className:"mfrac",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsxs)(s.span,{className:"vlist",style:{height:"1.3449em"},children:[(0,i.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(s.span,{className:"mord",children:(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"total"})})})]}),(0,i.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(s.span,{className:"mord",children:(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"aciertos"})})})]})]}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(s.span,{})})})]})}),(0,i.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'from sklearn.metrics import accuracy_score\n\ny_pred = knn_final.predict(X_test)\naccuracy = accuracy_score(y_test, y_pred)\n\nprint("Accuracy:", accuracy)\n'})}),"\n",(0,i.jsx)(s.p,{children:"Salida conseguida:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Accuracy: 0.8549618320610687\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Interpretaci\xf3n"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Accuracy muy alta (\u2248 0.95 o superior)"})," \u2192 puede parecer excelente, pero hay que tener cuidado: podr\xeda indicar sobreajuste (el modelo memoriza el entrenamiento y no generaliza bien), o un fuerte desbalanceo de clases (el modelo acierta porque predice siempre la clase mayoritaria)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Accuracy alta (\u2248 0.85 - 0.95)"})," \u2192 indica buen rendimiento global, pero no garantiza que el modelo funcione bien para ",(0,i.jsx)(s.em,{children:"todas"})," las clases."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Accuracy moderada (\u2248 0.70 \u2013 0.85)"})," \u2192 el modelo capta parte del patr\xf3n, pero a\xfan puede estar fallando en clases minoritarias o con datos ruidosos."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Accuracy baja (< 0.70)"})," \u2192 el modelo no est\xe1 identificando correctamente la estructura del problema o las clases est\xe1n muy mezcladas."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["\ud83d\udca1 ",(0,i.jsx)(s.strong,{children:"Pero cuidado:"}),"\nLa accuracy por s\xed sola puede ser enga\xf1osa, especialmente si las clases est\xe1n desbalanceadas o si el modelo tiende a predecir siempre la clase mayoritaria."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h4,{id:"matriz-de-confusi\xf3n",children:"Matriz de confusi\xf3n"}),"\n",(0,i.jsxs)(s.p,{children:["La ",(0,i.jsx)(s.strong,{children:"matriz de confusi\xf3n"})," es una herramienta fundamental en clasificaci\xf3n, porque permite ver exactamente ",(0,i.jsx)(s.strong,{children:"c\xf3mo"})," y ",(0,i.jsx)(s.strong,{children:"d\xf3nde"})," se equivoca el modelo.\nNo solo indica cu\xe1ntos aciertos tiene, sino ",(0,i.jsx)(s.em,{children:"qu\xe9 tipo de errores"})," comete:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"TP (True Positives)"})," \u2192 predijo positivo y era positivo"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"TN (True Negatives)"})," \u2192 predijo negativo y era negativo"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"FP (False Positives)"})," \u2192 predijo positivo pero era negativo"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"FN (False Negatives)"})," \u2192 predijo negativo pero era positivo"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Representarla como un ",(0,i.jsx)(s.strong,{children:"mapa de calor"})," facilita enormemente la interpretaci\xf3n."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Calcular la matriz de confusi\xf3n\ncm = confusion_matrix(y_test, y_pred)\n\n# Representaci\xf3n como mapa de calor\nplt.figure(figsize=(6, 4))\nsns.heatmap(cm, annot=True, fmt="d", cmap="Blues",\n            xticklabels=["Predicci\xf3n: 0", "Predicci\xf3n: 1"],\n            yticklabels=["Real: 0", "Real: 1"])\nplt.title("Matriz de Confusi\xf3n")\nplt.xlabel("Predicciones")\nplt.ylabel("Valores reales")\nplt.show()\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"C\xf3mo interpretar el mapa de calor"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(45883).A+"",width:"510",height:"393"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Interpretaci\xf3n general:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"TN (arriba izquierda)"}),": n\xfamero de negativos bien clasificados"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"TP (abajo derecha)"}),": n\xfamero de positivos bien clasificados"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"FP (arriba derecha)"}),": el modelo predijo positivo pero era negativo","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"error t\xedpico cuando el modelo es demasiado \u201coptimista\u201d"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"FN (abajo izquierda)"}),": el modelo predijo negativo pero era positivo","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"error cr\xedtico en muchos problemas (fraude, enfermedad, fallos, etc.)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"\xbfQu\xe9 nos indica una buena matriz de confusi\xf3n?"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Los n\xfameros grandes deben estar en la ",(0,i.jsx)(s.strong,{children:"diagonal principal"})," (TN y TP)."]}),"\n",(0,i.jsxs)(s.li,{children:["Los valores ",(0,i.jsx)(s.strong,{children:"fuera de la diagonal"})," deben ser lo m\xe1s peque\xf1os posible."]}),"\n",(0,i.jsxs)(s.li,{children:["Muchos ",(0,i.jsx)(s.strong,{children:"FN"})," \u2192 el modelo est\xe1 \u201cdejando pasar\u201d positivos \u2192 problema si queremos detectar casos sensibles (fraudes, enfermedades\u2026)."]}),"\n",(0,i.jsxs)(s.li,{children:["Muchos ",(0,i.jsx)(s.strong,{children:"FP"})," \u2192 el modelo dispara demasiadas alarmas falsas."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"\ud83d\udca1 Conclusi\xf3n"})}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:["La matriz de confusi\xf3n no solo dice \u201ccu\xe1nto acierta el modelo\u201d,\nsino ",(0,i.jsx)(s.strong,{children:"en qu\xe9 acierta y en qu\xe9 falla"}),", lo cual es esencial para entender si el modelo es realmente \xfatil para la tarea."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"flujo-recomendado-en-un-problema-de-knn",children:"Flujo recomendado en un problema de KNN"}),"\n",(0,i.jsxs)(s.p,{children:["El proceso para resolver un problema de clasificaci\xf3n con ",(0,i.jsx)(s.strong,{children:"K-Nearest Neighbors (KNN)"})," sigue una serie de pasos muy claros. El rendimiento de KNN depende fuertemente del ",(0,i.jsx)(s.strong,{children:"preprocesamiento"})," y de la ",(0,i.jsx)(s.strong,{children:"elecci\xf3n de k"}),", por lo que un flujo bien estructurado es fundamental."]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Paso"}),(0,i.jsx)(s.th,{children:"\xbfQu\xe9 se hace?"}),(0,i.jsx)(s.th,{children:"\xbfPor qu\xe9 es importante?"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Paso 1. EDA"})}),(0,i.jsx)(s.td,{children:"Analizar cada variable, ver distribuciones, relaci\xf3n con la target, detectar outliers."}),(0,i.jsx)(s.td,{children:"KNN depende totalmente de las distancias: valores extremos o mezclados afectan mucho al modelo."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Paso 2. Preprocesamiento"})}),(0,i.jsxs)(s.td,{children:["Imputaci\xf3n de nulos, One-Hot Encoding, ",(0,i.jsx)(s.strong,{children:"escalado"}),", eliminaci\xf3n de columnas irrelevantes, tratamiento de outliers."]}),(0,i.jsx)(s.td,{children:"KNN es extremadamente sensible a diferencias de escala y ruido. Buen prepro = buen modelo."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Paso 3. B\xfasqueda de la mejor k"})}),(0,i.jsx)(s.td,{children:"Probar varios valores de k usando validaci\xf3n cruzada o GridSearchCV."}),(0,i.jsx)(s.td,{children:"Elegir k correctamente evita overfitting (k peque\xf1o) y underfitting (k grande)."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Paso 4. Entrenamiento del modelo final"})}),(0,i.jsx)(s.td,{children:"Entrenar un KNN con el mejor valor de k usando todo el conjunto de entrenamiento."}),(0,i.jsx)(s.td,{children:"Se obtiene la versi\xf3n definitiva del modelo, lista para evaluar."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Paso 5. An\xe1lisis overfitting / underfitting"})}),(0,i.jsxs)(s.td,{children:["Comparar accuracy en ",(0,i.jsx)(s.strong,{children:"train"})," y ",(0,i.jsx)(s.strong,{children:"test"}),". Seg\xfan el resultado obtenido, deber\xedamos buscar una k mejor (no eber\xedamos tener este problema si usamos GridSearch)"]}),(0,i.jsx)(s.td,{children:"k muy peque\xf1o \u2192 overfitting. k muy grande \u2192 underfitting."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Paso 6. M\xe9tricas de evaluaci\xf3n"})}),(0,i.jsx)(s.td,{children:"Accuracy y matriz de confusi\xf3n."}),(0,i.jsx)(s.td,{children:"Permiten medir c\xf3mo rinde realmente KNN en datos nuevos y si confunde clases."})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"actividad-de-seguimiento-retenci\xf3n-de-empleados",children:"Actividad de Seguimiento: Retenci\xf3n de empleados"}),"\n",(0,i.jsxs)(s.p,{children:["El objetivo de la actividad es realizar el ",(0,i.jsx)(s.strong,{children:"Preprocesamiento"})," sobre el dataset ",(0,i.jsx)(s.strong,{children:"Employee Attrition"})," y aplicar el modelo KNN sobre \xe9l, con el fin de ",(0,i.jsx)(s.strong,{children:"predecir la rotaci\xf3n laboral"})," (abandono o permanencia en la empresa)."]}),"\n",(0,i.jsx)(s.h3,{id:"dataset",children:"Dataset"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Fichero:"})," ",(0,i.jsx)(s.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(10198).A+"",children:(0,i.jsx)(s.code,{children:"employee.csv"})}),(0,i.jsx)(s.br,{}),"\n",(0,i.jsx)(s.strong,{children:"M\xe1s informaci\xf3n:"})," ",(0,i.jsx)(s.a,{href:"https://www.kaggle.com/datasets/pavansubhasht/ibm-hr-analytics-attrition-dataset",children:"Kaggle"}),(0,i.jsx)(s.br,{}),"\n",(0,i.jsx)(s.strong,{children:"Variable objetivo (target):"})," ",(0,i.jsx)(s.code,{children:"Attrition"})]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"Yes"})," \u2192 el empleado dej\xf3 la empresa"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"No"})," \u2192 el empleado sigue trabajando"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Nota"}),": recuerda que ya hiciste el EDA de este dataset, parte de ese an\xe1lisis para no repetir trabajo."]}),"\n",(0,i.jsx)(s.h3,{id:"entregable",children:"Entregable"}),"\n",(0,i.jsxs)(s.p,{children:["Un ",(0,i.jsx)(s.strong,{children:"cuaderno de Google Colab"})," con:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Preprocesamiento completo"})," del dataset"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Aplicaci\xf3n del modelo KNN"}),":","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"B\xfasqueda de la mejor k"}),"\n",(0,i.jsx)(s.li,{children:"Entrenamiento con la mejor k"}),"\n",(0,i.jsx)(s.li,{children:"Evaluaci\xf3n mediante m\xe9tricas"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Recuerda incluir ",(0,i.jsx)(s.strong,{children:"conclusiones y comentarios"})," sobre las tareas que vas realizando."]}),"\n"]})]})}function m(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var a=n(96540);const i={},r=a.createContext(i);function l(e){const s=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),a.createElement(r.Provider,{value:s},e.children)}},34745:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/accuracy-5fold-fba973743ae3a3213f296816e744090c.png"},45883:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/matriz-confusion-00af5b243a4b83d1922934ff08218b00.png"},63195:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/knn-ejemplo-3-dd5903f0c7b348d1cd888e7c5ce877d0.png"},98303:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/knn-ejemplo-7faf3854598bcd11d7c55889d949d6c3.png"}}]);