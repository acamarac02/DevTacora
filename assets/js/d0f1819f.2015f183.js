"use strict";(self.webpackChunkpmdm=self.webpackChunkpmdm||[]).push([[3412],{7910:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/files/ejemplo_decision_tree_iris-3639e240dd7db874a1fa3cc500890745.ipynb"},10179:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/tree-full-a049202bfe4d4fc00afc35bde62114a1.png"},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>o});var i=n(96540);const r={},a=i.createContext(r);function l(e){const s=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(a.Provider,{value:s},e.children)}},30528:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/importancia-features-ff045b95878df6453fe29d4cc8cc17d4.png"},35228:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/componentes-ad-028144142d7d1fa918c746974e55e358.png"},53388:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/arbol-decision","title":"Decision Trees","description":"Introducci\xf3n a los \xc1rboles de Decisi\xf3n aplicados a problemas de clasificaci\xf3n. C\xf3mo funcionan, c\xf3mo toman decisiones, sus hiperpar\xe1metros principales y c\xf3mo entrenarlos y evaluarlos en Python utilizando el dataset Iris.","source":"@site/docs/01_pia_2526/ut3_ml/5-aprendizaje-supervisado/1-clasificacion/2-arbol-decision.md","sourceDirName":"01_pia_2526/ut3_ml/5-aprendizaje-supervisado/1-clasificacion","slug":"/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/arbol-decision","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/arbol-decision","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Decision Trees","sidebar_position":2,"toc_max_heading_level":5,"description":"Introducci\xf3n a los \xc1rboles de Decisi\xf3n aplicados a problemas de clasificaci\xf3n. C\xf3mo funcionan, c\xf3mo toman decisiones, sus hiperpar\xe1metros principales y c\xf3mo entrenarlos y evaluarlos en Python utilizando el dataset Iris.","keywords":["\xc1rboles de Decisi\xf3n","Decision Tree","Clasificaci\xf3n","Machine Learning","scikit-learn","iris","reglas","hiperpar\xe1metros"]},"sidebar":"pia_2526_Sidebar","previous":{"title":"K-Nearest Neighbors (KNN)","permalink":"/DevTacora/docs/pia_2526/ut3_ml/aprendizaje-supervisado/clasificacion/knn"}}');var r=n(74848),a=n(28453);const l={title:"Decision Trees",sidebar_position:2,toc_max_heading_level:5,description:"Introducci\xf3n a los \xc1rboles de Decisi\xf3n aplicados a problemas de clasificaci\xf3n. C\xf3mo funcionan, c\xf3mo toman decisiones, sus hiperpar\xe1metros principales y c\xf3mo entrenarlos y evaluarlos en Python utilizando el dataset Iris.",keywords:["\xc1rboles de Decisi\xf3n","Decision Tree","Clasificaci\xf3n","Machine Learning","scikit-learn","iris","reglas","hiperpar\xe1metros"]},o=void 0,d={},c=[{value:"Ventajas principales",id:"ventajas-principales",level:2},{value:"Dataset de ejemplo: Iris",id:"dataset-de-ejemplo-iris",level:2},{value:"Funcionamiento y componentes",id:"funcionamiento-y-componentes",level:2},{value:"Componentes",id:"componentes",level:3},{value:"Split",id:"split",level:3},{value:"Criterios de divisi\xf3n: Gini",id:"criterios-de-divisi\xf3n-gini",level:3},{value:"Ejemplo funcionamiento",id:"ejemplo-funcionamiento",level:3},{value:"Importancia del preprocesamiento",id:"importancia-del-preprocesamiento",level:2},{value:"Ejemplo b\xe1sico en Python",id:"ejemplo-b\xe1sico-en-python",level:2},{value:"Visualizaci\xf3n del \xe1rbol",id:"visualizaci\xf3n-del-\xe1rbol",level:2},{value:"Profundidad e hiperpar\xe1metros",id:"profundidad-e-hiperpar\xe1metros",level:2},{value:"Profundidad: sobreajuste vs subajuste",id:"profundidad-sobreajuste-vs-subajuste",level:3},{value:"Hiperpar\xe1metros principales",id:"hiperpar\xe1metros-principales",level:3},{value:"<code>max_depth</code>",id:"max_depth",level:4},{value:"<code>min_samples_split</code>",id:"min_samples_split",level:4},{value:"<code>min_samples_leaf</code>",id:"min_samples_leaf",level:4},{value:"\xbfC\xf3mo saber si hay overfitting o underfitting?",id:"c\xf3mo-saber-si-hay-overfitting-o-underfitting",level:3},{value:"Ejemplo con ajuste de hiperpar\xe1metros",id:"ejemplo-con-ajuste-de-hiperpar\xe1metros",level:2},{value:"M\xe9tricas de evaluaci\xf3n",id:"m\xe9tricas-de-evaluaci\xf3n",level:2},{value:"An\xe1lisis de importancia",id:"an\xe1lisis-de-importancia",level:2},{value:"Automatizaci\xf3n b\xfasqueda hiperpar\xe1metros (GridSearchCV)",id:"automatizaci\xf3n-b\xfasqueda-hiperpar\xe1metros-gridsearchcv",level:2},{value:"Ejemplo de diccionario de par\xe1metros",id:"ejemplo-de-diccionario-de-par\xe1metros",level:3},{value:"C\xf3mo obtener el mejor \xe1rbol",id:"c\xf3mo-obtener-el-mejor-\xe1rbol",level:3},{value:"Actividad de seguimiento: Iris",id:"actividad-de-seguimiento-iris",level:2}];function t(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["Los ",(0,r.jsx)(s.strong,{children:"\xc1rboles de Decisi\xf3n"})," son uno de los modelos m\xe1s intuitivos y visuales de todo el Machine Learning.\nEn lugar de usar f\xf3rmulas o distancias, toman decisiones siguiendo ",(0,r.jsx)(s.strong,{children:"reglas tipo \u201csi\u2026 entonces\u2026\u201d"})," que dividen los datos en grupos cada vez m\xe1s homog\xe9neos."]}),"\n",(0,r.jsx)(s.p,{children:"Un \xc1rbol de Decisi\xf3n es un modelo que:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["divide el espacio de datos en regiones seg\xfan preguntas simples (",(0,r.jsx)(s.em,{children:"\u201c\xbfpetal_length \u2264 2.45?\u201d\u201d"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["llega a una ",(0,r.jsx)(s.strong,{children:"hoja"}),", donde asigna una clase (en clasificaci\xf3n)"]}),"\n",(0,r.jsx)(s.li,{children:"aprende autom\xe1ticamente qu\xe9 preguntas hacer y en qu\xe9 orden"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Se usan para ",(0,r.jsx)(s.strong,{children:"clasificaci\xf3n"})," (por ejemplo, qu\xe9 especie de flor es Iris) y para ",(0,r.jsx)(s.strong,{children:"regresi\xf3n"})," (predecir valores num\xe9ricos)."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(90695).A+"",width:"800",height:"400"})}),"\n",(0,r.jsx)(s.p,{children:"Un \xe1rbol decide paso a paso:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"\xbfLos ingresos del cliente superan los 50.000\u20ac?"}),"\n",(0,r.jsx)(s.li,{children:"Si no, \xbftiene m\xe1s de 30 a\xf1os?"}),"\n",(0,r.jsx)(s.li,{children:"Finalmente, \xbfa qu\xe9 clase pertenecen los datos que quedan?"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Cada decisi\xf3n crea una ",(0,r.jsx)(s.strong,{children:"rama"}),".\nEl camino completo desde la ra\xedz hasta la hoja es una ",(0,r.jsx)(s.strong,{children:"regla"})," del tipo:"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["\u201cSi ",(0,r.jsx)(s.em,{children:"age"})," > 30 entonces No compra\u201d."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Esto hace que el modelo sea f\xe1cil de explicar y de leer."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"ventajas-principales",children:"Ventajas principales"}),"\n",(0,r.jsx)(s.p,{children:"Los \xc1rboles de Decisi\xf3n destacan por:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Interpretabilidad:"})," puedes ver exactamente qu\xe9 reglas est\xe1 usando el modelo."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Visualizaci\xf3n sencilla:"})," se pueden dibujar y entender en segundos."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"No requieren escalado:"})," esto se debe a que no miden distancias, a diferencia de KNN o SVM."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Pueden capturar relaciones no lineales"})," sin esfuerzo."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Funcionan bien como modelo base"})," y preparan el camino para Random Forest y Gradient Boosting."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"dataset-de-ejemplo-iris",children:"Dataset de ejemplo: Iris"}),"\n",(0,r.jsxs)(s.p,{children:["En estos apuntes utilizaremos el ",(0,r.jsx)(s.strong,{children:"dataset Iris"}),", uno de los conjuntos de datos m\xe1s conocidos en Machine Learning por su simplicidad y porque permite visualizar muy bien c\xf3mo funcionan los modelos de clasificaci\xf3n."]}),"\n",(0,r.jsxs)(s.p,{children:["El dataset contiene ",(0,r.jsx)(s.strong,{children:"150 observaciones"}),", cada una correspondiente a una flor del g\xe9nero ",(0,r.jsx)(s.em,{children:"Iris"}),", y est\xe1 dividido en ",(0,r.jsx)(s.strong,{children:"3 especies"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Iris setosa"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Iris versicolor"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Iris virginica"})}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(58042).A+"",width:"700",height:"313"})}),"\n",(0,r.jsxs)(s.p,{children:["Cada flor est\xe1 descrita mediante ",(0,r.jsx)(s.strong,{children:"4 caracter\xedsticas num\xe9ricas"}),", medidas en cent\xedmetros:"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"sepal_length"}),(0,r.jsx)(s.th,{children:"sepal_width"}),(0,r.jsx)(s.th,{children:"petal_length"}),(0,r.jsx)(s.th,{children:"petal_width"}),(0,r.jsx)(s.th,{children:"species"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"5.1"}),(0,r.jsx)(s.td,{children:"3.5"}),(0,r.jsx)(s.td,{children:"1.4"}),(0,r.jsx)(s.td,{children:"0.2"}),(0,r.jsx)(s.td,{children:"setosa"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"7.0"}),(0,r.jsx)(s.td,{children:"3.2"}),(0,r.jsx)(s.td,{children:"4.7"}),(0,r.jsx)(s.td,{children:"1.4"}),(0,r.jsx)(s.td,{children:"versicolor"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"6.3"}),(0,r.jsx)(s.td,{children:"3.3"}),(0,r.jsx)(s.td,{children:"6.0"}),(0,r.jsx)(s.td,{children:"2.5"}),(0,r.jsx)(s.td,{children:"virginica"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"4.9"}),(0,r.jsx)(s.td,{children:"3.1"}),(0,r.jsx)(s.td,{children:"1.5"}),(0,r.jsx)(s.td,{children:"0.1"}),(0,r.jsx)(s.td,{children:"setosa"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"5.8"}),(0,r.jsx)(s.td,{children:"2.7"}),(0,r.jsx)(s.td,{children:"5.1"}),(0,r.jsx)(s.td,{children:"1.9"}),(0,r.jsx)(s.td,{children:"virginica"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"Estas variables son ideales para aprender \xc1rboles de Decisi\xf3n porque:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Las clases est\xe1n ",(0,r.jsx)(s.strong,{children:"bien separadas"}),", sobre todo usando ",(0,r.jsx)(s.em,{children:"petal_length"})," y ",(0,r.jsx)(s.em,{children:"petal_width"}),"."]}),"\n",(0,r.jsx)(s.li,{children:"Se pueden generar \xe1rboles simples que explican muy bien c\xf3mo funciona el modelo."}),"\n",(0,r.jsxs)(s.li,{children:["Todo el dataset es ",(0,r.jsx)(s.strong,{children:"num\xe9rico y no tiene valores nulos"}),", por lo que no requiere preprocesamiento."]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{type:"info",children:(0,r.jsxs)(s.p,{children:["En los ejemplos visuales utilizaremos \xfanicamente ",(0,r.jsx)(s.strong,{children:"petal_length"})," y ",(0,r.jsx)(s.strong,{children:"petal_width"})," para que se entienda claramente c\xf3mo el \xe1rbol divide los datos."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"funcionamiento-y-componentes",children:"Funcionamiento y componentes"}),"\n",(0,r.jsxs)(s.p,{children:["Los \xc1rboles de Decisi\xf3n funcionan dividiendo progresivamente los datos mediante ",(0,r.jsx)(s.strong,{children:"preguntas simples"}),", hasta que cada grupo final contiene observaciones mayoritariamente de una sola clase."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(35228).A+"",width:"2048",height:"1140"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"componentes",children:"Componentes"}),"\n",(0,r.jsx)(s.p,{children:"Un \xe1rbol est\xe1 formado por:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Nodo ra\xedz"}),". Es el punto de partida. Por este nodo pasan todos los elementos del dataset.",(0,r.jsx)(s.br,{}),"\n","Aqu\xed el modelo formula la ",(0,r.jsx)(s.strong,{children:"primera pregunta"}),", por ejemplo:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"\xbfpetal_length \u2264 2.45?\n"})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Ramas"}),". Cada respuesta a la condici\xf3n crea una rama:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Si se cumple \u2192 rama izquierda"}),"\n",(0,r.jsx)(s.li,{children:"Si NO se cumple \u2192 rama derecha"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Hojas"}),". Son los nodos finales. Aqu\xed el \xe1rbol ",(0,r.jsx)(s.strong,{children:"asigna la clase"})," (setosa, versicolor, virginica\u2026).",(0,r.jsx)(s.br,{}),"\n","En una hoja ya no se hacen m\xe1s preguntas."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"split",children:"Split"}),"\n",(0,r.jsxs)(s.p,{children:["Un ",(0,r.jsx)(s.em,{children:(0,r.jsx)(s.strong,{children:"split"})})," es simplemente una ",(0,r.jsx)(s.strong,{children:"divisi\xf3n del nodo actual"})," basada en una pregunta."]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"petal_width \u2264 1.75\n"})}),"\n",(0,r.jsx)(s.p,{children:"Cada split:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"reduce la mezcla de clases"}),"\n",(0,r.jsx)(s.li,{children:"produce nodos m\xe1s \u201cpuros\u201d"}),"\n",(0,r.jsx)(s.li,{children:"mejora la capacidad del modelo para separar especies"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"El \xe1rbol prueba muchos splits posibles y selecciona el que mejor separa las clases."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"criterios-de-divisi\xf3n-gini",children:"Criterios de divisi\xf3n: Gini"}),"\n",(0,r.jsxs)(s.p,{children:["Para decidir ",(0,r.jsx)(s.strong,{children:"qu\xe9 pregunta hacer"})," en cada nodo, el \xe1rbol prueba distintas posibles divisiones (",(0,r.jsx)(s.em,{children:"splits"}),") y elige la que mejor separa las clases.\nLa forma m\xe1s com\xfan de medir qu\xe9 tan \u201cbuena\u201d es una divisi\xf3n es usando la ",(0,r.jsx)(s.strong,{children:"impureza Gini"}),", que indica cu\xe1n mezcladas est\xe1n las clases dentro de un nodo."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Gini",src:n(59206).A+"",width:"1144",height:"922"})}),"\n",(0,r.jsxs)(s.p,{children:["La ",(0,r.jsx)(s.strong,{children:"impureza Gini"})," mide ",(0,r.jsx)(s.strong,{children:"lo mezcladas que est\xe1n las clases"})," en un nodo."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Gini = 0"})," \u2192 nodo completamente puro (solo una clase)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Gini alto"})," \u2192 mucha mezcla de clases"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"En el ejemplo de la imagen:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Nodo ra\xedz \u2192 ",(0,r.jsx)(s.code,{children:"gini = 0.667"})," (m\xe1xima mezcla: 50 setosa, 50 versicolor, 50 virginica)"]}),"\n",(0,r.jsxs)(s.li,{children:["Nodo naranja \u2192 ",(0,r.jsx)(s.code,{children:"gini = 0.0"})," (todas son setosa \u2192 pureza total)"]}),"\n",(0,r.jsxs)(s.li,{children:["Nodo verde \u2192 ",(0,r.jsx)(s.code,{children:"gini = 0.168"})," (casi todas versicolor)"]}),"\n",(0,r.jsxs)(s.li,{children:["Nodo morado \u2192 ",(0,r.jsx)(s.code,{children:"gini = 0.043"})," (casi todas virginica)"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["El \xe1rbol elige el split que ",(0,r.jsx)(s.strong,{children:"reduce m\xe1s la impureza"}),", es decir, el que consigue nodos hijos m\xe1s homog\xe9neos."]}),"\n",(0,r.jsx)(s.admonition,{type:"info",children:(0,r.jsxs)(s.p,{children:["Existe otro criterio de decisi\xf3n llamado ",(0,r.jsx)(s.strong,{children:"entrop\xeda"}),", que mide la mezcla de clases de forma similar, pero es m\xe1s avanzado.\nEn este curso solo usaremos ",(0,r.jsx)(s.strong,{children:"Gini"}),", que es m\xe1s f\xe1cil de interpretar y es el valor por defecto en scikit-learn."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"ejemplo-funcionamiento",children:"Ejemplo funcionamiento"}),"\n",(0,r.jsx)(s.p,{children:"Cuando llega una nueva observaci\xf3n, el \xe1rbol:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Empieza en la ",(0,r.jsx)(s.strong,{children:"ra\xedz"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Eval\xfaa la condici\xf3n del nodo:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Si se cumple \u2192 rama izquierda"}),"\n",(0,r.jsx)(s.li,{children:"Si no \u2192 rama derecha"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.li,{children:"Repite el proceso en los nodos siguientes."}),"\n",(0,r.jsxs)(s.li,{children:["Termina en una ",(0,r.jsx)(s.strong,{children:"hoja"}),", que contiene la clase predicha."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Es literalmente seguir un camino de decisiones ",(0,r.jsx)(s.strong,{children:"\u201csi\u2026 entonces\u2026\u201d"}),"."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"importancia-del-preprocesamiento",children:"Importancia del preprocesamiento"}),"\n",(0,r.jsx)(s.p,{children:"Aunque los \xc1rboles de Decisi\xf3n son modelos muy flexibles y funcionan bien incluso sin un preprocesamiento complejo, es importante conocer sus necesidades b\xe1sicas para evitar errores y obtener buenos resultados."}),"\n",(0,r.jsx)(s.p,{children:"Las reglas principales son las siguientes:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Aspecto"}),(0,r.jsx)(s.th,{children:"\xbfEs necesario?"}),(0,r.jsx)(s.th,{children:"Explicaci\xf3n"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Escalado (StandardScaler / MinMax)"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"\u274c No"})}),(0,r.jsx)(s.td,{children:"Los \xe1rboles no usan distancias, solo comparaciones del tipo \u201c\xbffeature \u2264 umbral?\u201d. La escala no afecta a las decisiones."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Codificaci\xf3n de categ\xf3ricas"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"\u2714 S\xed"})}),(0,r.jsxs)(s.td,{children:["Los \xe1rboles solo aceptan n\xfameros. Se puede usar ",(0,r.jsx)(s.strong,{children:"Label Encoding"})," o ",(0,r.jsx)(s.strong,{children:"One-Hot"}),", ambas funcionan porque el \xe1rbol ",(0,r.jsx)(s.strong,{children:"no interpreta orden"})," entre los valores."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Tratamiento de outliers"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"\u2714 A veces"})}),(0,r.jsx)(s.td,{children:"Los \xe1rboles son robustos, pero outliers muy extremos pueden causar splits raros. Menos cr\xedtico que en modelos basados en distancia."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Eliminar nulos o imputarlos"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"\u2714 S\xed"})}),(0,r.jsxs)(s.td,{children:["Los \xc1rboles de Decisi\xf3n de scikit-learn ",(0,r.jsx)(s.strong,{children:"no aceptan nulos"}),". Es obligatorio imputar o eliminar filas."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Eliminar columnas irrelevantes"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"\u2714 Recomendado"})}),(0,r.jsx)(s.td,{children:"Features totalmente in\xfatiles pueden generar splits basados en ruido. No es cr\xedtico, pero mejora la calidad del \xe1rbol."})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"ejemplo-b\xe1sico-en-python",children:"Ejemplo b\xe1sico en Python"}),"\n",(0,r.jsxs)(s.p,{children:["Para entender mejor c\xf3mo se comporta un \xc1rbol de Decisi\xf3n, puedes ejecutar este ejemplo pr\xe1ctico con el dataset ",(0,r.jsx)(s.strong,{children:"Iris"}),".\nEn \xe9l entrenamos un \xe1rbol ",(0,r.jsx)(s.strong,{children:"sin limitar profundidad"})," (muy grande \u2192 sobreajuste)."]}),"\n",(0,r.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,r.jsx)(s.strong,{children:"Puedes abrir el cuaderno aqu\xed:"}),"\n",(0,r.jsx)(s.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(7910).A+"",children:"Colab: \xc1rbol de Decisi\xf3n con Iris"})]}),"\n",(0,r.jsxs)(s.p,{children:["\ud83d\udc49 ",(0,r.jsx)(s.strong,{children:"Dataset utilizado:"}),"\n",(0,r.jsx)(s.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(97087).A+"",children:"iris.csv"})]}),"\n",(0,r.jsxs)(s.p,{children:["Este ejemplo ser\xe1 la base para entender los conceptos de ",(0,r.jsx)(s.strong,{children:"profundidad"}),", ",(0,r.jsx)(s.strong,{children:"sobreajuste"}),", ",(0,r.jsx)(s.strong,{children:"subajuste"}),", y los ",(0,r.jsx)(s.strong,{children:"hiperpar\xe1metros principales"})," que veremos a continuaci\xf3n."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"visualizaci\xf3n-del-\xe1rbol",children:"Visualizaci\xf3n del \xe1rbol"}),"\n",(0,r.jsxs)(s.p,{children:["Una de las ventajas m\xe1s grandes de los \xc1rboles de Decisi\xf3n es que podemos ",(0,r.jsx)(s.strong,{children:"ver el modelo completo"}),": todas sus decisiones, separaciones y clases finales. Esto hace que el aprendizaje sea muy visual y ayuda a entender c\xf3mo \u201cpiensa\u201d el \xe1rbol."]}),"\n",(0,r.jsxs)(s.p,{children:["Scikit-learn permite dibujar el \xe1rbol directamente con ",(0,r.jsx)(s.code,{children:"plot_tree"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'# Creamos una figura grande para que el \xe1rbol se vea bien\nplt.figure(figsize=(22, 12))\n\n# Dibujamos el \xe1rbol de decisi\xf3n entrenado\nplot_tree(\n    tree_full,                # El modelo ya entrenado\n    feature_names=features,   # Nombres de las columnas que estamos usando como X\n    class_names=iris["species"].unique(),  # Nombres de las clases (setosa, versicolor, virginica)\n    filled=True,              # Colorea los nodos seg\xfan la clase predominante\n    rounded=True,             # Esquinas redondeadas para mejorar la visualizaci\xf3n\n    fontsize=10               # Tama\xf1o del texto dentro del \xe1rbol\n)\n\n# Mostramos la figura en pantalla\nplt.show()\n'})}),"\n",(0,r.jsx)(s.p,{children:"Par\xe1metros importantes:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"feature_names"})," \u2192 nombres de las columnas usadas para X (features)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"class_names"})," \u2192 nombres de las clases"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"filled=True"})," \u2192 colorea los nodos seg\xfan la especie predominante"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"rounded=True"})," \u2192 mejora la legibilidad"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"\xc1rbol complejo",src:n(10179).A+"",width:"1725",height:"944"})}),"\n",(0,r.jsxs)(s.p,{children:["\ud83e\udde0 ",(0,r.jsx)(s.strong,{children:"Interpretaci\xf3n del gr\xe1fico"})]}),"\n",(0,r.jsx)(s.p,{children:"En cada nodo puedes ver:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"la condici\xf3n"})," que divide los datos (por ejemplo, ",(0,r.jsx)(s.code,{children:"petal_length \u2264 2.45"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"el valor de Gini"}),", que indica la mezcla de clases"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"cu\xe1ntas muestras"})," llegan a ese nodo (",(0,r.jsx)(s.code,{children:"samples"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"la distribuci\xf3n por clases"})," (",(0,r.jsx)(s.code,{children:"value = [...]"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["y la ",(0,r.jsx)(s.strong,{children:"clase asignada"})," si es una hoja"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Gracias a esto podemos seguir el flujo de decisiones desde la ra\xedz hasta cada hoja y entender ",(0,r.jsx)(s.strong,{children:"exactamente"})," por qu\xe9 el \xe1rbol clasifica una flor como ",(0,r.jsx)(s.em,{children:"setosa"}),", ",(0,r.jsx)(s.em,{children:"versicolor"})," o ",(0,r.jsx)(s.em,{children:"virginica"}),"."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"profundidad-e-hiperpar\xe1metros",children:"Profundidad e hiperpar\xe1metros"}),"\n",(0,r.jsxs)(s.p,{children:["Si observas el \xe1rbol que hemos generado en el ejemplo anterior, ver\xe1s que tiene ",(0,r.jsx)(s.strong,{children:"muchos nodos"}),", algunas hojas con ",(0,r.jsx)(s.strong,{children:"muy pocas muestras"})," (incluso 1 o 2) y un gran n\xfamero de decisiones encadenadas."]}),"\n",(0,r.jsxs)(s.p,{children:["Este tipo de \xe1rbol ocurre cuando dejamos que el modelo crezca ",(0,r.jsx)(s.strong,{children:"sin ning\xfan l\xedmite"}),", intentando capturar todos los detalles de los datos. El problema es que esto suele llevar a un comportamiento llamado ",(0,r.jsx)(s.strong,{children:"sobreajuste"})," (",(0,r.jsx)(s.em,{children:"overfitting"}),"): el modelo se adapta tanto al conjunto de entrenamiento que pierde capacidad para generalizar en datos nuevos."]}),"\n",(0,r.jsxs)(s.p,{children:["Para evitarlo, los \xc1rboles de Decisi\xf3n permiten ajustar distintos ",(0,r.jsx)(s.strong,{children:"hiperpar\xe1metros"}),", que act\xfaan como \u201cfrenos\u201d para controlar cu\xe1nto puede crecer el \xe1rbol."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"profundidad-sobreajuste-vs-subajuste",children:"Profundidad: sobreajuste vs subajuste"}),"\n",(0,r.jsxs)(s.p,{children:["La ",(0,r.jsx)(s.strong,{children:"profundidad"})," de un \xe1rbol es el n\xfamero de decisiones (splits) que hay desde la ra\xedz hasta una hoja."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"\xc1rbol muy profundo \u2192 Overfitting"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Aprende reglas demasiado espec\xedficas."}),"\n",(0,r.jsx)(s.li,{children:"Crea nodos con muy pocas muestras."}),"\n",(0,r.jsx)(s.li,{children:"Captura ruido en lugar de patrones."}),"\n",(0,r.jsx)(s.li,{children:"Es exactamente lo que ocurre en el \xe1rbol grande de la imagen."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"\xc1rbol poco profundo \u2192 Underfitting"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Modelo demasiado simple."}),"\n",(0,r.jsx)(s.li,{children:"No captura la estructura real de los datos."}),"\n",(0,r.jsx)(s.li,{children:"Su accuracy suele ser baja."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Objetivo:"}),"\nEncontrar un equilibrio: un \xe1rbol ",(0,r.jsx)(s.strong,{children:"lo bastante profundo"})," para aprender, pero ",(0,r.jsx)(s.strong,{children:"no tanto"})," como para memorizar."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"hiperpar\xe1metros-principales",children:"Hiperpar\xe1metros principales"}),"\n",(0,r.jsxs)(s.p,{children:["Estos hiperpar\xe1metros permiten controlar el tama\xf1o del \xe1rbol y evitar el sobreajuste. Son muy f\xe1ciles de entender si pensamos que todos ellos ",(0,r.jsx)(s.strong,{children:"limitan cu\xe1nto puede dividirse el \xe1rbol"}),"."]}),"\n",(0,r.jsx)(s.h4,{id:"max_depth",children:(0,r.jsx)(s.code,{children:"max_depth"})}),"\n",(0,r.jsxs)(s.p,{children:["Es el hiperpar\xe1metro m\xe1s importante. Controla la ",(0,r.jsx)(s.strong,{children:"profundidad m\xe1xima"})," del \xe1rbol."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Si es muy grande \u2192 \xe1rbol enorme \u2192 ",(0,r.jsx)(s.em,{children:"overfitting"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Si es muy peque\xf1o \u2192 \xe1rbol demasiado simple \u2192 ",(0,r.jsx)(s.em,{children:"underfitting"}),"."]}),"\n",(0,r.jsx)(s.li,{children:"Es la herramienta principal para equilibrar el modelo."}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"min_samples_split",children:(0,r.jsx)(s.code,{children:"min_samples_split"})}),"\n",(0,r.jsx)(s.p,{children:"N\xfamero m\xednimo de muestras necesarias para dividir un nodo."}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Si lo aumentas \u2192 el \xe1rbol solo divide cuando hay suficientes datos."}),"\n",(0,r.jsx)(s.li,{children:"Evita splits innecesarios o aleatorios."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo intuitivo:"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"\u201cNo dividas este nodo si solo hay 3 muestras, espera a tener m\xe1s.\u201d"}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"min_samples_leaf",children:(0,r.jsx)(s.code,{children:"min_samples_leaf"})}),"\n",(0,r.jsx)(s.p,{children:"N\xfamero m\xednimo de muestras que debe contener una hoja."}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Evita hojas con 1 o 2 datos (muy inestables)."}),"\n",(0,r.jsx)(s.li,{children:"Suaviza el \xe1rbol y reduce ruido."}),"\n",(0,r.jsx)(s.li,{children:"Mejora la generalizaci\xf3n."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo intuitivo:"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"\u201cNo permitas hojas que representen casos demasiado espec\xedficos.\u201d"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"c\xf3mo-saber-si-hay-overfitting-o-underfitting",children:"\xbfC\xf3mo saber si hay overfitting o underfitting?"}),"\n",(0,r.jsxs)(s.p,{children:["Es muy f\xe1cil usando ",(0,r.jsx)(s.strong,{children:"train vs test accuracy"}),". La regla general es esta:"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"OVERFITTING (sobreajuste)"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["El modelo aprende demasiado bien el conjunto de ",(0,r.jsx)(s.em,{children:"train"})," y generaliza mal."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Se\xf1ales claras:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Accuracy ",(0,r.jsx)(s.strong,{children:"muy alta en train"})]}),"\n",(0,r.jsxs)(s.li,{children:["Accuracy ",(0,r.jsx)(s.strong,{children:"claramente m\xe1s baja en test"})]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo t\xedpico:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Conjunto"}),(0,r.jsx)(s.th,{children:"Accuracy"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Train"}),(0,r.jsx)(s.td,{children:"1.00"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Test"}),(0,r.jsx)(s.td,{children:"0.88"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["\ud83d\udd0e Interpretaci\xf3n:",(0,r.jsx)(s.br,{}),"\n","El modelo ",(0,r.jsx)(s.strong,{children:"memoriza"})," los datos de entrenamiento (\xe1rbol muy profundo, nodos con 1 muestra, reglas muy espec\xedficas)."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"UNDERFITTING (subajuste)"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"Modelo demasiado simple: no aprende los patrones."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Se\xf1ales claras:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Accuracy ",(0,r.jsx)(s.strong,{children:"baja en train"})]}),"\n",(0,r.jsxs)(s.li,{children:["Accuracy ",(0,r.jsx)(s.strong,{children:"similarmente baja en test"})]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo t\xedpico:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Conjunto"}),(0,r.jsx)(s.th,{children:"Accuracy"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Train"}),(0,r.jsx)(s.td,{children:"0.75"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Test"}),(0,r.jsx)(s.td,{children:"0.72"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["\ud83d\udd0e Interpretaci\xf3n:",(0,r.jsx)(s.br,{}),"\n","El modelo no est\xe1 capturando bien la estructura de los datos (\xe1rbol demasiado peque\xf1o, ",(0,r.jsx)(s.code,{children:"max_depth"})," muy bajo)."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Buen ajuste (lo ideal)"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["Train y test tienen accuracy ",(0,r.jsx)(s.strong,{children:"parecida"})," y ",(0,r.jsx)(s.strong,{children:"ambas son razonablemente altas"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Conjunto"}),(0,r.jsx)(s.th,{children:"Accuracy"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Train"}),(0,r.jsx)(s.td,{children:"0.94"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Test"}),(0,r.jsx)(s.td,{children:"0.92"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["\u2714 No memoriza",(0,r.jsx)(s.br,{}),"\n","\u2714 Generaliza bien",(0,r.jsx)(s.br,{}),"\n","\u2714 No est\xe1 infraentrenado"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"C\xf3digo Python para detectar overfitting o underfitting"})}),"\n",(0,r.jsxs)(s.p,{children:["A nivel de c\xf3digo, podemos comprobar si hay overfitting o underfitting comparando la ",(0,r.jsx)(s.strong,{children:"accuracy en train"})," con la ",(0,r.jsx)(s.strong,{children:"accuracy en test"}),".\nPara ello basta con evaluar el modelo con ",(0,r.jsx)(s.code,{children:"score()"})," sobre ambos conjuntos:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'# Accuracy en entrenamiento y en test\nprint("Accuracy TRAIN:", tree_full.score(X_train, y_train))\nprint("Accuracy TEST :", tree_full.score(X_test, y_test))\n'})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"\xbfQu\xe9 hace este c\xf3digo?"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"tree_full.score(X_train, y_train)"}),"\n\u2192 Calcula el porcentaje de aciertos del modelo sobre los datos ",(0,r.jsx)(s.strong,{children:"con los que se entren\xf3"}),".\n\u2192 Si esta accuracy es muy alta (por ejemplo 1.00), el modelo est\xe1 \u201cmemorizando\u201d."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"tree_full.score(X_test, y_test)"}),"\n\u2192 Calcula el porcentaje de aciertos del modelo sobre ",(0,r.jsx)(s.strong,{children:"datos nuevos"})," que no ha visto antes.\n\u2192 Si esta accuracy es claramente m\xe1s baja que la de train, indica ",(0,r.jsx)(s.strong,{children:"sobreajuste"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"ejemplo-con-ajuste-de-hiperpar\xe1metros",children:"Ejemplo con ajuste de hiperpar\xe1metros"}),"\n",(0,r.jsxs)(s.p,{children:["En este segundo ejemplo trabajaremos con el mismo ",(0,r.jsx)(s.strong,{children:"Google Colab"})," y el mismo ",(0,r.jsx)(s.strong,{children:"dataset Iris"})," utilizados anteriormente.\nEl objetivo es ver c\xf3mo los hiperpar\xe1metros (",(0,r.jsx)(s.code,{children:"max_depth"}),", ",(0,r.jsx)(s.code,{children:"min_samples_split"}),", ",(0,r.jsx)(s.code,{children:"min_samples_leaf"}),") permiten controlar el tama\xf1o del \xe1rbol y mejorar su capacidad de generalizaci\xf3n."]}),"\n",(0,r.jsx)(s.p,{children:"En el Colab encontrar\xe1s un apartado espec\xedfico llamado \u201cAjuste de hiperpar\xe1metros \u2013 Decision Trees\u201d."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"m\xe9tricas-de-evaluaci\xf3n",children:"M\xe9tricas de evaluaci\xf3n"}),"\n",(0,r.jsxs)(s.p,{children:["Para evaluar un \xc1rbol de Decisi\xf3n podemos utilizar ",(0,r.jsx)(s.strong,{children:"las mismas m\xe9tricas de clasificaci\xf3n"})," que ya estudiamos en el apartado de ",(0,r.jsx)(s.strong,{children:"KNN"}),"."]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Accuracy"}),"\nProporci\xf3n de aciertos del modelo."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Matriz de confusi\xf3n"}),"\nPermite ver qu\xe9 clases se confunden entre s\xed."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Classification report"})," - ",(0,r.jsx)(s.strong,{children:"Precision, Recall y F1-score"})," (M\xe1s avanzadas)\n\xdatiles especialmente cuando las clases est\xe1n desbalanceadas."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Estas m\xe9tricas te permitir\xe1n saber si el \xe1rbol est\xe1 funcionando bien, si confunde especies entre s\xed y si necesita un mejor ajuste de hiperpar\xe1metros."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"an\xe1lisis-de-importancia",children:"An\xe1lisis de importancia"}),"\n",(0,r.jsxs)(s.p,{children:["Una de las grandes ventajas de los \xc1rboles de Decisi\xf3n es que no solo permiten visualizar las reglas que aprende el modelo, sino tambi\xe9n ",(0,r.jsx)(s.strong,{children:"medir qu\xe9 variables han sido m\xe1s importantes"})," para tomar decisiones. Esto hace que los \xe1rboles sean modelos muy ",(0,r.jsx)(s.strong,{children:"interpretables"}),", especialmente en comparaci\xf3n con otros algoritmos."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Obtener la importancia de las variables"})}),"\n",(0,r.jsxs)(s.p,{children:["Una vez entrenado el \xe1rbol, scikit-learn nos da un atributo llamado ",(0,r.jsx)(s.code,{children:".feature_importances_"}),", que indica cu\xe1nto ha contribuido cada variable a las divisiones del \xe1rbol."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'importances = tree_test.feature_importances_\n\nfor name, value in zip(features, importances):\n    print(name, ":", value)\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Los valores est\xe1n entre ",(0,r.jsx)(s.strong,{children:"0 y 1"})," y ",(0,r.jsx)(s.strong,{children:"suman 1"}),".\nCuanto mayor es el valor, m\xe1s ha utilizado el \xe1rbol esa feature para separar las clases."]}),"\n",(0,r.jsxs)(s.p,{children:["Podemos visualizar estas importancias con un ",(0,r.jsx)(s.strong,{children:"gr\xe1fico"})," muy sencillo:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'plt.figure(figsize=(6, 4))\nplt.barh(features, importances)\nplt.xlabel("Importancia")\nplt.title("Importancia de las variables")\nplt.show()\n'})}),"\n",(0,r.jsx)(s.p,{children:"Este tipo de gr\xe1fico es ideal para ver de un vistazo cu\xe1les son las variables clave."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Gr\xe1fico EDA",src:n(30528).A+"",width:"586",height:"393"})}),"\n",(0,r.jsxs)(s.p,{children:["\ud83e\udde0 ",(0,r.jsx)(s.strong,{children:"Interpretaci\xf3n"})]}),"\n",(0,r.jsx)(s.p,{children:"La importancia de una variable indica:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"cu\xe1ntas veces"})," se ha usado esa feature para dividir el dataset"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"cu\xe1nto ha mejorado"})," la pureza del \xe1rbol cuando se ha usado"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"qu\xe9 papel juega"})," en la separaci\xf3n de las clases"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Por ejemplo, si ",(0,r.jsx)(s.code,{children:"petal_length"})," tiene la mayor importancia, significa que es la variable m\xe1s \xfatil para separar ",(0,r.jsx)(s.em,{children:"setosa"}),", ",(0,r.jsx)(s.em,{children:"versicolor"})," y ",(0,r.jsx)(s.em,{children:"virginica"}),"."]}),"\n",(0,r.jsx)(s.admonition,{title:"Importante",type:"warning",children:(0,r.jsxs)(s.p,{children:["La ",(0,r.jsx)(s.em,{children:"importancia"})," de una variable ",(0,r.jsx)(s.strong,{children:"no implica causalidad"}),".",(0,r.jsx)(s.br,{}),"\n","Solo indica ",(0,r.jsx)(s.strong,{children:"lo \xfatil que ha sido esa feature para que el \xe1rbol separe las clases"}),".",(0,r.jsx)(s.br,{}),"\n","El modelo usa esa variable porque funciona bien ",(0,r.jsx)(s.strong,{children:"en este dataset"}),", no porque provoque el resultado."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"automatizaci\xf3n-b\xfasqueda-hiperpar\xe1metros-gridsearchcv",children:"Automatizaci\xf3n b\xfasqueda hiperpar\xe1metros (GridSearchCV)"}),"\n",(0,r.jsxs)(s.p,{children:["Para encontrar la mejor combinaci\xf3n de hiperpar\xe1metros de un \xc1rbol de Decisi\xf3n, podemos utilizar ",(0,r.jsx)(s.strong,{children:"GridSearchCV"}),", una herramienta de scikit-learn que prueba autom\xe1ticamente m\xfaltiples configuraciones y selecciona la que ofrece mejor rendimiento."]}),"\n",(0,r.jsxs)(s.p,{children:["Este m\xe9todo es especialmente \xfatil cuando no sabemos qu\xe9 valores de ",(0,r.jsx)(s.code,{children:"max_depth"}),", ",(0,r.jsx)(s.code,{children:"min_samples_split"})," o ",(0,r.jsx)(s.code,{children:"min_samples_leaf"})," son los m\xe1s adecuados."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"C\xf3mo hacer una b\xfasqueda de hiperpar\xe1metros"})}),"\n",(0,r.jsx)(s.p,{children:"GridSearchCV funciona as\xed:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Le damos un modelo base (por ejemplo, ",(0,r.jsx)(s.code,{children:"DecisionTreeClassifier()"}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Le pasamos un ",(0,r.jsx)(s.strong,{children:"diccionario de hiperpar\xe1metros"})," con los valores que queremos probar."]}),"\n",(0,r.jsx)(s.li,{children:"Realiza validaci\xf3n cruzada para todas las combinaciones posibles. Ver 5-fold Cross-Validation en los apuntes de KNN."}),"\n",(0,r.jsx)(s.li,{children:"Devuelve el modelo que obtuvo mejor rendimiento."}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"ejemplo-de-diccionario-de-par\xe1metros",children:"Ejemplo de diccionario de par\xe1metros"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'param_grid = {\n    "max_depth": [2, 3, 4, 5, None],        # 5 opciones\n    "min_samples_split": [2, 5, 10],        # 3 opciones\n    "min_samples_leaf": [1, 2, 5]           # 3 opciones\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"GridSearchCV va a probar absolutamente todas las combinaciones posibles"})," de los valores que pongas en ",(0,r.jsx)(s.code,{children:"param_grid"}),".\nEs decir: hace una ",(0,r.jsx)(s.strong,{children:"b\xfasqueda exhaustiva"})," (",(0,r.jsx)(s.em,{children:"grid search"}),") por la rejilla de hiperpar\xe1metros."]}),"\n",(0,r.jsx)(s.p,{children:"GridSearchCV har\xe1:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"5 \xd7 3 \xd7 3 = 45 combinaciones\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Es decir, ",(0,r.jsx)(s.strong,{children:"45 \xe1rboles distintos"}),". Si adem\xe1s usamos ",(0,r.jsx)(s.code,{children:"cv=5"}),", entonces entrena cada uno ",(0,r.jsx)(s.strong,{children:"5 veces"}),", as\xed que:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"45 modelos \xd7 5 validaciones = 225 entrenamientos\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Por eso ",(0,r.jsx)(s.strong,{children:"no debes poner listas enormes"}),", porque puede tardar mucho."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"c\xf3mo-obtener-el-mejor-\xe1rbol",children:"C\xf3mo obtener el mejor \xe1rbol"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'from sklearn.model_selection import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\n\n# Creamos un \xe1rbol base (sin configurar hiperpar\xe1metros)\n# GridSearchCV ser\xe1 quien pruebe distintas combinaciones\ntree = DecisionTreeClassifier(random_state=42)\n\n# Configuramos GridSearchCV\ngrid = GridSearchCV(\n    estimator=tree,      # Modelo base que queremos optimizar\n    param_grid=param_grid,  # Diccionario con las combinaciones de hiperpar\xe1metros a probar\n    cv=5,                # Validaci\xf3n cruzada de 5 particiones\n    scoring="accuracy"   # M\xe9trica que usaremos para elegir el mejor modelo\n)\n\n# Entrenamos el GridSearch: prueba todas las combinaciones en param_grid\ngrid.fit(X_train, y_train)\n\n# Mostramos la mejor combinaci\xf3n encontrada\nprint("Mejores hiperpar\xe1metros:", grid.best_params_)\n\n# Obtenemos directamente el \xe1rbol entrenado con los mejores par\xe1metros\nbest_tree = grid.best_estimator_\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"best_tree"})," contiene el modelo \xf3ptimo encontrado por GridSearchCV, ya entrenado y listo para evaluar en el conjunto de test."]}),"\n",(0,r.jsxs)(s.admonition,{title:"C\xf3mo elegir los valores para GridSearch",type:"tip",children:[(0,r.jsxs)(s.p,{children:["No hay una f\xf3rmula m\xe1gica para elegir los valores de GridSearch.",(0,r.jsx)(s.br,{}),"\n","Empieza con rangos ",(0,r.jsx)(s.strong,{children:"peque\xf1os y realistas"})," seg\xfan el dataset,",(0,r.jsx)(s.br,{}),"\n","observa el comportamiento del \xe1rbol y ampl\xeda solo si hace falta."]}),(0,r.jsxs)(s.p,{children:["En datasets sencillos como ",(0,r.jsx)(s.strong,{children:"Iris"})," suelen bastar profundidades entre ",(0,r.jsx)(s.strong,{children:"2 y 5"}),".",(0,r.jsx)(s.br,{}),"\n","En datasets reales y m\xe1s complejos puedes probar valores algo mayores, como ",(0,r.jsx)(s.strong,{children:"5 a 12"}),"."]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"actividad-de-seguimiento-iris",children:"Actividad de seguimiento: Iris"}),"\n",(0,r.jsxs)(s.p,{children:["Realiza un peque\xf1o proyecto completo con el dataset ",(0,r.jsx)(s.strong,{children:"Iris"})," completo siguiendo los pasos vistos en clase."]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"EDA b\xe1sico"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Preprocesamiento"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Modelado:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Entrena ",(0,r.jsx)(s.strong,{children:"KNN"})," (usando GridSearchCV)"]}),"\n",(0,r.jsxs)(s.li,{children:["Entrena un ",(0,r.jsx)(s.strong,{children:"\xc1rbol de Decisi\xf3n"}),": busca la mejor selecci\xf3n de hiperpar\xe1metros, muestra la importancia de las features, el \xe1rbol de decisi\xf3n generado, etc."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Evaluaci\xf3n:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Accuracy"}),"\n",(0,r.jsx)(s.li,{children:"Matriz de confusi\xf3n"}),"\n",(0,r.jsx)(s.li,{children:"Breve comparaci\xf3n entre ambos modelos"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Entrega:"})," Notebook (Colab) con todos los pasos y conclusiones."]})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},58042:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/resumen-iris-68ba1114ed1e03d4f5cd98b39c5f4e94.png"},59206:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/gini-e4c8f457bebd1f8333b23fb4ab7d2f91.png"},90695:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/ejemplo-decision-tree-053e57f7d852d454b80428224e7571a5.png"},97087:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/files/iris-11586a493a1db7736fce5ba6dc154074.csv"}}]);